<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Cap. 3 Classificação | Caderno de exercícos Mestrado de computação aplicada</title>
  <meta name="description" content="Caderno de exercício Big Data" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Cap. 3 Classificação | Caderno de exercícos Mestrado de computação aplicada" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Caderno de exercício Big Data" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Cap. 3 Classificação | Caderno de exercícos Mestrado de computação aplicada" />
  
  <meta name="twitter:description" content="Caderno de exercício Big Data" />
  

<meta name="author" content="Anderson dos Santos" />


<meta name="date" content="2022-11-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regression.html"/>
<link rel="next" href="final-work.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Caderno de BD</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Big Data Analytics 2022</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organização"><i class="fa fa-check"></i>Organização</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="descriptive.html"><a href="descriptive.html"><i class="fa fa-check"></i><b>1</b> Estatística descritiva</a>
<ul>
<li class="chapter" data-level="1.1" data-path="descriptive.html"><a href="descriptive.html#exercício"><i class="fa fa-check"></i><b>1.1</b> Exercício</a></li>
<li class="chapter" data-level="1.2" data-path="descriptive.html"><a href="descriptive.html#pacotes"><i class="fa fa-check"></i><b>1.2</b> Pacotes</a></li>
<li class="chapter" data-level="1.3" data-path="descriptive.html"><a href="descriptive.html#conjunto-de-dados"><i class="fa fa-check"></i><b>1.3</b> Conjunto de dados</a></li>
<li class="chapter" data-level="1.4" data-path="descriptive.html"><a href="descriptive.html#informações-dos-atributos"><i class="fa fa-check"></i><b>1.4</b> Informações dos atributos</a></li>
<li class="chapter" data-level="1.5" data-path="descriptive.html"><a href="descriptive.html#análise-descritiva-de-algumas-ações"><i class="fa fa-check"></i><b>1.5</b> Análise descritiva de algumas ações</a></li>
<li class="chapter" data-level="1.6" data-path="descriptive.html"><a href="descriptive.html#avaliando-nubr33"><i class="fa fa-check"></i><b>1.6</b> Avaliando NUBR33</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>2</b> Regressão</a>
<ul>
<li class="chapter" data-level="2.1" data-path="regression.html"><a href="regression.html#conjunto-de-dados-1"><i class="fa fa-check"></i><b>2.1</b> Conjunto de dados</a></li>
<li class="chapter" data-level="2.2" data-path="regression.html"><a href="regression.html#preço-das-casas"><i class="fa fa-check"></i><b>2.2</b> Preço das casas</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="regression.html"><a href="regression.html#pacotes-1"><i class="fa fa-check"></i><b>2.2.1</b> Pacotes</a></li>
<li class="chapter" data-level="2.2.2" data-path="regression.html"><a href="regression.html#conjunto-de-dados-2"><i class="fa fa-check"></i><b>2.2.2</b> Conjunto de dados</a></li>
<li class="chapter" data-level="2.2.3" data-path="regression.html"><a href="regression.html#descrevendo-os-dados"><i class="fa fa-check"></i><b>2.2.3</b> Descrevendo os dados:</a></li>
<li class="chapter" data-level="2.2.4" data-path="regression.html"><a href="regression.html#ajustes-de-modelos-lineares-simples"><i class="fa fa-check"></i><b>2.2.4</b> Ajustes de modelos lineares simples</a></li>
<li class="chapter" data-level="2.2.5" data-path="regression.html"><a href="regression.html#predição"><i class="fa fa-check"></i><b>2.2.5</b> Predição</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="regression.html"><a href="regression.html#análise-conjunto-energia"><i class="fa fa-check"></i><b>2.3</b> Análise conjunto energia</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="regression.html"><a href="regression.html#pacotes-2"><i class="fa fa-check"></i><b>2.3.1</b> Pacotes</a></li>
<li class="chapter" data-level="2.3.2" data-path="regression.html"><a href="regression.html#conjunto-de-dados-3"><i class="fa fa-check"></i><b>2.3.2</b> Conjunto de dados</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="regression.html"><a href="regression.html#análise-conjunto-vendas-vs-fontes-de-publidades"><i class="fa fa-check"></i><b>2.4</b> Análise Conjunto vendas vs fontes de publidades</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="regression.html"><a href="regression.html#pacotes-3"><i class="fa fa-check"></i><b>2.4.1</b> Pacotes</a></li>
<li class="chapter" data-level="2.4.2" data-path="regression.html"><a href="regression.html#conjunto-de-dados-4"><i class="fa fa-check"></i><b>2.4.2</b> Conjunto de dados</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="regression.html"><a href="regression.html#análise-conjunto-st-vs-demais-variáveiscredit-score-x-renda-e-outras-v"><i class="fa fa-check"></i><b>2.5</b> Análise conjunto ST vs demais variáveisCREDIT SCORE X RENDA E OUTRAS V</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="regression.html"><a href="regression.html#pacotes-4"><i class="fa fa-check"></i><b>2.5.1</b> Pacotes</a></li>
<li class="chapter" data-level="2.5.2" data-path="regression.html"><a href="regression.html#conjunto-de-dados-5"><i class="fa fa-check"></i><b>2.5.2</b> Conjunto de dados</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="regression.html"><a href="regression.html#consumo-alimentar-médio"><i class="fa fa-check"></i><b>2.6</b> Consumo alimentar médio</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="regression.html"><a href="regression.html#pacotes-5"><i class="fa fa-check"></i><b>2.6.1</b> Pacotes</a></li>
<li class="chapter" data-level="2.6.2" data-path="regression.html"><a href="regression.html#conjunto-de-dados-6"><i class="fa fa-check"></i><b>2.6.2</b> Conjunto de dados</a></li>
<li class="chapter" data-level="2.6.3" data-path="regression.html"><a href="regression.html#regressão"><i class="fa fa-check"></i><b>2.6.3</b> Regressão</a></li>
<li class="chapter" data-level="2.6.4" data-path="regression.html"><a href="regression.html#predição-1"><i class="fa fa-check"></i><b>2.6.4</b> Predição</a></li>
<li class="chapter" data-level="2.6.5" data-path="regression.html"><a href="regression.html#agrupamento"><i class="fa fa-check"></i><b>2.6.5</b> Agrupamento</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>3</b> Classificação</a>
<ul>
<li class="chapter" data-level="3.1" data-path="classification.html"><a href="classification.html#conjunto-de-dados-7"><i class="fa fa-check"></i><b>3.1</b> Conjunto de dados</a></li>
<li class="chapter" data-level="3.2" data-path="classification.html"><a href="classification.html#inibina-b-como-marcador"><i class="fa fa-check"></i><b>3.2</b> Inibina B como marcador</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="classification.html"><a href="classification.html#pacotes-6"><i class="fa fa-check"></i><b>3.2.1</b> Pacotes</a></li>
<li class="chapter" data-level="3.2.2" data-path="classification.html"><a href="classification.html#conjunto-de-dados-8"><i class="fa fa-check"></i><b>3.2.2</b> Conjunto de dados</a></li>
<li class="chapter" data-level="3.2.3" data-path="classification.html"><a href="classification.html#generalized-linear-models"><i class="fa fa-check"></i><b>3.2.3</b> Generalized Linear Models</a></li>
<li class="chapter" data-level="3.2.4" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis---fisher"><i class="fa fa-check"></i><b>3.2.4</b> Linear Discriminant Analysis - Fisher</a></li>
<li class="chapter" data-level="3.2.5" data-path="classification.html"><a href="classification.html#bayes"><i class="fa fa-check"></i><b>3.2.5</b> Bayes</a></li>
<li class="chapter" data-level="3.2.6" data-path="classification.html"><a href="classification.html#decison-tree"><i class="fa fa-check"></i><b>3.2.6</b> Decison tree</a></li>
<li class="chapter" data-level="3.2.7" data-path="classification.html"><a href="classification.html#svm"><i class="fa fa-check"></i><b>3.2.7</b> SVM</a></li>
<li class="chapter" data-level="3.2.8" data-path="classification.html"><a href="classification.html#neuralnet"><i class="fa fa-check"></i><b>3.2.8</b> neuralnet</a></li>
<li class="chapter" data-level="3.2.9" data-path="classification.html"><a href="classification.html#knn"><i class="fa fa-check"></i><b>3.2.9</b> KNN</a></li>
<li class="chapter" data-level="3.2.10" data-path="classification.html"><a href="classification.html#avaliando-os-modelos"><i class="fa fa-check"></i><b>3.2.10</b> Avaliando os modelos</a></li>
<li class="chapter" data-level="3.2.11" data-path="classification.html"><a href="classification.html#agrupamento-1"><i class="fa fa-check"></i><b>3.2.11</b> Agrupamento</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="classification.html"><a href="classification.html#ultrassom-para-medir-deslocamento-do-disco"><i class="fa fa-check"></i><b>3.3</b> Ultrassom para medir deslocamento do disco</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="classification.html"><a href="classification.html#pacotes-7"><i class="fa fa-check"></i><b>3.3.1</b> Pacotes</a></li>
<li class="chapter" data-level="3.3.2" data-path="classification.html"><a href="classification.html#conjunto-de-dados-9"><i class="fa fa-check"></i><b>3.3.2</b> Conjunto de dados</a></li>
<li class="chapter" data-level="3.3.3" data-path="classification.html"><a href="classification.html#generalized-linear-models-1"><i class="fa fa-check"></i><b>3.3.3</b> Generalized Linear Models</a></li>
<li class="chapter" data-level="3.3.4" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis---fisher-1"><i class="fa fa-check"></i><b>3.3.4</b> Linear Discriminant Analysis - Fisher</a></li>
<li class="chapter" data-level="3.3.5" data-path="classification.html"><a href="classification.html#bayes-1"><i class="fa fa-check"></i><b>3.3.5</b> Bayes</a></li>
<li class="chapter" data-level="3.3.6" data-path="classification.html"><a href="classification.html#decison-tree-1"><i class="fa fa-check"></i><b>3.3.6</b> Decison tree</a></li>
<li class="chapter" data-level="3.3.7" data-path="classification.html"><a href="classification.html#svm-1"><i class="fa fa-check"></i><b>3.3.7</b> SVM</a></li>
<li class="chapter" data-level="3.3.8" data-path="classification.html"><a href="classification.html#neuralnet-1"><i class="fa fa-check"></i><b>3.3.8</b> neuralnet</a></li>
<li class="chapter" data-level="3.3.9" data-path="classification.html"><a href="classification.html#knn-1"><i class="fa fa-check"></i><b>3.3.9</b> KNN</a></li>
<li class="chapter" data-level="3.3.10" data-path="classification.html"><a href="classification.html#avaliando-os-modelos-1"><i class="fa fa-check"></i><b>3.3.10</b> Avaliando os modelos</a></li>
<li class="chapter" data-level="3.3.11" data-path="classification.html"><a href="classification.html#agrupamento-2"><i class="fa fa-check"></i><b>3.3.11</b> Agrupamento</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="classification.html"><a href="classification.html#classificação-de-tipos-faciais"><i class="fa fa-check"></i><b>3.4</b> Classificação de tipos faciais</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="classification.html"><a href="classification.html#pacotes-8"><i class="fa fa-check"></i><b>3.4.1</b> Pacotes</a></li>
<li class="chapter" data-level="3.4.2" data-path="classification.html"><a href="classification.html#conjunto-de-dados-10"><i class="fa fa-check"></i><b>3.4.2</b> Conjunto de dados</a></li>
<li class="chapter" data-level="3.4.3" data-path="classification.html"><a href="classification.html#generalized-linear-models-2"><i class="fa fa-check"></i><b>3.4.3</b> Generalized Linear Models</a></li>
<li class="chapter" data-level="3.4.4" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis---fisher-2"><i class="fa fa-check"></i><b>3.4.4</b> Linear Discriminant Analysis - Fisher</a></li>
<li class="chapter" data-level="3.4.5" data-path="classification.html"><a href="classification.html#bayes-2"><i class="fa fa-check"></i><b>3.4.5</b> Bayes</a></li>
<li class="chapter" data-level="3.4.6" data-path="classification.html"><a href="classification.html#decison-tree-2"><i class="fa fa-check"></i><b>3.4.6</b> Decison tree</a></li>
<li class="chapter" data-level="3.4.7" data-path="classification.html"><a href="classification.html#svm-2"><i class="fa fa-check"></i><b>3.4.7</b> SVM</a></li>
<li class="chapter" data-level="3.4.8" data-path="classification.html"><a href="classification.html#neuralnet-2"><i class="fa fa-check"></i><b>3.4.8</b> neuralnet</a></li>
<li class="chapter" data-level="3.4.9" data-path="classification.html"><a href="classification.html#knn-2"><i class="fa fa-check"></i><b>3.4.9</b> KNN</a></li>
<li class="chapter" data-level="3.4.10" data-path="classification.html"><a href="classification.html#avaliando-os-modelos-2"><i class="fa fa-check"></i><b>3.4.10</b> Avaliando os modelos</a></li>
<li class="chapter" data-level="3.4.11" data-path="classification.html"><a href="classification.html#agrupamento-3"><i class="fa fa-check"></i><b>3.4.11</b> Agrupamento</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="classification.html"><a href="classification.html#análise-do-conjunto-de-dados-usarrests"><i class="fa fa-check"></i><b>3.5</b> Análise do conjunto de dados USArrests</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="classification.html"><a href="classification.html#pacotes-9"><i class="fa fa-check"></i><b>3.5.1</b> Pacotes</a></li>
<li class="chapter" data-level="3.5.2" data-path="classification.html"><a href="classification.html#conjunto-de-dados-11"><i class="fa fa-check"></i><b>3.5.2</b> Conjunto de dados</a></li>
<li class="chapter" data-level="3.5.3" data-path="classification.html"><a href="classification.html#agrupamento-4"><i class="fa fa-check"></i><b>3.5.3</b> Agrupamento</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="final-work.html"><a href="final-work.html"><i class="fa fa-check"></i><b>4</b> Trabalho final</a>
<ul>
<li class="chapter" data-level="4.1" data-path="final-work.html"><a href="final-work.html#fonte-de-dados"><i class="fa fa-check"></i><b>4.1</b> Fonte de dados</a></li>
<li class="chapter" data-level="4.2" data-path="final-work.html"><a href="final-work.html#introdução"><i class="fa fa-check"></i><b>4.2</b> Introdução</a></li>
<li class="chapter" data-level="4.3" data-path="final-work.html"><a href="final-work.html#referências"><i class="fa fa-check"></i><b>4.3</b> Referências</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Caderno de exercícos Mestrado de computação aplicada</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="classification" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Cap. 3</span> Classificação<a href="classification.html#classification" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A classificação estatística é uma ampla abordagem de aprendizado supervisionado que treina um programa para categorizar informações novas e não rotuladas com base em sua relevância para dados rotulados conhecidos.</p>
<p>A análise de cluster visa segmentar objetos em grupos com membros semelhantes e, portanto, ajuda a descobrir a distribuição de propriedades e correlações em grandes conjuntos de dados.</p>
<p>Os exercícios deste capítulo estão relacionados a esses dois tópicos.</p>
<div id="conjunto-de-dados-7" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Conjunto de dados<a href="classification.html#conjunto-de-dados-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Este conjunto de dados foram criados pela professora Dra.Olga Satomi Yoshida para aula de Big Data no IPT.</p>
<ol style="list-style-type: decimal">
<li>Inibina: inibina.xlsx</li>
<li>avaliação do deslocamento do disco da articulação temporomandibular: disco.xls</li>
<li>Tipos faciais: tipofacial.xls</li>
<li>Consumo alimentar médio: LABORATORIO-R.pdf (ex 5.)</li>
</ol>
</div>
<div id="inibina-b-como-marcador" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Inibina B como marcador<a href="classification.html#inibina-b-como-marcador" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Avaliar a inibina B como marcador da reserva ovariana de pacientes submetidas à fertilização in vitro</p>
<div id="pacotes-6" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Pacotes<a href="classification.html#pacotes-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pacotes necessários para estes exercícios:</p>
<pre><code>## Carregando pacotes exigidos: lattice</code></pre>
<pre><code>## 
## Attaching package: &#39;caret&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     lift</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:plotly&#39;:
## 
##     select</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<pre><code>## 
## Attaching package: &#39;httr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:caret&#39;:
## 
##     progress</code></pre>
<pre><code>## The following object is masked from &#39;package:plotly&#39;:
## 
##     config</code></pre>
<pre><code>## 
## Attaching package: &#39;neuralnet&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     compute</code></pre>
</div>
<div id="conjunto-de-dados-8" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Conjunto de dados<a href="classification.html#conjunto-de-dados-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="classification.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">#GET(&quot;http://www.ime.usp.br/~jmsinger/MorettinSinger/inibina.xls&quot;, write_disk(tf &lt;- tempfile(fileext = &quot;.xls&quot;)))</span></span>
<span id="cb111-2"><a href="classification.html#cb111-2" aria-hidden="true" tabindex="-1"></a>httr<span class="sc">::</span><span class="fu">GET</span>(<span class="st">&quot;http://www.ime.usp.br/~jmsinger/MorettinSinger/inibina.xls&quot;</span>, httr<span class="sc">::</span><span class="fu">write_disk</span>(<span class="st">&quot;../dados/inibina.xls&quot;</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## Response [https://www.ime.usp.br/~jmsinger/MorettinSinger/inibina.xls]
##   Date: 2022-11-15 23:40
##   Status: 200
##   Content-Type: application/vnd.ms-excel
##   Size: 8.7 kB
## &lt;ON DISK&gt;  G:\onedrive\obsidian\adsantos\Mestrado\BD\trabalhos\caderno-bd\dados\inibina.xls</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="classification.html#cb113-1" aria-hidden="true" tabindex="-1"></a>inibina <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;../dados/inibina.xls&quot;</span>)</span>
<span id="cb113-2"><a href="classification.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(inibina)</span></code></pre></div>
<pre><code>## tibble [32 × 4] (S3: tbl_df/tbl/data.frame)
##  $ ident   : num [1:32] 1 2 3 4 5 6 7 8 9 10 ...
##  $ resposta: chr [1:32] &quot;positiva&quot; &quot;positiva&quot; &quot;positiva&quot; &quot;positiva&quot; ...
##  $ inibpre : num [1:32] 54 159.1 98.3 85.3 127.9 ...
##  $ inibpos : num [1:32] 65.9 281.1 305.4 434.4 229.3 ...</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="classification.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(inibina)</span></code></pre></div>
<pre><code>## [1] 32</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="classification.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>()</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="classification.html#cb119-1" aria-hidden="true" tabindex="-1"></a>inibina<span class="sc">$</span>difinib <span class="ot">=</span> inibina<span class="sc">$</span>inibpos <span class="sc">-</span> inibina<span class="sc">$</span>inibpre</span>
<span id="cb119-2"><a href="classification.html#cb119-2" aria-hidden="true" tabindex="-1"></a>inibina<span class="sc">$</span>resposta <span class="ot">=</span> <span class="fu">as.factor</span>(inibina<span class="sc">$</span>resposta)</span></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="classification.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(inibina<span class="sc">$</span>difinib <span class="sc">~</span> inibina<span class="sc">$</span>resposta, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">400</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="classification.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(inibina, <span class="at">n =</span> <span class="dv">32</span>)</span></code></pre></div>
<pre><code>## # A tibble: 32 × 5
##    ident resposta inibpre inibpos difinib
##    &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1     1 positiva   54.0    65.9    11.9 
##  2     2 positiva  159.    281.    122.  
##  3     3 positiva   98.3   305.    207.  
##  4     4 positiva   85.3   434.    349.  
##  5     5 positiva  128.    229.    101.  
##  6     6 positiva  144.    354.    210.  
##  7     7 positiva  111.    254.    143.  
##  8     8 positiva   47.5   199.    152.  
##  9     9 positiva  123.    328.    205.  
## 10    10 positiva  166.    339.    174.  
## 11    11 positiva  145.    377.    232.  
## 12    12 positiva  186.   1055.    869.  
## 13    13 positiva  149.    354.    204.  
## 14    14 positiva   33.3   100.     66.8 
## 15    15 positiva  182.    358.    177.  
## 16    16 positiva   58.4   168.    110.  
## 17    17 positiva  128.    228.    100.  
## 18    18 positiva  153.    312.    159.  
## 19    19 positiva  149.    406.    257.  
## 20    20 negativa   81     201.    120.  
## 21    21 negativa   24.7    45.2    20.4 
## 22    22 negativa    3.02    6.03    3.01
## 23    23 negativa    4.27   17.8    13.5 
## 24    24 negativa   99.3   128.     28.6 
## 25    25 negativa  108.    129.     21.1 
## 26    26 negativa    7.36   21.3    13.9 
## 27    27 negativa  161.    320.    158.  
## 28    28 negativa  184.    311.    127.  
## 29    29 negativa   23.1    45.6    22.5 
## 30    30 negativa  111.    192.     81.0 
## 31    31 negativa  106.    131.     24.8 
## 32    32 negativa    3.98    6.46    2.48</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="classification.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Hmisc::describe(inibina)</span></span>
<span id="cb123-2"><a href="classification.html#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="classification.html#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(inibina)</span></code></pre></div>
<pre><code>##      ident           resposta     inibpre          inibpos           difinib      
##  Min.   : 1.00   negativa:13   Min.   :  3.02   Min.   :   6.03   Min.   :  2.48  
##  1st Qu.: 8.75   positiva:19   1st Qu.: 52.40   1st Qu.: 120.97   1st Qu.: 24.22  
##  Median :16.50                 Median :109.44   Median : 228.89   Median :121.18  
##  Mean   :16.50                 Mean   :100.53   Mean   : 240.80   Mean   :140.27  
##  3rd Qu.:24.25                 3rd Qu.:148.93   3rd Qu.: 330.77   3rd Qu.:183.77  
##  Max.   :32.00                 Max.   :186.38   Max.   :1055.19   Max.   :868.81</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="classification.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(inibina<span class="sc">$</span>difinib)</span></code></pre></div>
<pre><code>## [1] 159.2217</code></pre>
<p>Criando um dataframe para comparar as métricas dos modelos.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="classification.html#cb127-1" aria-hidden="true" tabindex="-1"></a>model_eval <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb127-2"><a href="classification.html#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="classification.html#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(model_eval) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Model&#39;</span>, <span class="st">&#39;Algorithm&#39;</span>, <span class="st">&#39;Accuracy&#39;</span>, <span class="st">&#39;Sensitivity&#39;</span>, <span class="st">&#39;Specificity&#39;</span>)</span></code></pre></div>
</div>
<div id="generalized-linear-models" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Generalized Linear Models<a href="classification.html#generalized-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="classification.html#cb128-1" aria-hidden="true" tabindex="-1"></a>modLogist01 <span class="ot">=</span> <span class="fu">glm</span>(resposta <span class="sc">~</span> difinib, <span class="at">family =</span> binomial, <span class="at">data =</span> inibina)</span>
<span id="cb128-2"><a href="classification.html#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modLogist01)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = resposta ~ difinib, family = binomial, data = inibina)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.9770  -0.5594   0.1890   0.5589   2.0631  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept) -2.310455   0.947438  -2.439  0.01474 * 
## difinib      0.025965   0.008561   3.033  0.00242 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 43.230  on 31  degrees of freedom
## Residual deviance: 24.758  on 30  degrees of freedom
## AIC: 28.758
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="classification.html#cb130-1" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict.glm</span>(modLogist01, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb130-2"><a href="classification.html#cb130-2" aria-hidden="true" tabindex="-1"></a>classPred <span class="ot">=</span> <span class="fu">ifelse</span>(predito<span class="sc">&gt;</span><span class="fl">0.5</span>, <span class="st">&quot;positiva&quot;</span>, <span class="st">&quot;negativa&quot;</span>)</span>
<span id="cb130-3"><a href="classification.html#cb130-3" aria-hidden="true" tabindex="-1"></a>classPred <span class="ot">=</span> <span class="fu">as.factor</span>(classPred)</span>
<span id="cb130-4"><a href="classification.html#cb130-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(classPred, inibina<span class="sc">$</span>resposta, <span class="at">positive =</span> <span class="st">&quot;positiva&quot;</span>)</span>
<span id="cb130-5"><a href="classification.html#cb130-5" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction negativa positiva
##   negativa       10        2
##   positiva        3       17
##                                           
##                Accuracy : 0.8438          
##                  95% CI : (0.6721, 0.9472)
##     No Information Rate : 0.5938          
##     P-Value [Acc &gt; NIR] : 0.002273        
##                                           
##                   Kappa : 0.6721          
##                                           
##  Mcnemar&#39;s Test P-Value : 1.000000        
##                                           
##             Sensitivity : 0.8947          
##             Specificity : 0.7692          
##          Pos Pred Value : 0.8500          
##          Neg Pred Value : 0.8333          
##              Prevalence : 0.5938          
##          Detection Rate : 0.5312          
##    Detection Prevalence : 0.6250          
##       Balanced Accuracy : 0.8320          
##                                           
##        &#39;Positive&#39; Class : positiva        
## </code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="classification.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb132-2"><a href="classification.html#cb132-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modLogist01&quot;</span>, <span class="st">&quot;glm&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
<p>Validação cruzada leave-one-out</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="classification.html#cb133-1" aria-hidden="true" tabindex="-1"></a>trControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;LOOCV&quot;</span>)</span>
<span id="cb133-2"><a href="classification.html#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="classification.html#cb133-3" aria-hidden="true" tabindex="-1"></a>modLogist02 <span class="ot">&lt;-</span> <span class="fu">train</span>(resposta <span class="sc">~</span> difinib, <span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">data =</span> inibina, <span class="at">family =</span> binomial,</span>
<span id="cb133-4"><a href="classification.html#cb133-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trControl =</span> trControl, <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb133-5"><a href="classification.html#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modLogist02)</span></code></pre></div>
<pre><code>## 
## Call:
## NULL
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.9770  -0.5594   0.1890   0.5589   2.0631  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept) -2.310455   0.947438  -2.439  0.01474 * 
## difinib      0.025965   0.008561   3.033  0.00242 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 43.230  on 31  degrees of freedom
## Residual deviance: 24.758  on 30  degrees of freedom
## AIC: 28.758
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="classification.html#cb135-1" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modLogist02, <span class="at">newdata =</span> inibina)</span>
<span id="cb135-2"><a href="classification.html#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="classification.html#cb135-3" aria-hidden="true" tabindex="-1"></a>classPred <span class="ot">=</span> <span class="fu">as.factor</span>(predito)</span>
<span id="cb135-4"><a href="classification.html#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="classification.html#cb135-5" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(classPred, inibina<span class="sc">$</span>resposta, <span class="at">positive =</span> <span class="st">&quot;positiva&quot;</span>)</span>
<span id="cb135-6"><a href="classification.html#cb135-6" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction negativa positiva
##   negativa       10        2
##   positiva        3       17
##                                           
##                Accuracy : 0.8438          
##                  95% CI : (0.6721, 0.9472)
##     No Information Rate : 0.5938          
##     P-Value [Acc &gt; NIR] : 0.002273        
##                                           
##                   Kappa : 0.6721          
##                                           
##  Mcnemar&#39;s Test P-Value : 1.000000        
##                                           
##             Sensitivity : 0.8947          
##             Specificity : 0.7692          
##          Pos Pred Value : 0.8500          
##          Neg Pred Value : 0.8333          
##              Prevalence : 0.5938          
##          Detection Rate : 0.5312          
##    Detection Prevalence : 0.6250          
##       Balanced Accuracy : 0.8320          
##                                           
##        &#39;Positive&#39; Class : positiva        
## </code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="classification.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb137-2"><a href="classification.html#cb137-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modLogist02-LOOCV&quot;</span>, <span class="st">&quot;glm&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
<p>Treinar o modelo com o método LOOCV, neste conjunto de dados, não mudou o resultado.</p>
</div>
<div id="linear-discriminant-analysis---fisher" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Linear Discriminant Analysis - Fisher<a href="classification.html#linear-discriminant-analysis---fisher" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="classification.html#cb138-1" aria-hidden="true" tabindex="-1"></a>modFisher01 <span class="ot">=</span> <span class="fu">lda</span>(resposta <span class="sc">~</span> difinib, <span class="at">data =</span> inibina, <span class="at">prior =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb138-2"><a href="classification.html#cb138-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modFisher01)</span>
<span id="cb138-3"><a href="classification.html#cb138-3" aria-hidden="true" tabindex="-1"></a>classPred <span class="ot">=</span> predito<span class="sc">$</span>class</span>
<span id="cb138-4"><a href="classification.html#cb138-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(classPred, inibina<span class="sc">$</span>resposta, <span class="at">positive =</span> <span class="st">&quot;positiva&quot;</span>)</span>
<span id="cb138-5"><a href="classification.html#cb138-5" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction negativa positiva
##   negativa       11        6
##   positiva        2       13
##                                          
##                Accuracy : 0.75           
##                  95% CI : (0.566, 0.8854)
##     No Information Rate : 0.5938         
##     P-Value [Acc &gt; NIR] : 0.04978        
##                                          
##                   Kappa : 0.5058         
##                                          
##  Mcnemar&#39;s Test P-Value : 0.28884        
##                                          
##             Sensitivity : 0.6842         
##             Specificity : 0.8462         
##          Pos Pred Value : 0.8667         
##          Neg Pred Value : 0.6471         
##              Prevalence : 0.5938         
##          Detection Rate : 0.4062         
##    Detection Prevalence : 0.4688         
##       Balanced Accuracy : 0.7652         
##                                          
##        &#39;Positive&#39; Class : positiva       
## </code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="classification.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb140-2"><a href="classification.html#cb140-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modFisher01-prior 0.5 / 0.5&quot;</span>, <span class="st">&quot;lda&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
</div>
<div id="bayes" class="section level3 hasAnchor" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Bayes<a href="classification.html#bayes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="classification.html#cb141-1" aria-hidden="true" tabindex="-1"></a>inibina<span class="sc">$</span>resposta</span></code></pre></div>
<pre><code>##  [1] positiva positiva positiva positiva positiva positiva positiva positiva positiva
## [10] positiva positiva positiva positiva positiva positiva positiva positiva positiva
## [19] positiva negativa negativa negativa negativa negativa negativa negativa negativa
## [28] negativa negativa negativa negativa negativa
## Levels: negativa positiva</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="classification.html#cb143-1" aria-hidden="true" tabindex="-1"></a>modBayes01 <span class="ot">=</span> <span class="fu">lda</span>(resposta <span class="sc">~</span> difinib, <span class="at">data =</span> inibina, <span class="at">prior =</span> <span class="fu">c</span>(<span class="fl">0.65</span>, <span class="fl">0.35</span>))</span>
<span id="cb143-2"><a href="classification.html#cb143-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modBayes01)</span>
<span id="cb143-3"><a href="classification.html#cb143-3" aria-hidden="true" tabindex="-1"></a>classPred <span class="ot">=</span> predito<span class="sc">$</span>class</span>
<span id="cb143-4"><a href="classification.html#cb143-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(classPred, inibina<span class="sc">$</span>resposta, <span class="at">positive =</span> <span class="st">&quot;positiva&quot;</span>)</span>
<span id="cb143-5"><a href="classification.html#cb143-5" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction negativa positiva
##   negativa       13       13
##   positiva        0        6
##                                          
##                Accuracy : 0.5938         
##                  95% CI : (0.4064, 0.763)
##     No Information Rate : 0.5938         
##     P-Value [Acc &gt; NIR] : 0.5755484      
##                                          
##                   Kappa : 0.2727         
##                                          
##  Mcnemar&#39;s Test P-Value : 0.0008741      
##                                          
##             Sensitivity : 0.3158         
##             Specificity : 1.0000         
##          Pos Pred Value : 1.0000         
##          Neg Pred Value : 0.5000         
##              Prevalence : 0.5938         
##          Detection Rate : 0.1875         
##    Detection Prevalence : 0.1875         
##       Balanced Accuracy : 0.6579         
##                                          
##        &#39;Positive&#39; Class : positiva       
## </code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="classification.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb145-2"><a href="classification.html#cb145-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modBayes01-prior 0.65 / 0.35&quot;</span>, <span class="st">&quot;lda&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="classification.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(classPred)</span></code></pre></div>
<pre><code>## classPred
## negativa positiva 
##       26        6</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="classification.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(inibina, <span class="at">n =</span> <span class="dv">32</span>)</span></code></pre></div>
<pre><code>## # A tibble: 32 × 5
##    ident resposta inibpre inibpos difinib
##    &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1     1 positiva   54.0    65.9    11.9 
##  2     2 positiva  159.    281.    122.  
##  3     3 positiva   98.3   305.    207.  
##  4     4 positiva   85.3   434.    349.  
##  5     5 positiva  128.    229.    101.  
##  6     6 positiva  144.    354.    210.  
##  7     7 positiva  111.    254.    143.  
##  8     8 positiva   47.5   199.    152.  
##  9     9 positiva  123.    328.    205.  
## 10    10 positiva  166.    339.    174.  
## 11    11 positiva  145.    377.    232.  
## 12    12 positiva  186.   1055.    869.  
## 13    13 positiva  149.    354.    204.  
## 14    14 positiva   33.3   100.     66.8 
## 15    15 positiva  182.    358.    177.  
## 16    16 positiva   58.4   168.    110.  
## 17    17 positiva  128.    228.    100.  
## 18    18 positiva  153.    312.    159.  
## 19    19 positiva  149.    406.    257.  
## 20    20 negativa   81     201.    120.  
## 21    21 negativa   24.7    45.2    20.4 
## 22    22 negativa    3.02    6.03    3.01
## 23    23 negativa    4.27   17.8    13.5 
## 24    24 negativa   99.3   128.     28.6 
## 25    25 negativa  108.    129.     21.1 
## 26    26 negativa    7.36   21.3    13.9 
## 27    27 negativa  161.    320.    158.  
## 28    28 negativa  184.    311.    127.  
## 29    29 negativa   23.1    45.6    22.5 
## 30    30 negativa  111.    192.     81.0 
## 31    31 negativa  106.    131.     24.8 
## 32    32 negativa    3.98    6.46    2.48</code></pre>
<p>Naive Bayes</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="classification.html#cb150-1" aria-hidden="true" tabindex="-1"></a>modNaiveBayes01 <span class="ot">=</span> <span class="fu">naiveBayes</span>(resposta <span class="sc">~</span> difinib, <span class="at">data =</span> inibina)</span>
<span id="cb150-2"><a href="classification.html#cb150-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modNaiveBayes01, inibina)</span>
<span id="cb150-3"><a href="classification.html#cb150-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, inibina<span class="sc">$</span>resposta, <span class="at">positive =</span> <span class="st">&quot;positiva&quot;</span>)</span>
<span id="cb150-4"><a href="classification.html#cb150-4" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction negativa positiva
##   negativa       11        5
##   positiva        2       14
##                                           
##                Accuracy : 0.7812          
##                  95% CI : (0.6003, 0.9072)
##     No Information Rate : 0.5938          
##     P-Value [Acc &gt; NIR] : 0.02102         
##                                           
##                   Kappa : 0.5625          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.44969         
##                                           
##             Sensitivity : 0.7368          
##             Specificity : 0.8462          
##          Pos Pred Value : 0.8750          
##          Neg Pred Value : 0.6875          
##              Prevalence : 0.5938          
##          Detection Rate : 0.4375          
##    Detection Prevalence : 0.5000          
##       Balanced Accuracy : 0.7915          
##                                           
##        &#39;Positive&#39; Class : positiva        
## </code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="classification.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb152-2"><a href="classification.html#cb152-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modNaiveBayes01&quot;</span>, <span class="st">&quot;naiveBayes&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
</div>
<div id="decison-tree" class="section level3 hasAnchor" number="3.2.6">
<h3><span class="header-section-number">3.2.6</span> Decison tree<a href="classification.html#decison-tree" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="classification.html#cb153-1" aria-hidden="true" tabindex="-1"></a>modArvDec01 <span class="ot">=</span> <span class="fu">rpart</span>(resposta <span class="sc">~</span> difinib, <span class="at">data =</span> inibina) </span>
<span id="cb153-2"><a href="classification.html#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prp</span>(modArvDec01,  <span class="at">faclen=</span><span class="dv">0</span>, <span class="co">#use full names for factor labels</span></span>
<span id="cb153-3"><a href="classification.html#cb153-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">extra=</span><span class="dv">1</span>, <span class="co">#display number of observations for each terminal node</span></span>
<span id="cb153-4"><a href="classification.html#cb153-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">roundint=</span>F, <span class="co">#don&#39;t round to integers in output</span></span>
<span id="cb153-5"><a href="classification.html#cb153-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits=</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="classification.html#cb154-1" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modArvDec01, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb154-2"><a href="classification.html#cb154-2" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, inibina<span class="sc">$</span>resposta, <span class="at">positive =</span> <span class="st">&quot;positiva&quot;</span>)</span>
<span id="cb154-3"><a href="classification.html#cb154-3" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction negativa positiva
##   negativa        9        1
##   positiva        4       18
##                                           
##                Accuracy : 0.8438          
##                  95% CI : (0.6721, 0.9472)
##     No Information Rate : 0.5938          
##     P-Value [Acc &gt; NIR] : 0.002273        
##                                           
##                   Kappa : 0.6639          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.371093        
##                                           
##             Sensitivity : 0.9474          
##             Specificity : 0.6923          
##          Pos Pred Value : 0.8182          
##          Neg Pred Value : 0.9000          
##              Prevalence : 0.5938          
##          Detection Rate : 0.5625          
##    Detection Prevalence : 0.6875          
##       Balanced Accuracy : 0.8198          
##                                           
##        &#39;Positive&#39; Class : positiva        
## </code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="classification.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb156-2"><a href="classification.html#cb156-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modArvDec01&quot;</span>, <span class="st">&quot;rpart&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="classification.html#cb157-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">32</span></span>
<span id="cb157-2"><a href="classification.html#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(inibina<span class="sc">$</span>difinib <span class="sc">~</span>x, <span class="at">col =</span> inibina<span class="sc">$</span>resposta)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
<div id="svm" class="section level3 hasAnchor" number="3.2.7">
<h3><span class="header-section-number">3.2.7</span> SVM<a href="classification.html#svm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="classification.html#cb158-1" aria-hidden="true" tabindex="-1"></a>modSVM01 <span class="ot">=</span> <span class="fu">svm</span>(resposta <span class="sc">~</span> difinib, <span class="at">data =</span> inibina, <span class="at">kernel =</span> <span class="st">&quot;linear&quot;</span>)</span>
<span id="cb158-2"><a href="classification.html#cb158-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modSVM01, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb158-3"><a href="classification.html#cb158-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, inibina<span class="sc">$</span>resposta, <span class="at">positive =</span> <span class="st">&quot;positiva&quot;</span>)</span>
<span id="cb158-4"><a href="classification.html#cb158-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-5"><a href="classification.html#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb158-6"><a href="classification.html#cb158-6" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modSVM01&quot;</span>, <span class="st">&quot;svm&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
</div>
<div id="neuralnet" class="section level3 hasAnchor" number="3.2.8">
<h3><span class="header-section-number">3.2.8</span> neuralnet<a href="classification.html#neuralnet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="classification.html#cb159-1" aria-hidden="true" tabindex="-1"></a>modRedNeural01 <span class="ot">=</span> <span class="fu">neuralnet</span>(resposta <span class="sc">~</span> difinib, <span class="at">data =</span> inibina, <span class="at">hidden =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>))</span>
<span id="cb159-2"><a href="classification.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modRedNeural01)</span>
<span id="cb159-3"><a href="classification.html#cb159-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-4"><a href="classification.html#cb159-4" aria-hidden="true" tabindex="-1"></a>ypred <span class="ot">=</span> neuralnet<span class="sc">::</span><span class="fu">compute</span>(modRedNeural01, inibina)</span>
<span id="cb159-5"><a href="classification.html#cb159-5" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">=</span> ypred<span class="sc">$</span>net.result</span>
<span id="cb159-6"><a href="classification.html#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="classification.html#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(yhat)</span></code></pre></div>
<pre><code>##       [,1] [,2]
##  [1,]    1    0
##  [2,]    1    0
##  [3,]    0    1
##  [4,]    0    1
##  [5,]    0    1
##  [6,]    0    1
##  [7,]    0    1
##  [8,]    0    1
##  [9,]    0    1
## [10,]    0    1
## [11,]    0    1
## [12,]    0    1
## [13,]    0    1
## [14,]    1    0
## [15,]    0    1
## [16,]    0    1
## [17,]    0    1
## [18,]    0    1
## [19,]    0    1
## [20,]    1    0
## [21,]    1    0
## [22,]    1    0
## [23,]    1    0
## [24,]    1    0
## [25,]    1    0
## [26,]    1    0
## [27,]    0    1
## [28,]    1    0
## [29,]    1    0
## [30,]    1    0
## [31,]    1    0
## [32,]    1    0</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="classification.html#cb161-1" aria-hidden="true" tabindex="-1"></a>yhat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="st">&quot;yhat&quot;</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">max.col</span>(yhat[ ,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])<span class="sc">==</span><span class="dv">1</span>, <span class="st">&quot;negativa&quot;</span>, <span class="st">&quot;positiva&quot;</span>))</span>
<span id="cb161-2"><a href="classification.html#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="classification.html#cb161-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(inibina<span class="sc">$</span>resposta, <span class="fu">as.factor</span>(yhat<span class="sc">$</span>yhat))</span>
<span id="cb161-4"><a href="classification.html#cb161-4" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction negativa positiva
##   negativa       12        1
##   positiva        3       16
##                                           
##                Accuracy : 0.875           
##                  95% CI : (0.7101, 0.9649)
##     No Information Rate : 0.5312          
##     P-Value [Acc &gt; NIR] : 4.151e-05       
##                                           
##                   Kappa : 0.747           
##                                           
##  Mcnemar&#39;s Test P-Value : 0.6171          
##                                           
##             Sensitivity : 0.8000          
##             Specificity : 0.9412          
##          Pos Pred Value : 0.9231          
##          Neg Pred Value : 0.8421          
##              Prevalence : 0.4688          
##          Detection Rate : 0.3750          
##    Detection Prevalence : 0.4062          
##       Balanced Accuracy : 0.8706          
##                                           
##        &#39;Positive&#39; Class : negativa        
## </code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="classification.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb163-2"><a href="classification.html#cb163-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modRedNeural01&quot;</span>, <span class="st">&quot;neuralnet&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
</div>
<div id="knn" class="section level3 hasAnchor" number="3.2.9">
<h3><span class="header-section-number">3.2.9</span> KNN<a href="classification.html#knn" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="classification.html#cb164-1" aria-hidden="true" tabindex="-1"></a>modKnn1_01 <span class="ot">=</span> <span class="fu">knn3</span>(resposta <span class="sc">~</span> difinib, <span class="at">data =</span> inibina, <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb164-2"><a href="classification.html#cb164-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modKnn1_01, inibina, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb164-3"><a href="classification.html#cb164-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, inibina<span class="sc">$</span>resposta, <span class="at">positive =</span> <span class="st">&quot;positiva&quot;</span>)</span>
<span id="cb164-4"><a href="classification.html#cb164-4" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction negativa positiva
##   negativa       13        0
##   positiva        0       19
##                                      
##                Accuracy : 1          
##                  95% CI : (0.8911, 1)
##     No Information Rate : 0.5938     
##     P-Value [Acc &gt; NIR] : 5.693e-08  
##                                      
##                   Kappa : 1          
##                                      
##  Mcnemar&#39;s Test P-Value : NA         
##                                      
##             Sensitivity : 1.0000     
##             Specificity : 1.0000     
##          Pos Pred Value : 1.0000     
##          Neg Pred Value : 1.0000     
##              Prevalence : 0.5938     
##          Detection Rate : 0.5938     
##    Detection Prevalence : 0.5938     
##       Balanced Accuracy : 1.0000     
##                                      
##        &#39;Positive&#39; Class : positiva   
## </code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="classification.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb166-2"><a href="classification.html#cb166-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modKnn1_01-k=1&quot;</span>, <span class="st">&quot;knn3&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
<p>k = 3</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="classification.html#cb167-1" aria-hidden="true" tabindex="-1"></a>modKnn3_01 <span class="ot">=</span> <span class="fu">knn3</span>(resposta <span class="sc">~</span> difinib, <span class="at">data =</span> inibina, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb167-2"><a href="classification.html#cb167-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modKnn3_01, inibina, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb167-3"><a href="classification.html#cb167-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, inibina<span class="sc">$</span>resposta, <span class="at">positive =</span> <span class="st">&quot;positiva&quot;</span>)</span>
<span id="cb167-4"><a href="classification.html#cb167-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-5"><a href="classification.html#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb167-6"><a href="classification.html#cb167-6" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modKnn3_01-k=3&quot;</span>, <span class="st">&quot;knn3&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
<p>k = 5</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="classification.html#cb168-1" aria-hidden="true" tabindex="-1"></a>modKnn5_01 <span class="ot">=</span> <span class="fu">knn3</span>(resposta <span class="sc">~</span> difinib, <span class="at">data =</span> inibina, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb168-2"><a href="classification.html#cb168-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modKnn5_01, inibina, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb168-3"><a href="classification.html#cb168-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, inibina<span class="sc">$</span>resposta, <span class="at">positive =</span> <span class="st">&quot;positiva&quot;</span>)</span>
<span id="cb168-4"><a href="classification.html#cb168-4" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction negativa positiva
##   negativa        9        1
##   positiva        4       18
##                                           
##                Accuracy : 0.8438          
##                  95% CI : (0.6721, 0.9472)
##     No Information Rate : 0.5938          
##     P-Value [Acc &gt; NIR] : 0.002273        
##                                           
##                   Kappa : 0.6639          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.371093        
##                                           
##             Sensitivity : 0.9474          
##             Specificity : 0.6923          
##          Pos Pred Value : 0.8182          
##          Neg Pred Value : 0.9000          
##              Prevalence : 0.5938          
##          Detection Rate : 0.5625          
##    Detection Prevalence : 0.6875          
##       Balanced Accuracy : 0.8198          
##                                           
##        &#39;Positive&#39; Class : positiva        
## </code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="classification.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb170-2"><a href="classification.html#cb170-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modKnn5_01-k=5&quot;</span>, <span class="st">&quot;knn3&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
</div>
<div id="avaliando-os-modelos" class="section level3 hasAnchor" number="3.2.10">
<h3><span class="header-section-number">3.2.10</span> Avaliando os modelos<a href="classification.html#avaliando-os-modelos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
Algorithm
</th>
<th style="text-align:left;">
Accuracy
</th>
<th style="text-align:left;">
Sensitivity
</th>
<th style="text-align:left;">
Specificity
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
modLogist01
</td>
<td style="text-align:left;">
glm
</td>
<td style="text-align:left;">
0.84375
</td>
<td style="text-align:left;">
0.894736842105263
</td>
<td style="text-align:left;">
0.769230769230769
</td>
</tr>
<tr>
<td style="text-align:left;">
modLogist02-LOOCV
</td>
<td style="text-align:left;">
glm
</td>
<td style="text-align:left;">
0.84375
</td>
<td style="text-align:left;">
0.894736842105263
</td>
<td style="text-align:left;">
0.769230769230769
</td>
</tr>
<tr>
<td style="text-align:left;">
modFisher01-prior 0.5 / 0.5
</td>
<td style="text-align:left;">
lda
</td>
<td style="text-align:left;">
0.75
</td>
<td style="text-align:left;">
0.684210526315789
</td>
<td style="text-align:left;">
0.846153846153846
</td>
</tr>
<tr>
<td style="text-align:left;">
modBayes01-prior 0.65 / 0.35
</td>
<td style="text-align:left;">
lda
</td>
<td style="text-align:left;">
0.59375
</td>
<td style="text-align:left;">
0.315789473684211
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
modNaiveBayes01
</td>
<td style="text-align:left;">
naiveBayes
</td>
<td style="text-align:left;">
0.78125
</td>
<td style="text-align:left;">
0.736842105263158
</td>
<td style="text-align:left;">
0.846153846153846
</td>
</tr>
<tr>
<td style="text-align:left;">
modArvDec01
</td>
<td style="text-align:left;">
rpart
</td>
<td style="text-align:left;">
0.84375
</td>
<td style="text-align:left;">
0.947368421052632
</td>
<td style="text-align:left;">
0.692307692307692
</td>
</tr>
<tr>
<td style="text-align:left;">
modSVM01
</td>
<td style="text-align:left;">
svm
</td>
<td style="text-align:left;">
0.84375
</td>
<td style="text-align:left;">
0.894736842105263
</td>
<td style="text-align:left;">
0.769230769230769
</td>
</tr>
<tr>
<td style="text-align:left;">
modRedNeural01
</td>
<td style="text-align:left;">
neuralnet
</td>
<td style="text-align:left;">
0.875
</td>
<td style="text-align:left;">
0.8
</td>
<td style="text-align:left;">
0.941176470588235
</td>
</tr>
<tr>
<td style="text-align:left;">
modKnn1_01-k=1
</td>
<td style="text-align:left;">
knn3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
modKnn3_01-k=3
</td>
<td style="text-align:left;">
knn3
</td>
<td style="text-align:left;">
0.875
</td>
<td style="text-align:left;">
0.894736842105263
</td>
<td style="text-align:left;">
0.846153846153846
</td>
</tr>
<tr>
<td style="text-align:left;">
modKnn5_01-k=5
</td>
<td style="text-align:left;">
knn3
</td>
<td style="text-align:left;">
0.84375
</td>
<td style="text-align:left;">
0.947368421052632
</td>
<td style="text-align:left;">
0.692307692307692
</td>
</tr>
</tbody>
</table>
<p>Os modelos modLogist01, modFisher01 com <span class="math inline">\(prior = 0.5, 0.5\)</span>, modArvDec01 e modKnn3_01 com <span class="math inline">\(k=3\)</span> tiveram performance muito parecidas no conjunto de dados. Uma possível escolha seria o modKnn3_01 que combinado obteve melhor acurácia, sensibilidade e especificidade.</p>
</div>
<div id="agrupamento-1" class="section level3 hasAnchor" number="3.2.11">
<h3><span class="header-section-number">3.2.11</span> Agrupamento<a href="classification.html#agrupamento-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="classification.html#cb171-1" aria-hidden="true" tabindex="-1"></a>inibinaS <span class="ot">=</span> inibina[, <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb171-2"><a href="classification.html#cb171-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-3"><a href="classification.html#cb171-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(inibinaS, <span class="at">method =</span> <span class="st">&quot;maximum&quot;</span>)</span>
<span id="cb171-4"><a href="classification.html#cb171-4" aria-hidden="true" tabindex="-1"></a>grup <span class="ot">=</span> <span class="fu">hclust</span>(d, <span class="at">method =</span> <span class="st">&quot;ward.D&quot;</span>)</span>
<span id="cb171-5"><a href="classification.html#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grup, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="classification.html#cb172-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">cutree</span>(grup, <span class="at">k=</span><span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="classification.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(groups, inibina<span class="sc">$</span>resposta)</span></code></pre></div>
<pre><code>##       
## groups negativa positiva
##      1       11        7
##      2        2       11
##      3        0        1</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="classification.html#cb175-1" aria-hidden="true" tabindex="-1"></a>km1 <span class="ot">=</span> <span class="fu">kmeans</span>(inibinaS, <span class="dv">4</span>)</span>
<span id="cb175-2"><a href="classification.html#cb175-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">fviz_cluster</span>(km1, <span class="at">data=</span>inibinaS,</span>
<span id="cb175-3"><a href="classification.html#cb175-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#2E9FDF&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#E7B700&quot;</span>),</span>
<span id="cb175-4"><a href="classification.html#cb175-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">star.plot=</span><span class="cn">FALSE</span>,</span>
<span id="cb175-5"><a href="classification.html#cb175-5" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># repel=TRUE,</span></span>
<span id="cb175-6"><a href="classification.html#cb175-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme=</span><span class="fu">theme_bw</span>())</span>
<span id="cb175-7"><a href="classification.html#cb175-7" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="classification.html#cb176-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">=</span> km1<span class="sc">$</span>cluster</span>
<span id="cb176-2"><a href="classification.html#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(groups, inibina<span class="sc">$</span>resposta)</span></code></pre></div>
<pre><code>##       
## groups negativa positiva
##      1        2       10
##      2        2        6
##      3        9        2
##      4        0        1</code></pre>
</div>
</div>
<div id="ultrassom-para-medir-deslocamento-do-disco" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Ultrassom para medir deslocamento do disco<a href="classification.html#ultrassom-para-medir-deslocamento-do-disco" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Os dados disponíveis aqui foram extraídos de um estudo realizado no Hospital Universitário da Universidade de São Paulo com o objetivo de avaliar se algumas medidas obtidas ultrassonograficamente poderiam ser utilizadas como substitutas de medidas obtidas por métodos de ressonância magnética, considerada como padrão ouro para avaliação do deslocamento do disco da articulação temporomandibular (referido simplesmente como disco).</p>
<div id="pacotes-7" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Pacotes<a href="classification.html#pacotes-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pacotes necessários para estes exercícios:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="classification.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb178-2"><a href="classification.html#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb178-3"><a href="classification.html#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb178-4"><a href="classification.html#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb178-5"><a href="classification.html#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb178-6"><a href="classification.html#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb178-7"><a href="classification.html#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb178-8"><a href="classification.html#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb178-9"><a href="classification.html#cb178-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb178-10"><a href="classification.html#cb178-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb178-11"><a href="classification.html#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb178-12"><a href="classification.html#cb178-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span>
<span id="cb178-13"><a href="classification.html#cb178-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb178-14"><a href="classification.html#cb178-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb178-15"><a href="classification.html#cb178-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb178-16"><a href="classification.html#cb178-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(neuralnet)</span>
<span id="cb178-17"><a href="classification.html#cb178-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb178-18"><a href="classification.html#cb178-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code></pre></div>
</div>
<div id="conjunto-de-dados-9" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Conjunto de dados<a href="classification.html#conjunto-de-dados-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="classification.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co">#GET(&quot;http://www.ime.usp.br/~jmsinger/MorettinSinger/disco.xls&quot;, write_disk(tf &lt;- tempfile(fileext = &quot;.xls&quot;)))</span></span>
<span id="cb179-2"><a href="classification.html#cb179-2" aria-hidden="true" tabindex="-1"></a>httr<span class="sc">::</span><span class="fu">GET</span>(<span class="st">&quot;http://www.ime.usp.br/~jmsinger/MorettinSinger/disco.xls&quot;</span>, httr<span class="sc">::</span><span class="fu">write_disk</span>(<span class="st">&quot;../dados/disco.xls&quot;</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## Response [https://www.ime.usp.br/~jmsinger/MorettinSinger/disco.xls]
##   Date: 2022-11-15 23:40
##   Status: 200
##   Content-Type: application/vnd.ms-excel
##   Size: 11.3 kB
## &lt;ON DISK&gt;  G:\onedrive\obsidian\adsantos\Mestrado\BD\trabalhos\caderno-bd\dados\disco.xls</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="classification.html#cb181-1" aria-hidden="true" tabindex="-1"></a>disco <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;../dados/disco.xls&quot;</span>)</span>
<span id="cb181-2"><a href="classification.html#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(disco)</span></code></pre></div>
<pre><code>## tibble [104 × 3] (S3: tbl_df/tbl/data.frame)
##  $ deslocamento: num [1:104] 0 0 0 1 0 1 0 0 0 0 ...
##  $ distanciaA  : num [1:104] 2.2 2.4 2.6 3.5 1.3 2.8 1.5 2.6 1.2 1.7 ...
##  $ distanciaF  : num [1:104] 1.4 1.2 2 1.8 1 1.1 1.2 1.1 0.6 1.5 ...</code></pre>
<p>Número de observações 104.</p>
<div id="categorizando-a-variável-de-deslocamento." class="section level4 hasAnchor" number="3.3.2.1">
<h4><span class="header-section-number">3.3.2.1</span> Categorizando a variável de deslocamento.<a href="classification.html#categorizando-a-variável-de-deslocamento." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="classification.html#cb183-1" aria-hidden="true" tabindex="-1"></a>disco<span class="sc">$</span>sumdistancia <span class="ot">=</span> disco<span class="sc">$</span>distanciaA <span class="sc">+</span> disco<span class="sc">$</span>distanciaF</span>
<span id="cb183-2"><a href="classification.html#cb183-2" aria-hidden="true" tabindex="-1"></a>disco<span class="sc">$</span>deslocamento <span class="ot">=</span> <span class="fu">as.factor</span>(disco<span class="sc">$</span>deslocamento)</span></code></pre></div>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="classification.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(disco<span class="sc">$</span>sumdistancia  <span class="sc">~</span> disco<span class="sc">$</span>deslocamento)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-84-1.png" width="672" /></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="classification.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(disco, <span class="at">n =</span> <span class="dv">32</span>)</span></code></pre></div>
<pre><code>## # A tibble: 104 × 4
##    deslocamento distanciaA distanciaF sumdistancia
##    &lt;fct&gt;             &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
##  1 0                   2.2        1.4          3.6
##  2 0                   2.4        1.2          3.6
##  3 0                   2.6        2            4.6
##  4 1                   3.5        1.8          5.3
##  5 0                   1.3        1            2.3
##  6 1                   2.8        1.1          3.9
##  7 0                   1.5        1.2          2.7
##  8 0                   2.6        1.1          3.7
##  9 0                   1.2        0.6          1.8
## 10 0                   1.7        1.5          3.2
## 11 0                   1.3        1.2          2.5
## 12 0                   1.2        1            2.2
## 13 1                   4          2.5          6.5
## 14 0                   1.2        1            2.2
## 15 1                   3.1        1.7          4.8
## 16 1                   2.6        0.6          3.2
## 17 0                   1.8        0.8          2.6
## 18 0                   1.2        1            2.2
## 19 0                   1.9        1            2.9
## 20 0                   1.2        0.9          2.1
## 21 1                   1.7        0.9          2.6
## 22 0                   1.2        0.8          2  
## 23 1                   3.9        3.2          7.1
## 24 0                   1.7        1.1          2.8
## 25 0                   1.4        1            2.4
## 26 0                   1.6        1.3          2.9
## 27 0                   1.3        0.5          1.8
## 28 0                   1.7        0.7          2.4
## 29 1                   2.6        1.8          4.4
## 30 0                   1.5        1.5          3  
## 31 0                   1.8        1.4          3.2
## 32 0                   1.2        0.9          2.1
## # … with 72 more rows</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="classification.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(disco)</span></code></pre></div>
<pre><code>##  deslocamento   distanciaA      distanciaF     sumdistancia  
##  0:75         Min.   :0.500   Min.   :0.400   Min.   :1.100  
##  1:29         1st Qu.:1.400   1st Qu.:1.000   1st Qu.:2.500  
##               Median :1.700   Median :1.200   Median :2.900  
##               Mean   :1.907   Mean   :1.362   Mean   :3.268  
##               3rd Qu.:2.300   3rd Qu.:1.600   3rd Qu.:3.700  
##               Max.   :4.900   Max.   :3.300   Max.   :7.100</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="classification.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(disco<span class="sc">$</span>sumdistancia)</span></code></pre></div>
<pre><code>## [1] 1.183976</code></pre>
<p>Criando um dataframe para comparar as métricas dos modelos.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="classification.html#cb191-1" aria-hidden="true" tabindex="-1"></a>model_eval <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb191-2"><a href="classification.html#cb191-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-3"><a href="classification.html#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(model_eval) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Model&#39;</span>, <span class="st">&#39;Algorithm&#39;</span>, <span class="st">&#39;Accuracy&#39;</span>, <span class="st">&#39;Sensitivity&#39;</span>, <span class="st">&#39;Specificity&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="generalized-linear-models-1" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Generalized Linear Models<a href="classification.html#generalized-linear-models-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="classification.html#cb192-1" aria-hidden="true" tabindex="-1"></a>modLogist01 <span class="ot">=</span> <span class="fu">glm</span>(deslocamento <span class="sc">~</span> sumdistancia, <span class="at">family =</span> binomial, <span class="at">data =</span> disco)</span>
<span id="cb192-2"><a href="classification.html#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modLogist01)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = deslocamento ~ sumdistancia, family = binomial, 
##     data = disco)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2291  -0.4957  -0.3182   0.1560   2.3070  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -7.3902     1.3740  -5.379 7.51e-08 ***
## sumdistancia   1.8467     0.3799   4.861 1.17e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 123.107  on 103  degrees of freedom
## Residual deviance:  72.567  on 102  degrees of freedom
## AIC: 76.567
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="classification.html#cb194-1" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict.glm</span>(modLogist01, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb194-2"><a href="classification.html#cb194-2" aria-hidden="true" tabindex="-1"></a>classPred <span class="ot">=</span> <span class="fu">ifelse</span>(predito<span class="sc">&gt;</span><span class="fl">0.5</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>)</span>
<span id="cb194-3"><a href="classification.html#cb194-3" aria-hidden="true" tabindex="-1"></a>classPred <span class="ot">=</span> <span class="fu">as.factor</span>(classPred)</span>
<span id="cb194-4"><a href="classification.html#cb194-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(classPred, disco<span class="sc">$</span>deslocamento, <span class="at">positive =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb194-5"><a href="classification.html#cb194-5" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0  5 16
##          1 70 13
##                                           
##                Accuracy : 0.1731          
##                  95% CI : (0.1059, 0.2597)
##     No Information Rate : 0.7212          
##     P-Value [Acc &gt; NIR] : 1               
##                                           
##                   Kappa : -0.3088         
##                                           
##  Mcnemar&#39;s Test P-Value : 1.096e-08       
##                                           
##             Sensitivity : 0.06667         
##             Specificity : 0.44828         
##          Pos Pred Value : 0.23810         
##          Neg Pred Value : 0.15663         
##              Prevalence : 0.72115         
##          Detection Rate : 0.04808         
##    Detection Prevalence : 0.20192         
##       Balanced Accuracy : 0.25747         
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="classification.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb196-2"><a href="classification.html#cb196-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modLogist01&quot;</span>, <span class="st">&quot;glm&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
<p>Validação cruzada leave-one-out</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="classification.html#cb197-1" aria-hidden="true" tabindex="-1"></a>trControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;LOOCV&quot;</span>)</span>
<span id="cb197-2"><a href="classification.html#cb197-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-3"><a href="classification.html#cb197-3" aria-hidden="true" tabindex="-1"></a>modLogist02 <span class="ot">&lt;-</span> <span class="fu">train</span>(deslocamento <span class="sc">~</span> sumdistancia, <span class="at">method =</span> <span class="st">&quot;glm&quot;</span>, <span class="at">data =</span> disco, <span class="at">family =</span> binomial,</span>
<span id="cb197-4"><a href="classification.html#cb197-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">trControl =</span> trControl, <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb197-5"><a href="classification.html#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modLogist02)</span></code></pre></div>
<pre><code>## 
## Call:
## NULL
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2291  -0.4957  -0.3182   0.1560   2.3070  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   -7.3902     1.3740  -5.379 7.51e-08 ***
## sumdistancia   1.8467     0.3799   4.861 1.17e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 123.107  on 103  degrees of freedom
## Residual deviance:  72.567  on 102  degrees of freedom
## AIC: 76.567
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="classification.html#cb199-1" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modLogist02, <span class="at">newdata =</span> disco)</span>
<span id="cb199-2"><a href="classification.html#cb199-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-3"><a href="classification.html#cb199-3" aria-hidden="true" tabindex="-1"></a>classPred <span class="ot">=</span> <span class="fu">as.factor</span>(predito)</span>
<span id="cb199-4"><a href="classification.html#cb199-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-5"><a href="classification.html#cb199-5" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(classPred, disco<span class="sc">$</span>deslocamento, <span class="at">positive =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb199-6"><a href="classification.html#cb199-6" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0 70 13
##          1  5 16
##                                           
##                Accuracy : 0.8269          
##                  95% CI : (0.7403, 0.8941)
##     No Information Rate : 0.7212          
##     P-Value [Acc &gt; NIR] : 0.00857         
##                                           
##                   Kappa : 0.5299          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.09896         
##                                           
##             Sensitivity : 0.9333          
##             Specificity : 0.5517          
##          Pos Pred Value : 0.8434          
##          Neg Pred Value : 0.7619          
##              Prevalence : 0.7212          
##          Detection Rate : 0.6731          
##    Detection Prevalence : 0.7981          
##       Balanced Accuracy : 0.7425          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="classification.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb201-2"><a href="classification.html#cb201-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modLogist02-LOOCV&quot;</span>, <span class="st">&quot;glm&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="classification.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(model_eval) <span class="sc">%&gt;%</span></span>
<span id="cb202-2"><a href="classification.html#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;striped&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
Algorithm
</th>
<th style="text-align:left;">
Accuracy
</th>
<th style="text-align:left;">
Sensitivity
</th>
<th style="text-align:left;">
Specificity
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
modLogist01
</td>
<td style="text-align:left;">
glm
</td>
<td style="text-align:left;">
0.173076923076923
</td>
<td style="text-align:left;">
0.0666666666666667
</td>
<td style="text-align:left;">
0.448275862068966
</td>
</tr>
<tr>
<td style="text-align:left;">
modLogist02-LOOCV
</td>
<td style="text-align:left;">
glm
</td>
<td style="text-align:left;">
0.826923076923077
</td>
<td style="text-align:left;">
0.933333333333333
</td>
<td style="text-align:left;">
0.551724137931034
</td>
</tr>
</tbody>
</table>
<p>Treinar o modelo com o método LOOCV melhorou consideravelmente todas as métricas do modelo.</p>
</div>
<div id="linear-discriminant-analysis---fisher-1" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Linear Discriminant Analysis - Fisher<a href="classification.html#linear-discriminant-analysis---fisher-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="classification.html#cb203-1" aria-hidden="true" tabindex="-1"></a>modFisher01 <span class="ot">=</span> <span class="fu">lda</span>(deslocamento <span class="sc">~</span> sumdistancia, <span class="at">data =</span> disco, <span class="at">prior =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</span>
<span id="cb203-2"><a href="classification.html#cb203-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modFisher01)</span>
<span id="cb203-3"><a href="classification.html#cb203-3" aria-hidden="true" tabindex="-1"></a>classPred <span class="ot">=</span> predito<span class="sc">$</span>class</span>
<span id="cb203-4"><a href="classification.html#cb203-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(classPred, disco<span class="sc">$</span>deslocamento, <span class="at">positive =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb203-5"><a href="classification.html#cb203-5" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0 67  6
##          1  8 23
##                                           
##                Accuracy : 0.8654          
##                  95% CI : (0.7845, 0.9244)
##     No Information Rate : 0.7212          
##     P-Value [Acc &gt; NIR] : 0.0003676       
##                                           
##                   Kappa : 0.6722          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.7892680       
##                                           
##             Sensitivity : 0.8933          
##             Specificity : 0.7931          
##          Pos Pred Value : 0.9178          
##          Neg Pred Value : 0.7419          
##              Prevalence : 0.7212          
##          Detection Rate : 0.6442          
##    Detection Prevalence : 0.7019          
##       Balanced Accuracy : 0.8432          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="classification.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb205-2"><a href="classification.html#cb205-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modFisher01-prior 0.5 / 0.5&quot;</span>, <span class="st">&quot;lda&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
</div>
<div id="bayes-1" class="section level3 hasAnchor" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> Bayes<a href="classification.html#bayes-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="classification.html#cb206-1" aria-hidden="true" tabindex="-1"></a>modBayes01 <span class="ot">=</span> <span class="fu">lda</span>(deslocamento <span class="sc">~</span> sumdistancia, <span class="at">data =</span> disco, <span class="at">prior =</span> <span class="fu">c</span>(<span class="fl">0.65</span>, <span class="fl">0.35</span>))</span>
<span id="cb206-2"><a href="classification.html#cb206-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modBayes01)</span>
<span id="cb206-3"><a href="classification.html#cb206-3" aria-hidden="true" tabindex="-1"></a>classPred <span class="ot">=</span> predito<span class="sc">$</span>class</span>
<span id="cb206-4"><a href="classification.html#cb206-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(classPred, disco<span class="sc">$</span>deslocamento, <span class="at">positive =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb206-5"><a href="classification.html#cb206-5" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0 70 12
##          1  5 17
##                                           
##                Accuracy : 0.8365          
##                  95% CI : (0.7512, 0.9018)
##     No Information Rate : 0.7212          
##     P-Value [Acc &gt; NIR] : 0.004313        
##                                           
##                   Kappa : 0.5611          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.145610        
##                                           
##             Sensitivity : 0.9333          
##             Specificity : 0.5862          
##          Pos Pred Value : 0.8537          
##          Neg Pred Value : 0.7727          
##              Prevalence : 0.7212          
##          Detection Rate : 0.6731          
##    Detection Prevalence : 0.7885          
##       Balanced Accuracy : 0.7598          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="classification.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb208-2"><a href="classification.html#cb208-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modBayes01-prior 0.65 / 0.35&quot;</span>, <span class="st">&quot;lda&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="classification.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(classPred)</span></code></pre></div>
<pre><code>## classPred
##  0  1 
## 82 22</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="classification.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(disco, <span class="at">n =</span> <span class="dv">32</span>)</span></code></pre></div>
<pre><code>## # A tibble: 104 × 4
##    deslocamento distanciaA distanciaF sumdistancia
##    &lt;fct&gt;             &lt;dbl&gt;      &lt;dbl&gt;        &lt;dbl&gt;
##  1 0                   2.2        1.4          3.6
##  2 0                   2.4        1.2          3.6
##  3 0                   2.6        2            4.6
##  4 1                   3.5        1.8          5.3
##  5 0                   1.3        1            2.3
##  6 1                   2.8        1.1          3.9
##  7 0                   1.5        1.2          2.7
##  8 0                   2.6        1.1          3.7
##  9 0                   1.2        0.6          1.8
## 10 0                   1.7        1.5          3.2
## 11 0                   1.3        1.2          2.5
## 12 0                   1.2        1            2.2
## 13 1                   4          2.5          6.5
## 14 0                   1.2        1            2.2
## 15 1                   3.1        1.7          4.8
## 16 1                   2.6        0.6          3.2
## 17 0                   1.8        0.8          2.6
## 18 0                   1.2        1            2.2
## 19 0                   1.9        1            2.9
## 20 0                   1.2        0.9          2.1
## 21 1                   1.7        0.9          2.6
## 22 0                   1.2        0.8          2  
## 23 1                   3.9        3.2          7.1
## 24 0                   1.7        1.1          2.8
## 25 0                   1.4        1            2.4
## 26 0                   1.6        1.3          2.9
## 27 0                   1.3        0.5          1.8
## 28 0                   1.7        0.7          2.4
## 29 1                   2.6        1.8          4.4
## 30 0                   1.5        1.5          3  
## 31 0                   1.8        1.4          3.2
## 32 0                   1.2        0.9          2.1
## # … with 72 more rows</code></pre>
<p>Naive Bayes</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="classification.html#cb213-1" aria-hidden="true" tabindex="-1"></a>modNaiveBayes01 <span class="ot">=</span> <span class="fu">naiveBayes</span>(deslocamento <span class="sc">~</span> sumdistancia, <span class="at">data =</span> disco)</span>
<span id="cb213-2"><a href="classification.html#cb213-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modNaiveBayes01, disco)</span>
<span id="cb213-3"><a href="classification.html#cb213-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, disco<span class="sc">$</span>deslocamento, <span class="at">positive =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb213-4"><a href="classification.html#cb213-4" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0 70 13
##          1  5 16
##                                           
##                Accuracy : 0.8269          
##                  95% CI : (0.7403, 0.8941)
##     No Information Rate : 0.7212          
##     P-Value [Acc &gt; NIR] : 0.00857         
##                                           
##                   Kappa : 0.5299          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.09896         
##                                           
##             Sensitivity : 0.9333          
##             Specificity : 0.5517          
##          Pos Pred Value : 0.8434          
##          Neg Pred Value : 0.7619          
##              Prevalence : 0.7212          
##          Detection Rate : 0.6731          
##    Detection Prevalence : 0.7981          
##       Balanced Accuracy : 0.7425          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="classification.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb215-2"><a href="classification.html#cb215-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modNaiveBayes01&quot;</span>, <span class="st">&quot;naiveBayes&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
</div>
<div id="decison-tree-1" class="section level3 hasAnchor" number="3.3.6">
<h3><span class="header-section-number">3.3.6</span> Decison tree<a href="classification.html#decison-tree-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="classification.html#cb216-1" aria-hidden="true" tabindex="-1"></a>modArvDec01 <span class="ot">=</span> <span class="fu">rpart</span>(deslocamento <span class="sc">~</span> sumdistancia, <span class="at">data =</span> disco) </span>
<span id="cb216-2"><a href="classification.html#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prp</span>(modArvDec01,  <span class="at">faclen=</span><span class="dv">0</span>, <span class="co">#use full names for factor labels</span></span>
<span id="cb216-3"><a href="classification.html#cb216-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">extra=</span><span class="dv">1</span>, <span class="co">#display number of observations for each terminal node</span></span>
<span id="cb216-4"><a href="classification.html#cb216-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">roundint=</span>F, <span class="co">#don&#39;t round to integers in output</span></span>
<span id="cb216-5"><a href="classification.html#cb216-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits=</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="classification.html#cb217-1" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modArvDec01, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb217-2"><a href="classification.html#cb217-2" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, disco<span class="sc">$</span>deslocamento, <span class="at">positive =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb217-3"><a href="classification.html#cb217-3" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0 67  6
##          1  8 23
##                                           
##                Accuracy : 0.8654          
##                  95% CI : (0.7845, 0.9244)
##     No Information Rate : 0.7212          
##     P-Value [Acc &gt; NIR] : 0.0003676       
##                                           
##                   Kappa : 0.6722          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.7892680       
##                                           
##             Sensitivity : 0.8933          
##             Specificity : 0.7931          
##          Pos Pred Value : 0.9178          
##          Neg Pred Value : 0.7419          
##              Prevalence : 0.7212          
##          Detection Rate : 0.6442          
##    Detection Prevalence : 0.7019          
##       Balanced Accuracy : 0.8432          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="classification.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb219-2"><a href="classification.html#cb219-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modArvDec01&quot;</span>, <span class="st">&quot;rpart&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="classification.html#cb220-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(disco)</span>
<span id="cb220-2"><a href="classification.html#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(disco<span class="sc">$</span>sumdistancia <span class="sc">~</span> x, <span class="at">col =</span> disco<span class="sc">$</span>deslocamento)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
</div>
<div id="svm-1" class="section level3 hasAnchor" number="3.3.7">
<h3><span class="header-section-number">3.3.7</span> SVM<a href="classification.html#svm-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="classification.html#cb221-1" aria-hidden="true" tabindex="-1"></a>modSVM01 <span class="ot">=</span> <span class="fu">svm</span>(deslocamento <span class="sc">~</span> sumdistancia, <span class="at">data =</span> disco, <span class="at">kernel =</span> <span class="st">&quot;linear&quot;</span>)</span>
<span id="cb221-2"><a href="classification.html#cb221-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modSVM01, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb221-3"><a href="classification.html#cb221-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, disco<span class="sc">$</span>deslocamento, <span class="at">positive =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb221-4"><a href="classification.html#cb221-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-5"><a href="classification.html#cb221-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb221-6"><a href="classification.html#cb221-6" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modSVM01&quot;</span>, <span class="st">&quot;svm&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
</div>
<div id="neuralnet-1" class="section level3 hasAnchor" number="3.3.8">
<h3><span class="header-section-number">3.3.8</span> neuralnet<a href="classification.html#neuralnet-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="classification.html#cb222-1" aria-hidden="true" tabindex="-1"></a>modRedNeural01 <span class="ot">=</span> <span class="fu">neuralnet</span>(deslocamento <span class="sc">~</span> sumdistancia, <span class="at">data =</span> disco, <span class="at">hidden =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>))</span>
<span id="cb222-2"><a href="classification.html#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modRedNeural01)</span>
<span id="cb222-3"><a href="classification.html#cb222-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-4"><a href="classification.html#cb222-4" aria-hidden="true" tabindex="-1"></a>ypred <span class="ot">=</span> neuralnet<span class="sc">::</span><span class="fu">compute</span>(modRedNeural01, disco)</span>
<span id="cb222-5"><a href="classification.html#cb222-5" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">=</span> ypred<span class="sc">$</span>net.result</span>
<span id="cb222-6"><a href="classification.html#cb222-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-7"><a href="classification.html#cb222-7" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(yhat)</span></code></pre></div>
<pre><code>##        [,1] [,2]
##   [1,]    1    0
##   [2,]    1    0
##   [3,]    0    1
##   [4,]    0    1
##   [5,]    1    0
##   [6,]    1    0
##   [7,]    1    0
##   [8,]    1    0
##   [9,]    1    0
##  [10,]    1    0
##  [11,]    1    0
##  [12,]    1    0
##  [13,]    0    1
##  [14,]    1    0
##  [15,]    0    1
##  [16,]    1    0
##  [17,]    1    0
##  [18,]    1    0
##  [19,]    1    0
##  [20,]    1    0
##  [21,]    1    0
##  [22,]    1    0
##  [23,]    0    1
##  [24,]    1    0
##  [25,]    1    0
##  [26,]    1    0
##  [27,]    1    0
##  [28,]    1    0
##  [29,]    0    1
##  [30,]    1    0
##  [31,]    1    0
##  [32,]    1    0
##  [33,]    1    0
##  [34,]    1    0
##  [35,]    1    0
##  [36,]    1    0
##  [37,]    1    0
##  [38,]    0    1
##  [39,]    1    0
##  [40,]    1    0
##  [41,]    1    0
##  [42,]    1    0
##  [43,]    1    0
##  [44,]    1    0
##  [45,]    1    0
##  [46,]    1    0
##  [47,]    1    0
##  [48,]    1    0
##  [49,]    1    0
##  [50,]    1    0
##  [51,]    1    0
##  [52,]    1    0
##  [53,]    1    0
##  [54,]    1    0
##  [55,]    1    0
##  [56,]    1    0
##  [57,]    1    0
##  [58,]    1    0
##  [59,]    1    0
##  [60,]    0    1
##  [61,]    0    1
##  [62,]    0    1
##  [63,]    0    1
##  [64,]    0    1
##  [65,]    1    0
##  [66,]    1    0
##  [67,]    1    0
##  [68,]    1    0
##  [69,]    1    0
##  [70,]    1    0
##  [71,]    0    1
##  [72,]    1    0
##  [73,]    1    0
##  [74,]    1    0
##  [75,]    1    0
##  [76,]    1    0
##  [77,]    1    0
##  [78,]    1    0
##  [79,]    0    1
##  [80,]    1    0
##  [81,]    1    0
##  [82,]    1    0
##  [83,]    1    0
##  [84,]    1    0
##  [85,]    0    1
##  [86,]    1    0
##  [87,]    0    1
##  [88,]    1    0
##  [89,]    1    0
##  [90,]    1    0
##  [91,]    0    1
##  [92,]    0    1
##  [93,]    1    0
##  [94,]    1    0
##  [95,]    1    0
##  [96,]    0    1
##  [97,]    0    1
##  [98,]    0    1
##  [99,]    1    0
## [100,]    1    0
## [101,]    1    0
## [102,]    1    0
## [103,]    1    0
## [104,]    0    1</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="classification.html#cb224-1" aria-hidden="true" tabindex="-1"></a>yhat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="st">&quot;yhat&quot;</span><span class="ot">=</span><span class="fu">ifelse</span>(<span class="fu">max.col</span>(yhat[ ,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])<span class="sc">==</span><span class="dv">1</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>))</span>
<span id="cb224-2"><a href="classification.html#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="classification.html#cb224-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(disco<span class="sc">$</span>deslocamento, <span class="fu">as.factor</span>(yhat<span class="sc">$</span>yhat))</span>
<span id="cb224-4"><a href="classification.html#cb224-4" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0 70  5
##          1 12 17
##                                           
##                Accuracy : 0.8365          
##                  95% CI : (0.7512, 0.9018)
##     No Information Rate : 0.7885          
##     P-Value [Acc &gt; NIR] : 0.1388          
##                                           
##                   Kappa : 0.5611          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.1456          
##                                           
##             Sensitivity : 0.8537          
##             Specificity : 0.7727          
##          Pos Pred Value : 0.9333          
##          Neg Pred Value : 0.5862          
##              Prevalence : 0.7885          
##          Detection Rate : 0.6731          
##    Detection Prevalence : 0.7212          
##       Balanced Accuracy : 0.8132          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="classification.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb226-2"><a href="classification.html#cb226-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modRedNeural01&quot;</span>, <span class="st">&quot;neuralnet&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
</div>
<div id="knn-1" class="section level3 hasAnchor" number="3.3.9">
<h3><span class="header-section-number">3.3.9</span> KNN<a href="classification.html#knn-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="classification.html#cb227-1" aria-hidden="true" tabindex="-1"></a>modKnn1_01 <span class="ot">=</span> <span class="fu">knn3</span>(deslocamento <span class="sc">~</span> sumdistancia, <span class="at">data =</span> disco, <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb227-2"><a href="classification.html#cb227-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modKnn1_01, disco, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb227-3"><a href="classification.html#cb227-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, disco<span class="sc">$</span>deslocamento, <span class="at">positive =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb227-4"><a href="classification.html#cb227-4" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0 72 11
##          1  3 18
##                                           
##                Accuracy : 0.8654          
##                  95% CI : (0.7845, 0.9244)
##     No Information Rate : 0.7212          
##     P-Value [Acc &gt; NIR] : 0.0003676       
##                                           
##                   Kappa : 0.6344          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0613688       
##                                           
##             Sensitivity : 0.9600          
##             Specificity : 0.6207          
##          Pos Pred Value : 0.8675          
##          Neg Pred Value : 0.8571          
##              Prevalence : 0.7212          
##          Detection Rate : 0.6923          
##    Detection Prevalence : 0.7981          
##       Balanced Accuracy : 0.7903          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="classification.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb229-2"><a href="classification.html#cb229-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modKnn1_01-k=1&quot;</span>, <span class="st">&quot;knn3&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
<p>k = 3</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="classification.html#cb230-1" aria-hidden="true" tabindex="-1"></a>modKnn3_01 <span class="ot">=</span> <span class="fu">knn3</span>(deslocamento <span class="sc">~</span> sumdistancia, <span class="at">data =</span> disco, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb230-2"><a href="classification.html#cb230-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modKnn3_01, disco, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb230-3"><a href="classification.html#cb230-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, disco<span class="sc">$</span>deslocamento, <span class="at">positive =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb230-4"><a href="classification.html#cb230-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-5"><a href="classification.html#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb230-6"><a href="classification.html#cb230-6" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modKnn3_01-k=3&quot;</span>, <span class="st">&quot;knn3&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
<p>k = 5</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="classification.html#cb231-1" aria-hidden="true" tabindex="-1"></a>modKnn5_01 <span class="ot">=</span> <span class="fu">knn3</span>(deslocamento <span class="sc">~</span> sumdistancia, <span class="at">data =</span> disco, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb231-2"><a href="classification.html#cb231-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modKnn5_01, disco, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb231-3"><a href="classification.html#cb231-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, disco<span class="sc">$</span>deslocamento, <span class="at">positive =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb231-4"><a href="classification.html#cb231-4" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0 72  9
##          1  3 20
##                                           
##                Accuracy : 0.8846          
##                  95% CI : (0.8071, 0.9389)
##     No Information Rate : 0.7212          
##     P-Value [Acc &gt; NIR] : 4.877e-05       
##                                           
##                   Kappa : 0.6937          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.1489          
##                                           
##             Sensitivity : 0.9600          
##             Specificity : 0.6897          
##          Pos Pred Value : 0.8889          
##          Neg Pred Value : 0.8696          
##              Prevalence : 0.7212          
##          Detection Rate : 0.6923          
##    Detection Prevalence : 0.7788          
##       Balanced Accuracy : 0.8248          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="classification.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb233-2"><a href="classification.html#cb233-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modKnn5_01-k=5&quot;</span>, <span class="st">&quot;knn3&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], cm<span class="sc">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>])</span></code></pre></div>
</div>
<div id="avaliando-os-modelos-1" class="section level3 hasAnchor" number="3.3.10">
<h3><span class="header-section-number">3.3.10</span> Avaliando os modelos<a href="classification.html#avaliando-os-modelos-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
Algorithm
</th>
<th style="text-align:left;">
Accuracy
</th>
<th style="text-align:left;">
Sensitivity
</th>
<th style="text-align:left;">
Specificity
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
modLogist01
</td>
<td style="text-align:left;">
glm
</td>
<td style="text-align:left;">
0.173076923076923
</td>
<td style="text-align:left;">
0.0666666666666667
</td>
<td style="text-align:left;">
0.448275862068966
</td>
</tr>
<tr>
<td style="text-align:left;">
modLogist02-LOOCV
</td>
<td style="text-align:left;">
glm
</td>
<td style="text-align:left;">
0.826923076923077
</td>
<td style="text-align:left;">
0.933333333333333
</td>
<td style="text-align:left;">
0.551724137931034
</td>
</tr>
<tr>
<td style="text-align:left;">
modFisher01-prior 0.5 / 0.5
</td>
<td style="text-align:left;">
lda
</td>
<td style="text-align:left;">
0.865384615384615
</td>
<td style="text-align:left;">
0.893333333333333
</td>
<td style="text-align:left;">
0.793103448275862
</td>
</tr>
<tr>
<td style="text-align:left;">
modBayes01-prior 0.65 / 0.35
</td>
<td style="text-align:left;">
lda
</td>
<td style="text-align:left;">
0.836538461538462
</td>
<td style="text-align:left;">
0.933333333333333
</td>
<td style="text-align:left;">
0.586206896551724
</td>
</tr>
<tr>
<td style="text-align:left;">
modNaiveBayes01
</td>
<td style="text-align:left;">
naiveBayes
</td>
<td style="text-align:left;">
0.826923076923077
</td>
<td style="text-align:left;">
0.933333333333333
</td>
<td style="text-align:left;">
0.551724137931034
</td>
</tr>
<tr>
<td style="text-align:left;">
modArvDec01
</td>
<td style="text-align:left;">
rpart
</td>
<td style="text-align:left;">
0.865384615384615
</td>
<td style="text-align:left;">
0.893333333333333
</td>
<td style="text-align:left;">
0.793103448275862
</td>
</tr>
<tr>
<td style="text-align:left;">
modSVM01
</td>
<td style="text-align:left;">
svm
</td>
<td style="text-align:left;">
0.836538461538462
</td>
<td style="text-align:left;">
0.946666666666667
</td>
<td style="text-align:left;">
0.551724137931034
</td>
</tr>
<tr>
<td style="text-align:left;">
modRedNeural01
</td>
<td style="text-align:left;">
neuralnet
</td>
<td style="text-align:left;">
0.836538461538462
</td>
<td style="text-align:left;">
0.853658536585366
</td>
<td style="text-align:left;">
0.772727272727273
</td>
</tr>
<tr>
<td style="text-align:left;">
modKnn1_01-k=1
</td>
<td style="text-align:left;">
knn3
</td>
<td style="text-align:left;">
0.865384615384615
</td>
<td style="text-align:left;">
0.96
</td>
<td style="text-align:left;">
0.620689655172414
</td>
</tr>
<tr>
<td style="text-align:left;">
modKnn3_01-k=3
</td>
<td style="text-align:left;">
knn3
</td>
<td style="text-align:left;">
0.865384615384615
</td>
<td style="text-align:left;">
0.933333333333333
</td>
<td style="text-align:left;">
0.689655172413793
</td>
</tr>
<tr>
<td style="text-align:left;">
modKnn5_01-k=5
</td>
<td style="text-align:left;">
knn3
</td>
<td style="text-align:left;">
0.884615384615385
</td>
<td style="text-align:left;">
0.96
</td>
<td style="text-align:left;">
0.689655172413793
</td>
</tr>
</tbody>
</table>
<p>Todos os modelos tiveram performance semelhante, com destaque para modFisher01 com <span class="math inline">\(prior 0.5, 0.5\)</span>.</p>
</div>
<div id="agrupamento-2" class="section level3 hasAnchor" number="3.3.11">
<h3><span class="header-section-number">3.3.11</span> Agrupamento<a href="classification.html#agrupamento-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="classification.html#cb234-1" aria-hidden="true" tabindex="-1"></a>discoS <span class="ot">=</span> disco[, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb234-2"><a href="classification.html#cb234-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-3"><a href="classification.html#cb234-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(discoS, <span class="at">method =</span> <span class="st">&quot;maximum&quot;</span>)</span>
<span id="cb234-4"><a href="classification.html#cb234-4" aria-hidden="true" tabindex="-1"></a>grup <span class="ot">=</span> <span class="fu">hclust</span>(d, <span class="at">method =</span> <span class="st">&quot;ward.D&quot;</span>)</span>
<span id="cb234-5"><a href="classification.html#cb234-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grup, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="classification.html#cb235-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">cutree</span>(grup, <span class="at">k=</span><span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="classification.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(groups, disco<span class="sc">$</span>deslocamento)</span></code></pre></div>
<pre><code>##       
## groups  0  1
##      1 10 21
##      2 58  5
##      3  7  3</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="classification.html#cb238-1" aria-hidden="true" tabindex="-1"></a>km1 <span class="ot">=</span> <span class="fu">kmeans</span>(discoS, <span class="dv">4</span>)</span>
<span id="cb238-2"><a href="classification.html#cb238-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">fviz_cluster</span>(km1, <span class="at">data=</span>discoS,</span>
<span id="cb238-3"><a href="classification.html#cb238-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#2E9FDF&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#E7B700&quot;</span>),</span>
<span id="cb238-4"><a href="classification.html#cb238-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">star.plot=</span><span class="cn">FALSE</span>,</span>
<span id="cb238-5"><a href="classification.html#cb238-5" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># repel=TRUE,</span></span>
<span id="cb238-6"><a href="classification.html#cb238-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme=</span><span class="fu">theme_bw</span>())</span>
<span id="cb238-7"><a href="classification.html#cb238-7" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-105-1.png" width="672" /></p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="classification.html#cb239-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">=</span> km1<span class="sc">$</span>cluster</span>
<span id="cb239-2"><a href="classification.html#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(groups, disco<span class="sc">$</span>deslocamento)</span></code></pre></div>
<pre><code>##       
## groups  0  1
##      1  0  8
##      2  7  8
##      3 54  3
##      4 14 10</code></pre>
</div>
</div>
<div id="classificação-de-tipos-faciais" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Classificação de tipos faciais<a href="classification.html#classificação-de-tipos-faciais" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Os dados do arquivo tipofacial (disponível <a href="http://www.ime.usp.br/~jmsinger/MorettinSinger/tipofacial.xls">aqui</a>) foram extraídos de um estudo odontológico realizado pelo Dr. Flávio Cotrim Vellini. Um dos objetivos era utilizar medidas entre diferentes pontos do crânio para caracterizar indivíduos com diferentes tipos faciais, a saber, braquicéfalos, mesocéfalos e dolicocéfalos (grupos). O conjunto de dados contém observações de 11 variáveis em 101 pacientes. Para efeitos didáticos, considere apenas a altura facial (altfac) e a profundidade facial (proffac) como variáveis preditoras.</p>
<div id="pacotes-8" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Pacotes<a href="classification.html#pacotes-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pacotes necessários para estes exercícios:</p>
</div>
<div id="conjunto-de-dados-10" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Conjunto de dados<a href="classification.html#conjunto-de-dados-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="classification.html#cb241-1" aria-hidden="true" tabindex="-1"></a>httr<span class="sc">::</span><span class="fu">GET</span>(<span class="st">&quot;http://www.ime.usp.br/~jmsinger/MorettinSinger/tipofacial.xls&quot;</span>, httr<span class="sc">::</span><span class="fu">write_disk</span>(<span class="st">&quot;../dados/tipofacial.xls&quot;</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## Response [https://www.ime.usp.br/~jmsinger/MorettinSinger/tipofacial.xls]
##   Date: 2022-11-15 23:40
##   Status: 200
##   Content-Type: application/vnd.ms-excel
##   Size: 20.5 kB
## &lt;ON DISK&gt;  G:\onedrive\obsidian\adsantos\Mestrado\BD\trabalhos\caderno-bd\dados\tipofacial.xls</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="classification.html#cb243-1" aria-hidden="true" tabindex="-1"></a>tipofacial <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;../dados/tipofacial.xls&quot;</span>)</span>
<span id="cb243-2"><a href="classification.html#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tipofacial)</span></code></pre></div>
<pre><code>## tibble [101 × 13] (S3: tbl_df/tbl/data.frame)
##  $ paciente: num [1:101] 10 10 27 39 39 39 55 76 77 133 ...
##  $ sexo    : chr [1:101] &quot;M&quot; &quot;M&quot; &quot;F&quot; &quot;F&quot; ...
##  $ grupo   : chr [1:101] &quot;braq&quot; &quot;braq&quot; &quot;braq&quot; &quot;braq&quot; ...
##  $ idade   : num [1:101] 5.58 11.42 16.17 4.92 10.92 ...
##  $ nsba    : num [1:101] 132 134 122 130 130 ...
##  $ ns      : num [1:101] 58 63 77.5 64 70 68.5 71 72 70 80 ...
##  $ sba     : num [1:101] 36 42.5 48 34.5 36.5 41.5 42 46.5 44 52 ...
##  $ altfac  : num [1:101] 1.2 1.2 2.6 3.1 3.1 3.3 2.4 1.9 2.1 2.8 ...
##  $ proffac : num [1:101] 0.8 0.4 0.2 -1 0.6 -0.6 0.3 0.5 -0.1 0.2 ...
##  $ eixofac : num [1:101] 0.4 1 0.3 1.9 1.2 1.1 1.1 1.4 2.2 0.4 ...
##  $ planmand: num [1:101] 0.4 1 0.9 1.3 2.2 1.2 1.2 0.6 0.8 1.1 ...
##  $ arcomand: num [1:101] 2.5 3.6 3.4 1.6 2.3 2.1 3.5 3.5 0.7 1.8 ...
##  $ vert    : num [1:101] 1.06 1.44 1.48 1.38 1.88 1.42 1.7 1.58 1.14 1.26 ...</code></pre>
<p>Número de observações 101.</p>
<div id="categorizando-a-variável-de-grupo." class="section level4 hasAnchor" number="3.4.2.1">
<h4><span class="header-section-number">3.4.2.1</span> Categorizando a variável de grupo.<a href="classification.html#categorizando-a-variável-de-grupo." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="classification.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Considerar (altfac) e a profundidade facial (proffac) como variáveis preditoras.</span></span>
<span id="cb245-2"><a href="classification.html#cb245-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-3"><a href="classification.html#cb245-3" aria-hidden="true" tabindex="-1"></a>tipofacial<span class="sc">$</span>sumfac <span class="ot">=</span> tipofacial<span class="sc">$</span>altfac <span class="sc">+</span> tipofacial<span class="sc">$</span>proffac</span>
<span id="cb245-4"><a href="classification.html#cb245-4" aria-hidden="true" tabindex="-1"></a>tipofacial<span class="sc">$</span>grupo <span class="ot">=</span> <span class="fu">as.factor</span>(tipofacial<span class="sc">$</span>grupo)</span></code></pre></div>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="classification.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tipofacial<span class="sc">$</span>sumfac  <span class="sc">~</span> tipofacial<span class="sc">$</span>grupo)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="classification.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tipofacial, <span class="at">n =</span> <span class="dv">32</span>)</span></code></pre></div>
<pre><code>## # A tibble: 101 × 14
##    pacie…¹ sexo  grupo idade  nsba    ns   sba altfac proffac eixofac planm…² arcom…³
##      &lt;dbl&gt; &lt;chr&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1      10 M     braq   5.58  132   58    36      1.2     0.8     0.4     0.4     2.5
##  2      10 M     braq  11.4   134   63    42.5    1.2     0.4     1       1       3.6
##  3      27 F     braq  16.2   122.  77.5  48      2.6     0.2     0.3     0.9     3.4
##  4      39 F     braq   4.92  130.  64    34.5    3.1    -1       1.9     1.3     1.6
##  5      39 F     braq  10.9   130.  70    36.5    3.1     0.6     1.2     2.2     2.3
##  6      39 F     braq  12.9   128   68.5  41.5    3.3    -0.6     1.1     1.2     2.1
##  7      55 F     braq  16.8   130   71    42      2.4     0.3     1.1     1.2     3.5
##  8      76 F     braq  16     125   72    46.5    1.9     0.5     1.4     0.6     3.5
##  9      77 F     braq  17.1   130.  70    44      2.1    -0.1     2.2     0.8     0.7
## 10     133 M     braq  14.8   130   80    52      2.8     0.2     0.4     1.1     1.8
## 11     145 F     braq  10.7   118.  67    43.5    1.2     0.7     1.7     1.5     0.9
## 12     148 F     braq  11.3   129   68    41.5    2.9    -0.7     2.2     1.3     2.2
## 13     165 F     braq  15     137   74    43      2.1    -0.3     1.3     1.2     2.5
## 14     176 M     braq   5.67  134   65    39      2.5     0.2     2.1     2.2     3.1
## 15     176 M     braq  13     130   72    48      2.2     0.2     2.9     2.4     4  
## 16     208 M     braq  13.8   130   67.5  43      0.9     1.5    -0.4     1.2     2.3
## 17     246 F     braq  11.8   129   67    43      0.8     1.1     1.5     0.3     1.4
## 18      27 F     braq   4.67  126   63    35      1.9     0.2     0.3     0.1     1.6
## 19      39 F     braq   3.67  131   61    32      3      -1.4     1.8     0.7     0.8
## 20      45 M     braq  22.7   133   77    46      1.7    -0.9    -0.6     0.3     2.7
## 21      49 F     braq  16.6   136.  71    42      1       0.5     0.1     0.2     2.7
## 22      52 M     braq  12.6   126.  69    41.5    1.4     0       0.4     0.5     2.5
## 23      63 F     braq   6.17  130.  63    37      1.9    -0.5     0.8     0.5     1.3
## 24      63 F     braq  15.7   132   72.5  43      1.9     0       2       0.4     0.3
## 25      68 M     braq  13.8   128   72    43      1.2    -0.6     1       1.1     2.3
## 26      76 F     braq   5.33  124   61    39.5    1.3    -0.3    -0.1     0.6     1.6
## 27      86 F     braq   5.25  126.  61.5  42.5    1.1     0      -0.1     0.2     2.7
## 28     109 M     braq  14.9   131   78.5  50      1.8    -0.4     1.1     0.8     1.3
## 29     145 F     braq   3.67  129   60    37.5    1       0       1.1     0.1     0.4
## 30     148 F     braq   4.25  127   61.5  34      1.9     0.2     1.6     0       1.4
## 31     155 F     braq   5.25  127   65    39.5    1.2    -0.5     1.2     0.2     1.4
## 32     155 F     braq  11.3   128   71.5  45      2.3    -0.3     0.7     0.4     2.2
## # … with 69 more rows, 2 more variables: vert &lt;dbl&gt;, sumfac &lt;dbl&gt;, and abbreviated
## #   variable names ¹​paciente, ²​planmand, ³​arcomand</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="classification.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tipofacial)</span></code></pre></div>
<pre><code>##     paciente         sexo              grupo        idade             nsba      
##  Min.   : 10.0   Length:101         braq  :33   Min.   : 3.670   Min.   :117.0  
##  1st Qu.: 61.0   Class :character   dolico:31   1st Qu.: 5.250   1st Qu.:125.0  
##  Median :105.0   Mode  :character   meso  :37   Median :10.000   Median :128.0  
##  Mean   :108.4                                  Mean   : 9.204   Mean   :127.7  
##  3rd Qu.:148.0                                  3rd Qu.:12.580   3rd Qu.:130.0  
##  Max.   :246.0                                  Max.   :22.670   Max.   :137.0  
##        ns             sba           altfac           proffac       
##  Min.   :57.00   Min.   :32.0   Min.   :-2.3000   Min.   :-2.7000  
##  1st Qu.:63.00   1st Qu.:38.5   1st Qu.:-0.3000   1st Qu.:-1.2000  
##  Median :66.50   Median :41.5   Median : 0.6000   Median :-0.7000  
##  Mean   :67.03   Mean   :41.5   Mean   : 0.6238   Mean   :-0.6119  
##  3rd Qu.:71.00   3rd Qu.:44.0   3rd Qu.: 1.7000   3rd Qu.: 0.0000  
##  Max.   :81.00   Max.   :54.0   Max.   : 3.3000   Max.   : 1.5000  
##     eixofac           planmand          arcomand            vert         
##  Min.   :-3.5000   Min.   :-2.9000   Min.   :-2.3000   Min.   :-1.92000  
##  1st Qu.:-1.0000   1st Qu.:-1.3000   1st Qu.: 0.0000   1st Qu.:-0.68000  
##  Median :-0.2000   Median :-0.5000   Median : 0.8000   Median : 0.00000  
##  Mean   :-0.1129   Mean   :-0.4693   Mean   : 0.8386   Mean   : 0.04931  
##  3rd Qu.: 0.8000   3rd Qu.: 0.4000   3rd Qu.: 1.6000   3rd Qu.: 0.80000  
##  Max.   : 2.9000   Max.   : 2.4000   Max.   : 4.0000   Max.   : 2.34000  
##      sumfac        
##  Min.   :-4.00000  
##  1st Qu.:-0.90000  
##  Median :-0.10000  
##  Mean   : 0.01188  
##  3rd Qu.: 1.40000  
##  Max.   : 3.70000</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="classification.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(tipofacial<span class="sc">$</span>sumfac)</span></code></pre></div>
<pre><code>## [1] 1.750331</code></pre>
<p>Criando um dataframe para comparar as métricas dos modelos.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="classification.html#cb253-1" aria-hidden="true" tabindex="-1"></a>model_eval <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">9</span>, <span class="at">nrow =</span> <span class="dv">0</span>))</span>
<span id="cb253-2"><a href="classification.html#cb253-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-3"><a href="classification.html#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(model_eval) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Model&#39;</span>, <span class="st">&#39;Algorithm&#39;</span>, <span class="st">&#39;Accuracy&#39;</span>, <span class="st">&#39;Sensitivity_C1&#39;</span>, <span class="st">&#39;Sensitivity_C2&#39;</span>, <span class="st">&#39;Sensitivity_C3&#39;</span>, <span class="st">&#39;Specificity_C1&#39;</span>, <span class="st">&#39;Specificity_C2&#39;</span>, <span class="st">&#39;Specificity_C3&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="generalized-linear-models-2" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Generalized Linear Models<a href="classification.html#generalized-linear-models-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="classification.html#cb254-1" aria-hidden="true" tabindex="-1"></a>glm.fit <span class="ot">=</span> <span class="fu">multinom</span>(grupo <span class="sc">~</span> sumfac, <span class="at">data=</span>tipofacial)</span></code></pre></div>
<pre><code>## # weights:  9 (4 variable)
## initial  value 110.959841 
## iter  10 value 38.508219
## final  value 38.456349 
## converged</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="classification.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.fit)</span></code></pre></div>
<pre><code>## Call:
## multinom(formula = grupo ~ sumfac, data = tipofacial)
## 
## Coefficients:
##        (Intercept)    sumfac
## dolico    1.532730 -6.173138
## meso      3.781329 -3.762457
## 
## Std. Errors:
##        (Intercept)   sumfac
## dolico    1.238970 1.174600
## meso      1.107069 1.005516
## 
## Residual Deviance: 76.9127 
## AIC: 84.9127</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="classification.html#cb258-1" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(glm.fit, <span class="at">newdata =</span> tipofacial)</span>
<span id="cb258-2"><a href="classification.html#cb258-2" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, tipofacial<span class="sc">$</span>grupo)</span>
<span id="cb258-3"><a href="classification.html#cb258-3" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction braq dolico meso
##     braq     27      0    4
##     dolico    0     23    2
##     meso      6      8   31
## 
## Overall Statistics
##                                           
##                Accuracy : 0.802           
##                  95% CI : (0.7109, 0.8746)
##     No Information Rate : 0.3663          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.7002          
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: braq Class: dolico Class: meso
## Sensitivity               0.8182        0.7419      0.8378
## Specificity               0.9412        0.9714      0.7812
## Pos Pred Value            0.8710        0.9200      0.6889
## Neg Pred Value            0.9143        0.8947      0.8929
## Prevalence                0.3267        0.3069      0.3663
## Detection Rate            0.2673        0.2277      0.3069
## Detection Prevalence      0.3069        0.2475      0.4455
## Balanced Accuracy         0.8797        0.8567      0.8095</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="classification.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb260-2"><a href="classification.html#cb260-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;glm.fit&quot;</span>, <span class="st">&quot;glm&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[,<span class="dv">1</span>], cm<span class="sc">$</span>byClass[,<span class="dv">2</span>])</span></code></pre></div>
<p>Seprando dados de treinamento (70%) e testes (30%).</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="classification.html#cb261-1" aria-hidden="true" tabindex="-1"></a>alpha<span class="ot">=</span><span class="fl">0.7</span></span>
<span id="cb261-2"><a href="classification.html#cb261-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">sort</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(tipofacial), <span class="fu">nrow</span>(tipofacial)<span class="sc">*</span>alpha))</span>
<span id="cb261-3"><a href="classification.html#cb261-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">=</span> tipofacial[d,]</span>
<span id="cb261-4"><a href="classification.html#cb261-4" aria-hidden="true" tabindex="-1"></a>test <span class="ot">=</span> tipofacial[<span class="sc">-</span>d,]</span>
<span id="cb261-5"><a href="classification.html#cb261-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-6"><a href="classification.html#cb261-6" aria-hidden="true" tabindex="-1"></a>glm.fit <span class="ot">=</span> <span class="fu">multinom</span>(grupo <span class="sc">~</span> sumfac, <span class="at">data=</span>train)</span></code></pre></div>
<pre><code>## # weights:  9 (4 variable)
## initial  value 76.902860 
## iter  10 value 22.374781
## final  value 22.241040 
## converged</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="classification.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.fit)</span></code></pre></div>
<pre><code>## Call:
## multinom(formula = grupo ~ sumfac, data = train)
## 
## Coefficients:
##        (Intercept)    sumfac
## dolico    3.014243 -7.473771
## meso      5.434374 -4.808327
## 
## Std. Errors:
##        (Intercept)   sumfac
## dolico    2.183394 1.929194
## meso      2.055686 1.743646
## 
## Residual Deviance: 44.48208 
## AIC: 52.48208</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="classification.html#cb265-1" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(glm.fit, <span class="at">newdata =</span> test)</span>
<span id="cb265-2"><a href="classification.html#cb265-2" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, test<span class="sc">$</span>grupo)</span>
<span id="cb265-3"><a href="classification.html#cb265-3" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction braq dolico meso
##     braq      7      0    2
##     dolico    0      6    1
##     meso      5      2    8
## 
## Overall Statistics
##                                           
##                Accuracy : 0.6774          
##                  95% CI : (0.4863, 0.8332)
##     No Information Rate : 0.3871          
##     P-Value [Acc &gt; NIR] : 0.001009        
##                                           
##                   Kappa : 0.5095          
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: braq Class: dolico Class: meso
## Sensitivity               0.5833        0.7500      0.7273
## Specificity               0.8947        0.9565      0.6500
## Pos Pred Value            0.7778        0.8571      0.5333
## Neg Pred Value            0.7727        0.9167      0.8125
## Prevalence                0.3871        0.2581      0.3548
## Detection Rate            0.2258        0.1935      0.2581
## Detection Prevalence      0.2903        0.2258      0.4839
## Balanced Accuracy         0.7390        0.8533      0.6886</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="classification.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb267-2"><a href="classification.html#cb267-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;glm.fit-split&quot;</span>, <span class="st">&quot;glm&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[,<span class="dv">1</span>], cm<span class="sc">$</span>byClass[,<span class="dv">2</span>])</span></code></pre></div>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="classification.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(model_eval) <span class="sc">%&gt;%</span></span>
<span id="cb268-2"><a href="classification.html#cb268-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;striped&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
Algorithm
</th>
<th style="text-align:left;">
Accuracy
</th>
<th style="text-align:left;">
Sensitivity_C1
</th>
<th style="text-align:left;">
Sensitivity_C2
</th>
<th style="text-align:left;">
Sensitivity_C3
</th>
<th style="text-align:left;">
Specificity_C1
</th>
<th style="text-align:left;">
Specificity_C2
</th>
<th style="text-align:left;">
Specificity_C3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
glm.fit
</td>
<td style="text-align:left;">
glm
</td>
<td style="text-align:left;">
0.801980198019802
</td>
<td style="text-align:left;">
0.818181818181818
</td>
<td style="text-align:left;">
0.741935483870968
</td>
<td style="text-align:left;">
0.837837837837838
</td>
<td style="text-align:left;">
0.941176470588235
</td>
<td style="text-align:left;">
0.971428571428571
</td>
<td style="text-align:left;">
0.78125
</td>
</tr>
<tr>
<td style="text-align:left;">
glm.fit-split
</td>
<td style="text-align:left;">
glm
</td>
<td style="text-align:left;">
0.67741935483871
</td>
<td style="text-align:left;">
0.583333333333333
</td>
<td style="text-align:left;">
0.75
</td>
<td style="text-align:left;">
0.727272727272727
</td>
<td style="text-align:left;">
0.894736842105263
</td>
<td style="text-align:left;">
0.956521739130435
</td>
<td style="text-align:left;">
0.65
</td>
</tr>
</tbody>
</table>
<p>Treinar o modelo com um conjunto de dados diferente do de teste mostrou que o modelo tem uma capcidade razoável de generalização.</p>
</div>
<div id="linear-discriminant-analysis---fisher-2" class="section level3 hasAnchor" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> Linear Discriminant Analysis - Fisher<a href="classification.html#linear-discriminant-analysis---fisher-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="classification.html#cb269-1" aria-hidden="true" tabindex="-1"></a>modFisher01 <span class="ot">=</span> <span class="fu">lda</span>(grupo <span class="sc">~</span> sumfac, <span class="at">data =</span> tipofacial)</span>
<span id="cb269-2"><a href="classification.html#cb269-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modFisher01)</span>
<span id="cb269-3"><a href="classification.html#cb269-3" aria-hidden="true" tabindex="-1"></a>classPred <span class="ot">=</span> predito<span class="sc">$</span>class</span>
<span id="cb269-4"><a href="classification.html#cb269-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(classPred, tipofacial<span class="sc">$</span>grupo)</span>
<span id="cb269-5"><a href="classification.html#cb269-5" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction braq dolico meso
##     braq     29      0    5
##     dolico    0     23    2
##     meso      4      8   30
## 
## Overall Statistics
##                                           
##                Accuracy : 0.8119          
##                  95% CI : (0.7219, 0.8828)
##     No Information Rate : 0.3663          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.7157          
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: braq Class: dolico Class: meso
## Sensitivity               0.8788        0.7419      0.8108
## Specificity               0.9265        0.9714      0.8125
## Pos Pred Value            0.8529        0.9200      0.7143
## Neg Pred Value            0.9403        0.8947      0.8814
## Prevalence                0.3267        0.3069      0.3663
## Detection Rate            0.2871        0.2277      0.2970
## Detection Prevalence      0.3366        0.2475      0.4158
## Balanced Accuracy         0.9026        0.8567      0.8117</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="classification.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb271-2"><a href="classification.html#cb271-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modFisher01&quot;</span>, <span class="st">&quot;lda&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[,<span class="dv">1</span>], cm<span class="sc">$</span>byClass[,<span class="dv">2</span>])</span></code></pre></div>
</div>
<div id="bayes-2" class="section level3 hasAnchor" number="3.4.5">
<h3><span class="header-section-number">3.4.5</span> Bayes<a href="classification.html#bayes-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="classification.html#cb272-1" aria-hidden="true" tabindex="-1"></a>modBayes01 <span class="ot">=</span> <span class="fu">lda</span>(grupo <span class="sc">~</span> sumfac, <span class="at">data =</span> tipofacial, <span class="at">prior =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.25</span>))</span>
<span id="cb272-2"><a href="classification.html#cb272-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modBayes01)</span>
<span id="cb272-3"><a href="classification.html#cb272-3" aria-hidden="true" tabindex="-1"></a>classPred <span class="ot">=</span> predito<span class="sc">$</span>class</span>
<span id="cb272-4"><a href="classification.html#cb272-4" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(classPred, tipofacial<span class="sc">$</span>grupo)</span>
<span id="cb272-5"><a href="classification.html#cb272-5" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction braq dolico meso
##     braq     29      0    5
##     dolico    0     24    6
##     meso      4      7   26
## 
## Overall Statistics
##                                          
##                Accuracy : 0.7822         
##                  95% CI : (0.689, 0.8582)
##     No Information Rate : 0.3663         
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
##                                          
##                   Kappa : 0.6723         
##                                          
##  Mcnemar&#39;s Test P-Value : NA             
## 
## Statistics by Class:
## 
##                      Class: braq Class: dolico Class: meso
## Sensitivity               0.8788        0.7742      0.7027
## Specificity               0.9265        0.9143      0.8281
## Pos Pred Value            0.8529        0.8000      0.7027
## Neg Pred Value            0.9403        0.9014      0.8281
## Prevalence                0.3267        0.3069      0.3663
## Detection Rate            0.2871        0.2376      0.2574
## Detection Prevalence      0.3366        0.2970      0.3663
## Balanced Accuracy         0.9026        0.8442      0.7654</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="classification.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb274-2"><a href="classification.html#cb274-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modBayes01-prior 0.25 / 0.50 / 0.25&quot;</span>, <span class="st">&quot;lda&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[,<span class="dv">1</span>], cm<span class="sc">$</span>byClass[,<span class="dv">2</span>])</span></code></pre></div>
<p>Naive Bayes</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="classification.html#cb275-1" aria-hidden="true" tabindex="-1"></a>modNaiveBayes01 <span class="ot">=</span> <span class="fu">naiveBayes</span>(grupo <span class="sc">~</span> sumfac, <span class="at">data =</span> tipofacial)</span>
<span id="cb275-2"><a href="classification.html#cb275-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modNaiveBayes01, tipofacial)</span>
<span id="cb275-3"><a href="classification.html#cb275-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, tipofacial<span class="sc">$</span>grupo)</span>
<span id="cb275-4"><a href="classification.html#cb275-4" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction braq dolico meso
##     braq     29      0    5
##     dolico    0     23    2
##     meso      4      8   30
## 
## Overall Statistics
##                                           
##                Accuracy : 0.8119          
##                  95% CI : (0.7219, 0.8828)
##     No Information Rate : 0.3663          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.7157          
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: braq Class: dolico Class: meso
## Sensitivity               0.8788        0.7419      0.8108
## Specificity               0.9265        0.9714      0.8125
## Pos Pred Value            0.8529        0.9200      0.7143
## Neg Pred Value            0.9403        0.8947      0.8814
## Prevalence                0.3267        0.3069      0.3663
## Detection Rate            0.2871        0.2277      0.2970
## Detection Prevalence      0.3366        0.2475      0.4158
## Balanced Accuracy         0.9026        0.8567      0.8117</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="classification.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb277-2"><a href="classification.html#cb277-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modNaiveBayes01&quot;</span>, <span class="st">&quot;naiveBayes&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[,<span class="dv">1</span>], cm<span class="sc">$</span>byClass[,<span class="dv">2</span>])</span></code></pre></div>
</div>
<div id="decison-tree-2" class="section level3 hasAnchor" number="3.4.6">
<h3><span class="header-section-number">3.4.6</span> Decison tree<a href="classification.html#decison-tree-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="classification.html#cb278-1" aria-hidden="true" tabindex="-1"></a>modArvDec01 <span class="ot">=</span> <span class="fu">rpart</span>(grupo <span class="sc">~</span> sumfac, <span class="at">data =</span> tipofacial) </span>
<span id="cb278-2"><a href="classification.html#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prp</span>(modArvDec01,  <span class="at">faclen=</span><span class="dv">0</span>, <span class="co">#use full names for factor labels</span></span>
<span id="cb278-3"><a href="classification.html#cb278-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">extra=</span><span class="dv">1</span>, <span class="co">#display number of observations for each terminal node</span></span>
<span id="cb278-4"><a href="classification.html#cb278-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">roundint=</span>F, <span class="co">#don&#39;t round to integers in output</span></span>
<span id="cb278-5"><a href="classification.html#cb278-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">digits=</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="classification.html#cb279-1" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modArvDec01, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb279-2"><a href="classification.html#cb279-2" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, tipofacial<span class="sc">$</span>grupo)</span>
<span id="cb279-3"><a href="classification.html#cb279-3" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction braq dolico meso
##     braq     26      0    0
##     dolico    0     23    2
##     meso      7      8   35
## 
## Overall Statistics
##                                           
##                Accuracy : 0.8317          
##                  95% CI : (0.7442, 0.8988)
##     No Information Rate : 0.3663          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.7444          
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: braq Class: dolico Class: meso
## Sensitivity               0.7879        0.7419      0.9459
## Specificity               1.0000        0.9714      0.7656
## Pos Pred Value            1.0000        0.9200      0.7000
## Neg Pred Value            0.9067        0.8947      0.9608
## Prevalence                0.3267        0.3069      0.3663
## Detection Rate            0.2574        0.2277      0.3465
## Detection Prevalence      0.2574        0.2475      0.4950
## Balanced Accuracy         0.8939        0.8567      0.8558</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="classification.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb281-2"><a href="classification.html#cb281-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modArvDec01&quot;</span>, <span class="st">&quot;rpart&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[,<span class="dv">1</span>], cm<span class="sc">$</span>byClass[,<span class="dv">2</span>])</span></code></pre></div>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="classification.html#cb282-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(tipofacial)</span>
<span id="cb282-2"><a href="classification.html#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tipofacial<span class="sc">$</span>sumfac <span class="sc">~</span> x, <span class="at">col =</span> tipofacial<span class="sc">$</span>grupo)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
</div>
<div id="svm-2" class="section level3 hasAnchor" number="3.4.7">
<h3><span class="header-section-number">3.4.7</span> SVM<a href="classification.html#svm-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="classification.html#cb283-1" aria-hidden="true" tabindex="-1"></a>modSVM01 <span class="ot">=</span> <span class="fu">svm</span>(grupo <span class="sc">~</span> sumfac, <span class="at">data =</span> tipofacial, <span class="at">kernel =</span> <span class="st">&quot;linear&quot;</span>)</span>
<span id="cb283-2"><a href="classification.html#cb283-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modSVM01, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb283-3"><a href="classification.html#cb283-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, tipofacial<span class="sc">$</span>grupo)</span>
<span id="cb283-4"><a href="classification.html#cb283-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-5"><a href="classification.html#cb283-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb283-6"><a href="classification.html#cb283-6" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modSVM01&quot;</span>, <span class="st">&quot;svm&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[,<span class="dv">1</span>], cm<span class="sc">$</span>byClass[,<span class="dv">2</span>])</span></code></pre></div>
</div>
<div id="neuralnet-2" class="section level3 hasAnchor" number="3.4.8">
<h3><span class="header-section-number">3.4.8</span> neuralnet<a href="classification.html#neuralnet-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="classification.html#cb284-1" aria-hidden="true" tabindex="-1"></a>modRedNeural01 <span class="ot">=</span> <span class="fu">neuralnet</span>(grupo <span class="sc">~</span> sumfac, <span class="at">data =</span> tipofacial, <span class="at">hidden =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">3</span>))</span>
<span id="cb284-2"><a href="classification.html#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modRedNeural01)</span>
<span id="cb284-3"><a href="classification.html#cb284-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-4"><a href="classification.html#cb284-4" aria-hidden="true" tabindex="-1"></a>ypred <span class="ot">=</span> neuralnet<span class="sc">::</span><span class="fu">compute</span>(modRedNeural01, tipofacial)</span>
<span id="cb284-5"><a href="classification.html#cb284-5" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">=</span> ypred<span class="sc">$</span>net.result</span>
<span id="cb284-6"><a href="classification.html#cb284-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-7"><a href="classification.html#cb284-7" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">=</span> <span class="fu">round</span>(yhat)</span>
<span id="cb284-8"><a href="classification.html#cb284-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-9"><a href="classification.html#cb284-9" aria-hidden="true" tabindex="-1"></a>yhat<span class="ot">=</span><span class="fu">data.frame</span>(<span class="st">&quot;yhat&quot;</span><span class="ot">=</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(yhat[ ,<span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;braq&quot;</span>, </span>
<span id="cb284-10"><a href="classification.html#cb284-10" aria-hidden="true" tabindex="-1"></a>                                         yhat[ ,<span class="dv">2</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;dolico&quot;</span>,</span>
<span id="cb284-11"><a href="classification.html#cb284-11" aria-hidden="true" tabindex="-1"></a>                                         <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;meso&quot;</span>))</span>
<span id="cb284-12"><a href="classification.html#cb284-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-13"><a href="classification.html#cb284-13" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(tipofacial<span class="sc">$</span>grupo, <span class="fu">as.factor</span>(yhat<span class="sc">$</span>yhat))</span>
<span id="cb284-14"><a href="classification.html#cb284-14" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction braq dolico meso
##     braq     30      0    3
##     dolico    0     23    8
##     meso      3      2   32
## 
## Overall Statistics
##                                           
##                Accuracy : 0.8416          
##                  95% CI : (0.7555, 0.9067)
##     No Information Rate : 0.4257          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.7605          
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: braq Class: dolico Class: meso
## Sensitivity               0.9091        0.9200      0.7442
## Specificity               0.9559        0.8947      0.9138
## Pos Pred Value            0.9091        0.7419      0.8649
## Neg Pred Value            0.9559        0.9714      0.8281
## Prevalence                0.3267        0.2475      0.4257
## Detection Rate            0.2970        0.2277      0.3168
## Detection Prevalence      0.3267        0.3069      0.3663
## Balanced Accuracy         0.9325        0.9074      0.8290</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="classification.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb286-2"><a href="classification.html#cb286-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modRedNeural01&quot;</span>, <span class="st">&quot;neuralnet&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[,<span class="dv">1</span>], cm<span class="sc">$</span>byClass[,<span class="dv">2</span>])</span></code></pre></div>
</div>
<div id="knn-2" class="section level3 hasAnchor" number="3.4.9">
<h3><span class="header-section-number">3.4.9</span> KNN<a href="classification.html#knn-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="classification.html#cb287-1" aria-hidden="true" tabindex="-1"></a>modKnn1_01 <span class="ot">=</span> <span class="fu">knn3</span>(grupo <span class="sc">~</span> sumfac, <span class="at">data =</span> tipofacial, <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb287-2"><a href="classification.html#cb287-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modKnn1_01, tipofacial, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb287-3"><a href="classification.html#cb287-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, tipofacial<span class="sc">$</span>grupo)</span>
<span id="cb287-4"><a href="classification.html#cb287-4" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction braq dolico meso
##     braq     32      0    1
##     dolico    0     30    3
##     meso      1      1   33
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9406          
##                  95% CI : (0.8752, 0.9779)
##     No Information Rate : 0.3663          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.9108          
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: braq Class: dolico Class: meso
## Sensitivity               0.9697        0.9677      0.8919
## Specificity               0.9853        0.9571      0.9688
## Pos Pred Value            0.9697        0.9091      0.9429
## Neg Pred Value            0.9853        0.9853      0.9394
## Prevalence                0.3267        0.3069      0.3663
## Detection Rate            0.3168        0.2970      0.3267
## Detection Prevalence      0.3267        0.3267      0.3465
## Balanced Accuracy         0.9775        0.9624      0.9303</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="classification.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb289-2"><a href="classification.html#cb289-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modKnn1_01-k=1&quot;</span>, <span class="st">&quot;knn3&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[,<span class="dv">1</span>], cm<span class="sc">$</span>byClass[,<span class="dv">2</span>])</span></code></pre></div>
<p>k = 3</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="classification.html#cb290-1" aria-hidden="true" tabindex="-1"></a>modKnn3_01 <span class="ot">=</span> <span class="fu">knn3</span>(grupo <span class="sc">~</span> sumfac, <span class="at">data =</span> tipofacial, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb290-2"><a href="classification.html#cb290-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modKnn3_01, tipofacial, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb290-3"><a href="classification.html#cb290-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, tipofacial<span class="sc">$</span>grupo, <span class="at">positive =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb290-4"><a href="classification.html#cb290-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-5"><a href="classification.html#cb290-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb290-6"><a href="classification.html#cb290-6" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modKnn3_01-k=3&quot;</span>, <span class="st">&quot;knn3&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[,<span class="dv">1</span>], cm<span class="sc">$</span>byClass[,<span class="dv">2</span>])</span></code></pre></div>
<p>k = 5</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="classification.html#cb291-1" aria-hidden="true" tabindex="-1"></a>modKnn5_01 <span class="ot">=</span> <span class="fu">knn3</span>(grupo <span class="sc">~</span> sumfac, <span class="at">data =</span> tipofacial, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb291-2"><a href="classification.html#cb291-2" aria-hidden="true" tabindex="-1"></a>predito <span class="ot">=</span> <span class="fu">predict</span>(modKnn5_01, tipofacial, <span class="at">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb291-3"><a href="classification.html#cb291-3" aria-hidden="true" tabindex="-1"></a>cm <span class="ot">=</span> <span class="fu">confusionMatrix</span>(predito, tipofacial<span class="sc">$</span>grupo, <span class="at">positive =</span> <span class="st">&quot;0&quot;</span>)</span>
<span id="cb291-4"><a href="classification.html#cb291-4" aria-hidden="true" tabindex="-1"></a>cm</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction braq dolico meso
##     braq     28      0    1
##     dolico    0     27    4
##     meso      5      4   32
## 
## Overall Statistics
##                                           
##                Accuracy : 0.8614          
##                  95% CI : (0.7784, 0.9221)
##     No Information Rate : 0.3663          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.791           
##                                           
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: braq Class: dolico Class: meso
## Sensitivity               0.8485        0.8710      0.8649
## Specificity               0.9853        0.9429      0.8594
## Pos Pred Value            0.9655        0.8710      0.7805
## Neg Pred Value            0.9306        0.9429      0.9167
## Prevalence                0.3267        0.3069      0.3663
## Detection Rate            0.2772        0.2673      0.3168
## Detection Prevalence      0.2871        0.3069      0.4059
## Balanced Accuracy         0.9169        0.9069      0.8621</code></pre>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="classification.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adiciona as métricas no df</span></span>
<span id="cb293-2"><a href="classification.html#cb293-2" aria-hidden="true" tabindex="-1"></a>model_eval[<span class="fu">nrow</span>(model_eval) <span class="sc">+</span> <span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;modKnn3_01-k=5&quot;</span>, <span class="st">&quot;knn3&quot;</span>, cm<span class="sc">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], cm<span class="sc">$</span>byClass[,<span class="dv">1</span>], cm<span class="sc">$</span>byClass[,<span class="dv">2</span>])</span></code></pre></div>
</div>
<div id="avaliando-os-modelos-2" class="section level3 hasAnchor" number="3.4.10">
<h3><span class="header-section-number">3.4.10</span> Avaliando os modelos<a href="classification.html#avaliando-os-modelos-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Model
</th>
<th style="text-align:left;">
Algorithm
</th>
<th style="text-align:left;">
Accuracy
</th>
<th style="text-align:left;">
Sensitivity_C1
</th>
<th style="text-align:left;">
Sensitivity_C2
</th>
<th style="text-align:left;">
Sensitivity_C3
</th>
<th style="text-align:left;">
Specificity_C1
</th>
<th style="text-align:left;">
Specificity_C2
</th>
<th style="text-align:left;">
Specificity_C3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
glm.fit
</td>
<td style="text-align:left;">
glm
</td>
<td style="text-align:left;">
0.801980198019802
</td>
<td style="text-align:left;">
0.818181818181818
</td>
<td style="text-align:left;">
0.741935483870968
</td>
<td style="text-align:left;">
0.837837837837838
</td>
<td style="text-align:left;">
0.941176470588235
</td>
<td style="text-align:left;">
0.971428571428571
</td>
<td style="text-align:left;">
0.78125
</td>
</tr>
<tr>
<td style="text-align:left;">
glm.fit-split
</td>
<td style="text-align:left;">
glm
</td>
<td style="text-align:left;">
0.67741935483871
</td>
<td style="text-align:left;">
0.583333333333333
</td>
<td style="text-align:left;">
0.75
</td>
<td style="text-align:left;">
0.727272727272727
</td>
<td style="text-align:left;">
0.894736842105263
</td>
<td style="text-align:left;">
0.956521739130435
</td>
<td style="text-align:left;">
0.65
</td>
</tr>
<tr>
<td style="text-align:left;">
modFisher01
</td>
<td style="text-align:left;">
lda
</td>
<td style="text-align:left;">
0.811881188118812
</td>
<td style="text-align:left;">
0.878787878787879
</td>
<td style="text-align:left;">
0.741935483870968
</td>
<td style="text-align:left;">
0.810810810810811
</td>
<td style="text-align:left;">
0.926470588235294
</td>
<td style="text-align:left;">
0.971428571428571
</td>
<td style="text-align:left;">
0.8125
</td>
</tr>
<tr>
<td style="text-align:left;">
modBayes01-prior 0.25 / 0.50 / 0.25
</td>
<td style="text-align:left;">
lda
</td>
<td style="text-align:left;">
0.782178217821782
</td>
<td style="text-align:left;">
0.878787878787879
</td>
<td style="text-align:left;">
0.774193548387097
</td>
<td style="text-align:left;">
0.702702702702703
</td>
<td style="text-align:left;">
0.926470588235294
</td>
<td style="text-align:left;">
0.914285714285714
</td>
<td style="text-align:left;">
0.828125
</td>
</tr>
<tr>
<td style="text-align:left;">
modNaiveBayes01
</td>
<td style="text-align:left;">
naiveBayes
</td>
<td style="text-align:left;">
0.811881188118812
</td>
<td style="text-align:left;">
0.878787878787879
</td>
<td style="text-align:left;">
0.741935483870968
</td>
<td style="text-align:left;">
0.810810810810811
</td>
<td style="text-align:left;">
0.926470588235294
</td>
<td style="text-align:left;">
0.971428571428571
</td>
<td style="text-align:left;">
0.8125
</td>
</tr>
<tr>
<td style="text-align:left;">
modArvDec01
</td>
<td style="text-align:left;">
rpart
</td>
<td style="text-align:left;">
0.831683168316832
</td>
<td style="text-align:left;">
0.787878787878788
</td>
<td style="text-align:left;">
0.741935483870968
</td>
<td style="text-align:left;">
0.945945945945946
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0.971428571428571
</td>
<td style="text-align:left;">
0.765625
</td>
</tr>
<tr>
<td style="text-align:left;">
modSVM01
</td>
<td style="text-align:left;">
svm
</td>
<td style="text-align:left;">
0.801980198019802
</td>
<td style="text-align:left;">
0.818181818181818
</td>
<td style="text-align:left;">
0.741935483870968
</td>
<td style="text-align:left;">
0.837837837837838
</td>
<td style="text-align:left;">
0.941176470588235
</td>
<td style="text-align:left;">
0.971428571428571
</td>
<td style="text-align:left;">
0.78125
</td>
</tr>
<tr>
<td style="text-align:left;">
modRedNeural01
</td>
<td style="text-align:left;">
neuralnet
</td>
<td style="text-align:left;">
0.841584158415842
</td>
<td style="text-align:left;">
0.909090909090909
</td>
<td style="text-align:left;">
0.92
</td>
<td style="text-align:left;">
0.744186046511628
</td>
<td style="text-align:left;">
0.955882352941177
</td>
<td style="text-align:left;">
0.894736842105263
</td>
<td style="text-align:left;">
0.913793103448276
</td>
</tr>
<tr>
<td style="text-align:left;">
modKnn1_01-k=1
</td>
<td style="text-align:left;">
knn3
</td>
<td style="text-align:left;">
0.940594059405941
</td>
<td style="text-align:left;">
0.96969696969697
</td>
<td style="text-align:left;">
0.967741935483871
</td>
<td style="text-align:left;">
0.891891891891892
</td>
<td style="text-align:left;">
0.985294117647059
</td>
<td style="text-align:left;">
0.957142857142857
</td>
<td style="text-align:left;">
0.96875
</td>
</tr>
<tr>
<td style="text-align:left;">
modKnn3_01-k=3
</td>
<td style="text-align:left;">
knn3
</td>
<td style="text-align:left;">
0.861386138613861
</td>
<td style="text-align:left;">
0.909090909090909
</td>
<td style="text-align:left;">
0.838709677419355
</td>
<td style="text-align:left;">
0.837837837837838
</td>
<td style="text-align:left;">
0.955882352941177
</td>
<td style="text-align:left;">
0.957142857142857
</td>
<td style="text-align:left;">
0.875
</td>
</tr>
<tr>
<td style="text-align:left;">
modKnn3_01-k=5
</td>
<td style="text-align:left;">
knn3
</td>
<td style="text-align:left;">
0.861386138613861
</td>
<td style="text-align:left;">
0.848484848484849
</td>
<td style="text-align:left;">
0.870967741935484
</td>
<td style="text-align:left;">
0.864864864864865
</td>
<td style="text-align:left;">
0.985294117647059
</td>
<td style="text-align:left;">
0.942857142857143
</td>
<td style="text-align:left;">
0.859375
</td>
</tr>
</tbody>
</table>
<p>Todos os modelos tiveram uma performace bem semelhante, sendo que knn, com <span class="math inline">\(k=3\)</span>, obteve o melhor resultado em todas as medidas.</p>
</div>
<div id="agrupamento-3" class="section level3 hasAnchor" number="3.4.11">
<h3><span class="header-section-number">3.4.11</span> Agrupamento<a href="classification.html#agrupamento-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="classification.html#cb294-1" aria-hidden="true" tabindex="-1"></a>tipofacialS <span class="ot">=</span> <span class="fu">subset</span>(tipofacial, <span class="at">select=</span><span class="fu">c</span>(<span class="st">&quot;sexo&quot;</span>, <span class="st">&quot;idade&quot;</span>, <span class="st">&quot;altfac&quot;</span>, <span class="st">&quot;proffac&quot;</span>))</span>
<span id="cb294-2"><a href="classification.html#cb294-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-3"><a href="classification.html#cb294-3" aria-hidden="true" tabindex="-1"></a>dummy <span class="ot">&lt;-</span> <span class="fu">dummyVars</span>(<span class="st">&quot; ~ .&quot;</span>, <span class="at">data=</span>tipofacialS)</span>
<span id="cb294-4"><a href="classification.html#cb294-4" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">predict</span>(dummy, <span class="at">newdata =</span> tipofacialS)) </span>
<span id="cb294-5"><a href="classification.html#cb294-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb294-6"><a href="classification.html#cb294-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(newdata, <span class="at">method =</span> <span class="st">&quot;maximum&quot;</span>)</span>
<span id="cb294-7"><a href="classification.html#cb294-7" aria-hidden="true" tabindex="-1"></a>grup <span class="ot">=</span> <span class="fu">hclust</span>(d, <span class="at">method =</span> <span class="st">&quot;ward.D&quot;</span>)</span>
<span id="cb294-8"><a href="classification.html#cb294-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grup, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-128-1.png" width="672" /></p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="classification.html#cb295-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">cutree</span>(grup, <span class="at">k=</span><span class="dv">3</span>)</span>
<span id="cb295-2"><a href="classification.html#cb295-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(groups, tipofacial<span class="sc">$</span>grupo)</span></code></pre></div>
<pre><code>##       
## groups braq dolico meso
##      1   12     19   19
##      2    9     12   12
##      3   12      0    6</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="classification.html#cb297-1" aria-hidden="true" tabindex="-1"></a>km1 <span class="ot">=</span> <span class="fu">kmeans</span>(newdata, <span class="dv">4</span>)</span>
<span id="cb297-2"><a href="classification.html#cb297-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">fviz_cluster</span>(km1, <span class="at">data=</span>newdata,</span>
<span id="cb297-3"><a href="classification.html#cb297-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#2E9FDF&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#E7B700&quot;</span>),</span>
<span id="cb297-4"><a href="classification.html#cb297-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">star.plot=</span><span class="cn">FALSE</span>,</span>
<span id="cb297-5"><a href="classification.html#cb297-5" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># repel=TRUE,</span></span>
<span id="cb297-6"><a href="classification.html#cb297-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme=</span><span class="fu">theme_bw</span>())</span>
<span id="cb297-7"><a href="classification.html#cb297-7" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-129-1.png" width="672" /></p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="classification.html#cb298-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">=</span> km1<span class="sc">$</span>cluster</span>
<span id="cb298-2"><a href="classification.html#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(groups, tipofacial<span class="sc">$</span>grupo)</span></code></pre></div>
<pre><code>##       
## groups braq dolico meso
##      1    0     12    7
##      2   12     19   19
##      3   11      0    5
##      4   10      0    6</code></pre>
</div>
</div>
<div id="análise-do-conjunto-de-dados-usarrests" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Análise do conjunto de dados USArrests<a href="classification.html#análise-do-conjunto-de-dados-usarrests" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Análise de agrupamento para os dados USArrests.</p>
<div id="pacotes-9" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Pacotes<a href="classification.html#pacotes-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pacotes necessários para estes exercícios:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="classification.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb300-2"><a href="classification.html#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb300-3"><a href="classification.html#cb300-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb300-4"><a href="classification.html#cb300-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb300-5"><a href="classification.html#cb300-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb300-6"><a href="classification.html#cb300-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb300-7"><a href="classification.html#cb300-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb300-8"><a href="classification.html#cb300-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span></code></pre></div>
</div>
<div id="conjunto-de-dados-11" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Conjunto de dados<a href="classification.html#conjunto-de-dados-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://www.rdocumentation.org/packages/datasets/versions/3.6.2/topics/USArrests">USArrests</a> é um conjunto de dados contendo estatísticas de prisões por 100.000 habitantes por agressão, assassinato e estupro em cada um dos 50 estados dos EUA em 1973. Também é fornecida a porcentagem da população que vive em áreas urbanas.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="classification.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(USArrests)</span>
<span id="cb301-2"><a href="classification.html#cb301-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-3"><a href="classification.html#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(graphics)</span>
<span id="cb301-4"><a href="classification.html#cb301-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(USArrests, <span class="at">panel =</span> panel.smooth, <span class="at">main =</span> <span class="st">&quot;USArrests data&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-132-1.png" width="672" /></p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="classification.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Difference between &#39;USArrests&#39; and its correction</span></span>
<span id="cb302-2"><a href="classification.html#cb302-2" aria-hidden="true" tabindex="-1"></a>USArrests[<span class="st">&quot;Maryland&quot;</span>, <span class="st">&quot;UrbanPop&quot;</span>] <span class="co"># 67 -- the transcription error</span></span>
<span id="cb302-3"><a href="classification.html#cb302-3" aria-hidden="true" tabindex="-1"></a>UA.C <span class="ot">&lt;-</span> USArrests</span>
<span id="cb302-4"><a href="classification.html#cb302-4" aria-hidden="true" tabindex="-1"></a>UA.C[<span class="st">&quot;Maryland&quot;</span>, <span class="st">&quot;UrbanPop&quot;</span>] <span class="ot">&lt;-</span> <span class="fl">76.6</span></span>
<span id="cb302-5"><a href="classification.html#cb302-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-6"><a href="classification.html#cb302-6" aria-hidden="true" tabindex="-1"></a><span class="do">## also +/- 0.5 to restore the original  &lt;n&gt;.5  percentages</span></span>
<span id="cb302-7"><a href="classification.html#cb302-7" aria-hidden="true" tabindex="-1"></a>s5u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Colorado&quot;</span>, <span class="st">&quot;Florida&quot;</span>, <span class="st">&quot;Mississippi&quot;</span>, <span class="st">&quot;Wyoming&quot;</span>)</span>
<span id="cb302-8"><a href="classification.html#cb302-8" aria-hidden="true" tabindex="-1"></a>s5d <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Nebraska&quot;</span>, <span class="st">&quot;Pennsylvania&quot;</span>)</span>
<span id="cb302-9"><a href="classification.html#cb302-9" aria-hidden="true" tabindex="-1"></a>UA.C[s5u, <span class="st">&quot;UrbanPop&quot;</span>] <span class="ot">&lt;-</span> UA.C[s5u, <span class="st">&quot;UrbanPop&quot;</span>] <span class="sc">+</span> <span class="fl">0.5</span></span>
<span id="cb302-10"><a href="classification.html#cb302-10" aria-hidden="true" tabindex="-1"></a>UA.C[s5d, <span class="st">&quot;UrbanPop&quot;</span>] <span class="ot">&lt;-</span> UA.C[s5d, <span class="st">&quot;UrbanPop&quot;</span>] <span class="sc">-</span> <span class="fl">0.5</span></span></code></pre></div>
</div>
<div id="agrupamento-4" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Agrupamento<a href="classification.html#agrupamento-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="classification.html#cb303-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">scale</span>(USArrests)</span>
<span id="cb303-2"><a href="classification.html#cb303-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-3"><a href="classification.html#cb303-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df)</span></code></pre></div>
<pre><code>##      Murder           Assault           UrbanPop             Rape        
##  Min.   :-1.6044   Min.   :-1.5090   Min.   :-2.31714   Min.   :-1.4874  
##  1st Qu.:-0.8525   1st Qu.:-0.7411   1st Qu.:-0.76271   1st Qu.:-0.6574  
##  Median :-0.1235   Median :-0.1411   Median : 0.03178   Median :-0.1209  
##  Mean   : 0.0000   Mean   : 0.0000   Mean   : 0.00000   Mean   : 0.0000  
##  3rd Qu.: 0.7949   3rd Qu.: 0.9388   3rd Qu.: 0.84354   3rd Qu.: 0.5277  
##  Max.   : 2.2069   Max.   : 1.9948   Max.   : 1.75892   Max.   : 2.6444</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="classification.html#cb305-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(df, <span class="at">method =</span> <span class="st">&quot;maximum&quot;</span>)</span>
<span id="cb305-2"><a href="classification.html#cb305-2" aria-hidden="true" tabindex="-1"></a>grup <span class="ot">=</span> <span class="fu">hclust</span>(d, <span class="at">method =</span> <span class="st">&quot;ward.D&quot;</span>)</span>
<span id="cb305-3"><a href="classification.html#cb305-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grup, <span class="at">cex =</span> <span class="fl">0.6</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="classification.html#cb306-1" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">cutree</span>(grup, <span class="at">k=</span><span class="dv">3</span>)</span>
<span id="cb306-2"><a href="classification.html#cb306-2" aria-hidden="true" tabindex="-1"></a>groups</span></code></pre></div>
<pre><code>##        Alabama         Alaska        Arizona       Arkansas     California 
##              1              2              1              2              1 
##       Colorado    Connecticut       Delaware        Florida        Georgia 
##              1              2              2              1              1 
##         Hawaii          Idaho       Illinois        Indiana           Iowa 
##              2              3              1              2              3 
##         Kansas       Kentucky      Louisiana          Maine       Maryland 
##              2              2              1              3              1 
##  Massachusetts       Michigan      Minnesota    Mississippi       Missouri 
##              2              1              3              1              2 
##        Montana       Nebraska         Nevada  New Hampshire     New Jersey 
##              3              3              1              3              2 
##     New Mexico       New York North Carolina   North Dakota           Ohio 
##              1              1              1              3              2 
##       Oklahoma         Oregon   Pennsylvania   Rhode Island South Carolina 
##              2              2              2              2              1 
##   South Dakota      Tennessee          Texas           Utah        Vermont 
##              3              1              1              2              3 
##       Virginia     Washington  West Virginia      Wisconsin        Wyoming 
##              2              2              3              3              2</code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="classification.html#cb308-1" aria-hidden="true" tabindex="-1"></a>km1 <span class="ot">=</span> <span class="fu">kmeans</span>(df, <span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb308-2"><a href="classification.html#cb308-2" aria-hidden="true" tabindex="-1"></a>km1</span></code></pre></div>
<pre><code>## K-means clustering with 4 clusters of sizes 8, 13, 13, 16
## 
## Cluster means:
##       Murder    Assault   UrbanPop        Rape
## 1  1.4118898  0.8743346 -0.8145211  0.01927104
## 2  0.6950701  1.0394414  0.7226370  1.27693964
## 3 -0.9615407 -1.1066010 -0.9301069 -0.96676331
## 4 -0.4894375 -0.3826001  0.5758298 -0.26165379
## 
## Clustering vector:
##        Alabama         Alaska        Arizona       Arkansas     California 
##              1              2              2              1              2 
##       Colorado    Connecticut       Delaware        Florida        Georgia 
##              2              4              4              2              1 
##         Hawaii          Idaho       Illinois        Indiana           Iowa 
##              4              3              2              4              3 
##         Kansas       Kentucky      Louisiana          Maine       Maryland 
##              4              3              1              3              2 
##  Massachusetts       Michigan      Minnesota    Mississippi       Missouri 
##              4              2              3              1              2 
##        Montana       Nebraska         Nevada  New Hampshire     New Jersey 
##              3              3              2              3              4 
##     New Mexico       New York North Carolina   North Dakota           Ohio 
##              2              2              1              3              4 
##       Oklahoma         Oregon   Pennsylvania   Rhode Island South Carolina 
##              4              4              4              4              1 
##   South Dakota      Tennessee          Texas           Utah        Vermont 
##              3              1              2              4              3 
##       Virginia     Washington  West Virginia      Wisconsin        Wyoming 
##              4              4              3              3              4 
## 
## Within cluster sum of squares by cluster:
## [1]  8.316061 19.922437 11.952463 16.212213
##  (between_SS / total_SS =  71.2 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot;
## [6] &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;         &quot;ifault&quot;</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="classification.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(df, <span class="at">by=</span><span class="fu">list</span>(<span class="at">cluster=</span>km1<span class="sc">$</span>cluster), mean)</span></code></pre></div>
<pre><code>##   cluster     Murder    Assault   UrbanPop        Rape
## 1       1  1.4118898  0.8743346 -0.8145211  0.01927104
## 2       2  0.6950701  1.0394414  0.7226370  1.27693964
## 3       3 -0.9615407 -1.1066010 -0.9301069 -0.96676331
## 4       4 -0.4894375 -0.3826001  0.5758298 -0.26165379</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="classification.html#cb312-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">fviz_cluster</span>(km1, <span class="at">data=</span>df,</span>
<span id="cb312-2"><a href="classification.html#cb312-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#2E9FDF&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#E7B700&quot;</span>),</span>
<span id="cb312-3"><a href="classification.html#cb312-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">star.plot=</span><span class="cn">FALSE</span>,</span>
<span id="cb312-4"><a href="classification.html#cb312-4" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># repel=TRUE,</span></span>
<span id="cb312-5"><a href="classification.html#cb312-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme=</span><span class="fu">theme_bw</span>(),</span>
<span id="cb312-6"><a href="classification.html#cb312-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main =</span> <span class="st">&quot;Particionamento&quot;</span>)</span>
<span id="cb312-7"><a href="classification.html#cb312-7" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-136-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="final-work.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-classification.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
