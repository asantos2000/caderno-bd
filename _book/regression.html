<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Cap. 2 Regressão | Caderno de exercícos Mestrado de computação aplicada</title>
  <meta name="description" content="Caderno de exercício Big Data" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Cap. 2 Regressão | Caderno de exercícos Mestrado de computação aplicada" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Caderno de exercício Big Data" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Cap. 2 Regressão | Caderno de exercícos Mestrado de computação aplicada" />
  
  <meta name="twitter:description" content="Caderno de exercício Big Data" />
  

<meta name="author" content="Anderson dos Santos" />


<meta name="date" content="2022-12-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="descriptive.html"/>
<link rel="next" href="classification.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Caderno de BD</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Big Data Analytics 2022</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#organização"><i class="fa fa-check"></i>Organização</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="descriptive.html"><a href="descriptive.html"><i class="fa fa-check"></i><b>1</b> Estatística descritiva</a>
<ul>
<li class="chapter" data-level="1.1" data-path="descriptive.html"><a href="descriptive.html#exercício"><i class="fa fa-check"></i><b>1.1</b> Exercício</a></li>
<li class="chapter" data-level="1.2" data-path="descriptive.html"><a href="descriptive.html#pacotes"><i class="fa fa-check"></i><b>1.2</b> Pacotes</a></li>
<li class="chapter" data-level="1.3" data-path="descriptive.html"><a href="descriptive.html#conjunto-de-dados"><i class="fa fa-check"></i><b>1.3</b> Conjunto de dados</a></li>
<li class="chapter" data-level="1.4" data-path="descriptive.html"><a href="descriptive.html#informações-dos-atributos"><i class="fa fa-check"></i><b>1.4</b> Informações dos atributos</a></li>
<li class="chapter" data-level="1.5" data-path="descriptive.html"><a href="descriptive.html#análise-descritiva-de-algumas-ações"><i class="fa fa-check"></i><b>1.5</b> Análise descritiva de algumas ações</a></li>
<li class="chapter" data-level="1.6" data-path="descriptive.html"><a href="descriptive.html#avaliando-nubr33"><i class="fa fa-check"></i><b>1.6</b> Avaliando NUBR33</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>2</b> Regressão</a>
<ul>
<li class="chapter" data-level="2.1" data-path="regression.html"><a href="regression.html#conjunto-de-dados-1"><i class="fa fa-check"></i><b>2.1</b> Conjunto de dados</a></li>
<li class="chapter" data-level="2.2" data-path="regression.html"><a href="regression.html#preço-das-casas"><i class="fa fa-check"></i><b>2.2</b> Preço das casas</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="regression.html"><a href="regression.html#pacotes-1"><i class="fa fa-check"></i><b>2.2.1</b> Pacotes</a></li>
<li class="chapter" data-level="2.2.2" data-path="regression.html"><a href="regression.html#conjunto-de-dados-2"><i class="fa fa-check"></i><b>2.2.2</b> Conjunto de dados</a></li>
<li class="chapter" data-level="2.2.3" data-path="regression.html"><a href="regression.html#descrevendo-os-dados"><i class="fa fa-check"></i><b>2.2.3</b> Descrevendo os dados:</a></li>
<li class="chapter" data-level="2.2.4" data-path="regression.html"><a href="regression.html#ajustes-de-modelos-lineares-simples"><i class="fa fa-check"></i><b>2.2.4</b> Ajustes de modelos lineares simples</a></li>
<li class="chapter" data-level="2.2.5" data-path="regression.html"><a href="regression.html#predição"><i class="fa fa-check"></i><b>2.2.5</b> Predição</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="regression.html"><a href="regression.html#análise-conjunto-energia"><i class="fa fa-check"></i><b>2.3</b> Análise conjunto energia</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="regression.html"><a href="regression.html#pacotes-2"><i class="fa fa-check"></i><b>2.3.1</b> Pacotes</a></li>
<li class="chapter" data-level="2.3.2" data-path="regression.html"><a href="regression.html#conjunto-de-dados-3"><i class="fa fa-check"></i><b>2.3.2</b> Conjunto de dados</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="regression.html"><a href="regression.html#análise-conjunto-vendas-vs-fontes-de-publidades"><i class="fa fa-check"></i><b>2.4</b> Análise Conjunto vendas vs fontes de publidades</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="regression.html"><a href="regression.html#pacotes-3"><i class="fa fa-check"></i><b>2.4.1</b> Pacotes</a></li>
<li class="chapter" data-level="2.4.2" data-path="regression.html"><a href="regression.html#conjunto-de-dados-4"><i class="fa fa-check"></i><b>2.4.2</b> Conjunto de dados</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="regression.html"><a href="regression.html#análise-conjunto-st-vs-demais-variáveiscredit-score-x-renda-e-outras-v"><i class="fa fa-check"></i><b>2.5</b> Análise conjunto ST vs demais variáveisCREDIT SCORE X RENDA E OUTRAS V</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="regression.html"><a href="regression.html#pacotes-4"><i class="fa fa-check"></i><b>2.5.1</b> Pacotes</a></li>
<li class="chapter" data-level="2.5.2" data-path="regression.html"><a href="regression.html#conjunto-de-dados-5"><i class="fa fa-check"></i><b>2.5.2</b> Conjunto de dados</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="regression.html"><a href="regression.html#consumo-alimentar-médio"><i class="fa fa-check"></i><b>2.6</b> Consumo alimentar médio</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="regression.html"><a href="regression.html#pacotes-5"><i class="fa fa-check"></i><b>2.6.1</b> Pacotes</a></li>
<li class="chapter" data-level="2.6.2" data-path="regression.html"><a href="regression.html#conjunto-de-dados-6"><i class="fa fa-check"></i><b>2.6.2</b> Conjunto de dados</a></li>
<li class="chapter" data-level="2.6.3" data-path="regression.html"><a href="regression.html#regressão"><i class="fa fa-check"></i><b>2.6.3</b> Regressão</a></li>
<li class="chapter" data-level="2.6.4" data-path="regression.html"><a href="regression.html#predição-1"><i class="fa fa-check"></i><b>2.6.4</b> Predição</a></li>
<li class="chapter" data-level="2.6.5" data-path="regression.html"><a href="regression.html#agrupamento"><i class="fa fa-check"></i><b>2.6.5</b> Agrupamento</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>3</b> Classificação</a>
<ul>
<li class="chapter" data-level="3.1" data-path="classification.html"><a href="classification.html#conjunto-de-dados-7"><i class="fa fa-check"></i><b>3.1</b> Conjunto de dados</a></li>
<li class="chapter" data-level="3.2" data-path="classification.html"><a href="classification.html#inibina-b-como-marcador"><i class="fa fa-check"></i><b>3.2</b> Inibina B como marcador</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="classification.html"><a href="classification.html#pacotes-6"><i class="fa fa-check"></i><b>3.2.1</b> Pacotes</a></li>
<li class="chapter" data-level="3.2.2" data-path="classification.html"><a href="classification.html#conjunto-de-dados-8"><i class="fa fa-check"></i><b>3.2.2</b> Conjunto de dados</a></li>
<li class="chapter" data-level="3.2.3" data-path="classification.html"><a href="classification.html#generalized-linear-models"><i class="fa fa-check"></i><b>3.2.3</b> Generalized Linear Models</a></li>
<li class="chapter" data-level="3.2.4" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis---fisher"><i class="fa fa-check"></i><b>3.2.4</b> Linear Discriminant Analysis - Fisher</a></li>
<li class="chapter" data-level="3.2.5" data-path="classification.html"><a href="classification.html#bayes"><i class="fa fa-check"></i><b>3.2.5</b> Bayes</a></li>
<li class="chapter" data-level="3.2.6" data-path="classification.html"><a href="classification.html#decison-tree"><i class="fa fa-check"></i><b>3.2.6</b> Decison tree</a></li>
<li class="chapter" data-level="3.2.7" data-path="classification.html"><a href="classification.html#svm"><i class="fa fa-check"></i><b>3.2.7</b> SVM</a></li>
<li class="chapter" data-level="3.2.8" data-path="classification.html"><a href="classification.html#neural-network"><i class="fa fa-check"></i><b>3.2.8</b> Neural network</a></li>
<li class="chapter" data-level="3.2.9" data-path="classification.html"><a href="classification.html#knn"><i class="fa fa-check"></i><b>3.2.9</b> KNN</a></li>
<li class="chapter" data-level="3.2.10" data-path="classification.html"><a href="classification.html#comparando-os-modelos"><i class="fa fa-check"></i><b>3.2.10</b> Comparando os modelos</a></li>
<li class="chapter" data-level="3.2.11" data-path="classification.html"><a href="classification.html#agrupamento-1"><i class="fa fa-check"></i><b>3.2.11</b> Agrupamento</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="classification.html"><a href="classification.html#ultrassom-para-medir-deslocamento-do-disco"><i class="fa fa-check"></i><b>3.3</b> Ultrassom para medir deslocamento do disco</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="classification.html"><a href="classification.html#pacotes-7"><i class="fa fa-check"></i><b>3.3.1</b> Pacotes</a></li>
<li class="chapter" data-level="3.3.2" data-path="classification.html"><a href="classification.html#conjunto-de-dados-9"><i class="fa fa-check"></i><b>3.3.2</b> Conjunto de dados</a></li>
<li class="chapter" data-level="3.3.3" data-path="classification.html"><a href="classification.html#generalized-linear-models-1"><i class="fa fa-check"></i><b>3.3.3</b> Generalized Linear Models</a></li>
<li class="chapter" data-level="3.3.4" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis---fisher-1"><i class="fa fa-check"></i><b>3.3.4</b> Linear Discriminant Analysis - Fisher</a></li>
<li class="chapter" data-level="3.3.5" data-path="classification.html"><a href="classification.html#bayes-1"><i class="fa fa-check"></i><b>3.3.5</b> Bayes</a></li>
<li class="chapter" data-level="3.3.6" data-path="classification.html"><a href="classification.html#naive-bayes-1"><i class="fa fa-check"></i><b>3.3.6</b> Naive Bayes</a></li>
<li class="chapter" data-level="3.3.7" data-path="classification.html"><a href="classification.html#decison-tree-1"><i class="fa fa-check"></i><b>3.3.7</b> Decison tree</a></li>
<li class="chapter" data-level="3.3.8" data-path="classification.html"><a href="classification.html#svm-1"><i class="fa fa-check"></i><b>3.3.8</b> SVM</a></li>
<li class="chapter" data-level="3.3.9" data-path="classification.html"><a href="classification.html#neural-network-1"><i class="fa fa-check"></i><b>3.3.9</b> Neural Network</a></li>
<li class="chapter" data-level="3.3.10" data-path="classification.html"><a href="classification.html#knn-1"><i class="fa fa-check"></i><b>3.3.10</b> KNN</a></li>
<li class="chapter" data-level="3.3.11" data-path="classification.html"><a href="classification.html#comparando-os-modelos-1"><i class="fa fa-check"></i><b>3.3.11</b> Comparando os modelos</a></li>
<li class="chapter" data-level="3.3.12" data-path="classification.html"><a href="classification.html#agrupamento-2"><i class="fa fa-check"></i><b>3.3.12</b> Agrupamento</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="classification.html"><a href="classification.html#classificação-de-tipos-faciais"><i class="fa fa-check"></i><b>3.4</b> Classificação de tipos faciais</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="classification.html"><a href="classification.html#pacotes-8"><i class="fa fa-check"></i><b>3.4.1</b> Pacotes</a></li>
<li class="chapter" data-level="3.4.2" data-path="classification.html"><a href="classification.html#conjunto-de-dados-10"><i class="fa fa-check"></i><b>3.4.2</b> Conjunto de dados</a></li>
<li class="chapter" data-level="3.4.3" data-path="classification.html"><a href="classification.html#separando-o-conjunto-de-dados-para-treinamento"><i class="fa fa-check"></i><b>3.4.3</b> Separando o conjunto de dados para treinamento</a></li>
<li class="chapter" data-level="3.4.4" data-path="classification.html"><a href="classification.html#generalized-linear-models-2"><i class="fa fa-check"></i><b>3.4.4</b> Generalized Linear Models</a></li>
<li class="chapter" data-level="3.4.5" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis---fisher-2"><i class="fa fa-check"></i><b>3.4.5</b> Linear Discriminant Analysis - Fisher</a></li>
<li class="chapter" data-level="3.4.6" data-path="classification.html"><a href="classification.html#bayes-2"><i class="fa fa-check"></i><b>3.4.6</b> Bayes</a></li>
<li class="chapter" data-level="3.4.7" data-path="classification.html"><a href="classification.html#naive-bayes-2"><i class="fa fa-check"></i><b>3.4.7</b> Naive Bayes</a></li>
<li class="chapter" data-level="3.4.8" data-path="classification.html"><a href="classification.html#decison-tree-2"><i class="fa fa-check"></i><b>3.4.8</b> Decison tree</a></li>
<li class="chapter" data-level="3.4.9" data-path="classification.html"><a href="classification.html#svm-2"><i class="fa fa-check"></i><b>3.4.9</b> SVM</a></li>
<li class="chapter" data-level="3.4.10" data-path="classification.html"><a href="classification.html#neural-networks"><i class="fa fa-check"></i><b>3.4.10</b> Neural networks</a></li>
<li class="chapter" data-level="3.4.11" data-path="classification.html"><a href="classification.html#knn-2"><i class="fa fa-check"></i><b>3.4.11</b> KNN</a></li>
<li class="chapter" data-level="3.4.12" data-path="classification.html"><a href="classification.html#comparando-os-modelos-2"><i class="fa fa-check"></i><b>3.4.12</b> Comparando os modelos</a></li>
<li class="chapter" data-level="3.4.13" data-path="classification.html"><a href="classification.html#agrupamento-3"><i class="fa fa-check"></i><b>3.4.13</b> Agrupamento</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="classification.html"><a href="classification.html#análise-do-conjunto-de-dados-usarrests"><i class="fa fa-check"></i><b>3.5</b> Análise do conjunto de dados USArrests</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="classification.html"><a href="classification.html#pacotes-9"><i class="fa fa-check"></i><b>3.5.1</b> Pacotes</a></li>
<li class="chapter" data-level="3.5.2" data-path="classification.html"><a href="classification.html#conjunto-de-dados-11"><i class="fa fa-check"></i><b>3.5.2</b> Conjunto de dados</a></li>
<li class="chapter" data-level="3.5.3" data-path="classification.html"><a href="classification.html#agrupamento-4"><i class="fa fa-check"></i><b>3.5.3</b> Agrupamento</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="final-work.html"><a href="final-work.html"><i class="fa fa-check"></i><b>4</b> Trabalho final</a>
<ul>
<li class="chapter" data-level="4.1" data-path="final-work.html"><a href="final-work.html#introdução"><i class="fa fa-check"></i><b>4.1</b> Introdução</a></li>
<li class="chapter" data-level="4.2" data-path="final-work.html"><a href="final-work.html#objetivo"><i class="fa fa-check"></i><b>4.2</b> Objetivo</a></li>
<li class="chapter" data-level="4.3" data-path="final-work.html"><a href="final-work.html#problema"><i class="fa fa-check"></i><b>4.3</b> Problema</a></li>
<li class="chapter" data-level="4.4" data-path="final-work.html"><a href="final-work.html#metodologia"><i class="fa fa-check"></i><b>4.4</b> Metodologia</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="final-work.html"><a href="final-work.html#estimando-a-surpresa-dos-mercados"><i class="fa fa-check"></i><b>4.4.1</b> Estimando a Surpresa dos Mercados</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="final-work.html"><a href="final-work.html#fonte-de-dados"><i class="fa fa-check"></i><b>4.5</b> Fonte de dados</a></li>
<li class="chapter" data-level="4.6" data-path="final-work.html"><a href="final-work.html#índice-ibovespa"><i class="fa fa-check"></i><b>4.6</b> Índice IBOVESPA</a></li>
<li class="chapter" data-level="4.7" data-path="final-work.html"><a href="final-work.html#indicador-selic"><i class="fa fa-check"></i><b>4.7</b> Indicador SELIC</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="final-work.html"><a href="final-work.html#unindo-os-conjuntos-de-dados"><i class="fa fa-check"></i><b>4.7.1</b> Unindo os conjuntos de dados</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="final-work.html"><a href="final-work.html#correlação-ibovespa-e-selic"><i class="fa fa-check"></i><b>4.8</b> Correlação ibovespa e selic</a></li>
<li class="chapter" data-level="4.9" data-path="final-work.html"><a href="final-work.html#decomposição-anual"><i class="fa fa-check"></i><b>4.9</b> Decomposição anual</a></li>
<li class="chapter" data-level="4.10" data-path="final-work.html"><a href="final-work.html#análise-de-outliers"><i class="fa fa-check"></i><b>4.10</b> Análise de <em>outliers</em></a></li>
<li class="chapter" data-level="4.11" data-path="final-work.html"><a href="final-work.html#correlação-cruzada-ibovespa-e-selic"><i class="fa fa-check"></i><b>4.11</b> Correlação cruzada ibovespa e selic</a></li>
<li class="chapter" data-level="4.12" data-path="final-work.html"><a href="final-work.html#expectativas-do-copom-nos-contratos-de-di1"><i class="fa fa-check"></i><b>4.12</b> Expectativas do COPOM nos contratos de DI1</a></li>
<li class="chapter" data-level="4.13" data-path="final-work.html"><a href="final-work.html#conclusão"><i class="fa fa-check"></i><b>4.13</b> Conclusão</a></li>
<li class="chapter" data-level="4.14" data-path="final-work.html"><a href="final-work.html#referências"><i class="fa fa-check"></i><b>4.14</b> Referências</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Caderno de exercícos Mestrado de computação aplicada</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Cap. 2</span> Regressão<a href="regression.html#regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>A regressão em geral tem como objetivo:</p>
<ol style="list-style-type: decimal">
<li>Medir a influência de uma ou mais variáveis explicativas (x) sobre a variável resposta (y);</li>
<li>Predição de uma variável resposta (y) a partir de uma ou mais variáveis explicativas (x).</li>
</ol>
<div id="conjunto-de-dados-1" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Conjunto de dados<a href="regression.html#conjunto-de-dados-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Este conjunto de dados foram criados pela professora Dra.Olga Satomi Yoshida para aula de Big Data no IPT.</p>
<ol style="list-style-type: decimal">
<li>Preço das casas: Data_HousePrice_Area.xlsx</li>
<li>Consumo de energia: Data_ConsumoEnergia.xlsx</li>
<li>SALES_X_YOUTUBE: DadosAula06.xlsx</li>
<li>CREDIT SCORE X RENDA E OUTRAS V: DadosAula06.xlsx</li>
</ol>
</div>
<div id="preço-das-casas" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Preço das casas<a href="regression.html#preço-das-casas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Análise descritiva e regressão linear sobre o conjunto de dados Data_HousePrice_Area.xlsx.</p>
<div id="pacotes-1" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Pacotes<a href="regression.html#pacotes-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pacotes necessários para estes exercícios:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="regression.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb15-2"><a href="regression.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb15-3"><a href="regression.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb15-4"><a href="regression.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb15-5"><a href="regression.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb15-6"><a href="regression.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb15-7"><a href="regression.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code></pre></div>
</div>
<div id="conjunto-de-dados-2" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Conjunto de dados<a href="regression.html#conjunto-de-dados-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="regression.html#cb16-1" aria-hidden="true" tabindex="-1"></a>dadosCen01 <span class="ot">=</span> <span class="fu">read_excel</span>(<span class="st">&quot;../dados/Data_HousePrice_Area.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">1</span>)</span>
<span id="cb16-2"><a href="regression.html#cb16-2" aria-hidden="true" tabindex="-1"></a>dadosCen02 <span class="ot">=</span> <span class="fu">read_excel</span>(<span class="st">&quot;../dados/Data_HousePrice_Area.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Dados do cenário 01</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
Square Feet
</th>
<th style="text-align:right;">
House Price
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1400
</td>
<td style="text-align:right;">
245
</td>
</tr>
<tr>
<td style="text-align:right;">
1600
</td>
<td style="text-align:right;">
312
</td>
</tr>
<tr>
<td style="text-align:right;">
1700
</td>
<td style="text-align:right;">
279
</td>
</tr>
<tr>
<td style="text-align:right;">
1875
</td>
<td style="text-align:right;">
308
</td>
</tr>
<tr>
<td style="text-align:right;">
1100
</td>
<td style="text-align:right;">
199
</td>
</tr>
<tr>
<td style="text-align:right;">
1550
</td>
<td style="text-align:right;">
219
</td>
</tr>
<tr>
<td style="text-align:right;">
2350
</td>
<td style="text-align:right;">
405
</td>
</tr>
<tr>
<td style="text-align:right;">
2450
</td>
<td style="text-align:right;">
324
</td>
</tr>
<tr>
<td style="text-align:right;">
1425
</td>
<td style="text-align:right;">
319
</td>
</tr>
<tr>
<td style="text-align:right;">
1700
</td>
<td style="text-align:right;">
255
</td>
</tr>
</tbody>
</table>
<p>Dados do cenário 02</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
Square Feet
</th>
<th style="text-align:right;">
House Price
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1400
</td>
<td style="text-align:right;">
245
</td>
</tr>
<tr>
<td style="text-align:right;">
1800
</td>
<td style="text-align:right;">
312
</td>
</tr>
<tr>
<td style="text-align:right;">
1700
</td>
<td style="text-align:right;">
279
</td>
</tr>
<tr>
<td style="text-align:right;">
1875
</td>
<td style="text-align:right;">
308
</td>
</tr>
<tr>
<td style="text-align:right;">
1200
</td>
<td style="text-align:right;">
199
</td>
</tr>
<tr>
<td style="text-align:right;">
1480
</td>
<td style="text-align:right;">
219
</td>
</tr>
<tr>
<td style="text-align:right;">
2350
</td>
<td style="text-align:right;">
405
</td>
</tr>
<tr>
<td style="text-align:right;">
2100
</td>
<td style="text-align:right;">
324
</td>
</tr>
<tr>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
319
</td>
</tr>
<tr>
<td style="text-align:right;">
1700
</td>
<td style="text-align:right;">
255
</td>
</tr>
</tbody>
</table>
<p>Dispersão dos valores para os dois cenários:</p>
<p><img src="02-regression_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Comparando os dois gráficos, podemos observar:</p>
<ul>
<li>O primeiro conjunto é mais esparso</li>
<li>O segundo cenário os dados estão agrupados de forma linear</li>
</ul>
</div>
<div id="descrevendo-os-dados" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Descrevendo os dados:<a href="regression.html#descrevendo-os-dados" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="cenário-1" class="section level4 hasAnchor" number="2.2.3.1">
<h4><span class="header-section-number">2.2.3.1</span> Cenário 1<a href="regression.html#cenário-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>House Price</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="regression.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dadosCen01<span class="sc">$</span><span class="st">`</span><span class="at">House Price</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   199.0   247.5   293.5   286.5   317.2   405.0</code></pre>
<p>Square Feet</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="regression.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dadosCen01<span class="sc">$</span><span class="st">`</span><span class="at">Square Feet</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1100    1456    1650    1715    1831    2450</code></pre>
<p>Distribuição dos valores</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="regression.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dadosCen01<span class="sc">$</span><span class="st">`</span><span class="at">House Price</span><span class="st">`</span>)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="cenário-2" class="section level4 hasAnchor" number="2.2.3.2">
<h4><span class="header-section-number">2.2.3.2</span> Cenário 2<a href="regression.html#cenário-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>House Price</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="regression.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dadosCen02<span class="sc">$</span><span class="st">`</span><span class="at">House Price</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   199.0   247.5   293.5   286.5   317.2   405.0</code></pre>
<p>Square Feet</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="regression.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dadosCen02<span class="sc">$</span><span class="st">`</span><span class="at">Square Feet</span><span class="st">`</span>)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1200    1535    1750    1760    1969    2350</code></pre>
<p>Distribuição dos valores</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="regression.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(dadosCen01<span class="sc">$</span><span class="st">`</span><span class="at">House Price</span><span class="st">`</span>)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
</div>
<div id="ajustes-de-modelos-lineares-simples" class="section level3 hasAnchor" number="2.2.4">
<h3><span class="header-section-number">2.2.4</span> Ajustes de modelos lineares simples<a href="regression.html#ajustes-de-modelos-lineares-simples" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vamos agora ajustar um modelo de regressão para ambos os cenários.</p>
<div id="cenário-01" class="section level4 hasAnchor" number="2.2.4.1">
<h4><span class="header-section-number">2.2.4.1</span> Cenário 01<a href="regression.html#cenário-01" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="regression.html#cb27-1" aria-hidden="true" tabindex="-1"></a>modelCen01 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dadosCen01<span class="sc">$</span><span class="st">`</span><span class="at">House Price</span><span class="st">`</span> <span class="sc">~</span> dadosCen01<span class="sc">$</span><span class="st">`</span><span class="at">Square Feet</span><span class="st">`</span>)</span>
<span id="cb27-2"><a href="regression.html#cb27-2" aria-hidden="true" tabindex="-1"></a>modelCen01</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dadosCen01$`House Price` ~ dadosCen01$`Square Feet`)
## 
## Coefficients:
##              (Intercept)  dadosCen01$`Square Feet`  
##                  98.2483                    0.1098</code></pre>
<p><span class="math inline">\(y = 98.2483296 + 0.1097677 x\)</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="regression.html#cb29-1" aria-hidden="true" tabindex="-1"></a>resumoMod01 <span class="ot">=</span> <span class="fu">summary</span>(modelCen01)</span>
<span id="cb29-2"><a href="regression.html#cb29-2" aria-hidden="true" tabindex="-1"></a>resumoMod01</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = dadosCen01$`House Price` ~ dadosCen01$`Square Feet`)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -49.388 -27.388  -6.388  29.577  64.333 
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)              98.24833   58.03348   1.693   0.1289  
## dadosCen01$`Square Feet`  0.10977    0.03297   3.329   0.0104 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 41.33 on 8 degrees of freedom
## Multiple R-squared:  0.5808, Adjusted R-squared:  0.5284 
## F-statistic: 11.08 on 1 and 8 DF,  p-value: 0.01039</code></pre>
<p><span class="math inline">\(R^2 = 0.58\)</span></p>
<p>Vamos analisar os resíduos:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="regression.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelCen01<span class="sc">$</span>residuals <span class="sc">~</span> dadosCen01<span class="sc">$</span><span class="st">`</span><span class="at">House Price</span><span class="st">`</span>)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="regression.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelCen01, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-16-1.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-16-2.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-16-3.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-16-4.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="regression.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dadosCen01<span class="sc">$</span><span class="st">`</span><span class="at">House Price</span><span class="st">`</span> <span class="sc">~</span> dadosCen01<span class="sc">$</span><span class="st">`</span><span class="at">Square Feet</span><span class="st">`</span>)</span>
<span id="cb33-2"><a href="regression.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(modelCen01) <span class="co">#Add a regression line</span></span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-16-5.png" width="672" /></p>
<p>Como as observações são mais esparças, um modelo linear simples não se ajusta muito bem.</p>
</div>
<div id="cenário-02" class="section level4 hasAnchor" number="2.2.4.2">
<h4><span class="header-section-number">2.2.4.2</span> Cenário 02<a href="regression.html#cenário-02" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="regression.html#cb34-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> dadosCen02<span class="sc">$</span><span class="st">`</span><span class="at">House Price</span><span class="st">`</span></span>
<span id="cb34-2"><a href="regression.html#cb34-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> dadosCen02<span class="sc">$</span><span class="st">`</span><span class="at">Square Feet</span><span class="st">`</span></span>
<span id="cb34-3"><a href="regression.html#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="regression.html#cb34-4" aria-hidden="true" tabindex="-1"></a>modelCen02 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb34-5"><a href="regression.html#cb34-5" aria-hidden="true" tabindex="-1"></a>modelCen02</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Coefficients:
## (Intercept)            x  
##     -9.6451       0.1682</code></pre>
<p><span class="math inline">\(y = -9.6450892 + 0.1682165 x\)</span></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="regression.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelCen02, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-18-1.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-18-2.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-18-3.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-18-4.png" width="672" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="regression.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dadosCen01<span class="sc">$</span><span class="st">`</span><span class="at">House Price</span><span class="st">`</span> <span class="sc">~</span> dadosCen01<span class="sc">$</span><span class="st">`</span><span class="at">Square Feet</span><span class="st">`</span>)</span>
<span id="cb37-2"><a href="regression.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(modelCen01) <span class="co">#Add a regression line</span></span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-18-5.png" width="672" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="regression.html#cb38-1" aria-hidden="true" tabindex="-1"></a>resumoMod02 <span class="ot">=</span> <span class="fu">summary</span>(modelCen02)</span>
<span id="cb38-2"><a href="regression.html#cb38-2" aria-hidden="true" tabindex="-1"></a>resumoMod02</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -21.323 -16.654   2.458  15.838  19.336 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -9.64509   30.46626  -0.317     0.76    
## x            0.16822    0.01702   9.886 9.25e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 17.56 on 8 degrees of freedom
## Multiple R-squared:  0.9243, Adjusted R-squared:  0.9149 
## F-statistic: 97.73 on 1 and 8 DF,  p-value: 9.246e-06</code></pre>
<p><span class="math inline">\(R^2 = 0.92\)</span></p>
<p>Vamos analisar os resíduos:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="regression.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelCen02<span class="sc">$</span>residuals <span class="sc">~</span> dadosCen02<span class="sc">$</span><span class="st">`</span><span class="at">House Price</span><span class="st">`</span>)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Neste cenário as observações estão mais agrupadas próximas a uma reta, sendo assim o modelo linear simples descreveu melhor as observações.</p>
</div>
</div>
<div id="predição" class="section level3 hasAnchor" number="2.2.5">
<h3><span class="header-section-number">2.2.5</span> Predição<a href="regression.html#predição" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="regression.html#cb41-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1300</span>)</span>
<span id="cb41-2"><a href="regression.html#cb41-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x), new)</span></code></pre></div>
<p>Usando o modelo um, uma casa de <span class="math inline">\(1300ft^2\)</span> custaria <span class="math inline">\(209.04\)</span></p>
</div>
</div>
<div id="análise-conjunto-energia" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Análise conjunto energia<a href="regression.html#análise-conjunto-energia" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Análise descritiva e regressão linear sobre o conjunto de dados Data_ConsumoEnergia.xlsx.</p>
<div id="pacotes-2" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Pacotes<a href="regression.html#pacotes-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pacotes necessários para estes exercícios:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="regression.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb42-2"><a href="regression.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb42-3"><a href="regression.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb42-4"><a href="regression.html#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb42-5"><a href="regression.html#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb42-6"><a href="regression.html#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb42-7"><a href="regression.html#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code></pre></div>
</div>
<div id="conjunto-de-dados-3" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Conjunto de dados<a href="regression.html#conjunto-de-dados-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
Ajuste na maquina
</th>
<th style="text-align:right;">
Consumo de energia
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
11.15
</td>
<td style="text-align:right;">
21.6
</td>
</tr>
<tr>
<td style="text-align:right;">
15.70
</td>
<td style="text-align:right;">
4.0
</td>
</tr>
<tr>
<td style="text-align:right;">
18.90
</td>
<td style="text-align:right;">
1.8
</td>
</tr>
<tr>
<td style="text-align:right;">
19.40
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:right;">
21.40
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:right;">
21.70
</td>
<td style="text-align:right;">
0.8
</td>
</tr>
<tr>
<td style="text-align:right;">
25.30
</td>
<td style="text-align:right;">
3.8
</td>
</tr>
<tr>
<td style="text-align:right;">
26.40
</td>
<td style="text-align:right;">
7.4
</td>
</tr>
<tr>
<td style="text-align:right;">
26.70
</td>
<td style="text-align:right;">
4.3
</td>
</tr>
<tr>
<td style="text-align:right;">
29.10
</td>
<td style="text-align:right;">
36.2
</td>
</tr>
</tbody>
</table>
<p>Um gráfico dos dados:</p>
<div id="htmlwidget-cce63a815eacaa2abab5" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-cce63a815eacaa2abab5">{"x":{"data":[{"x":[11.15,15.7,18.9,19.4,21.4,21.7,25.3,26.4,26.7,29.1],"y":[21.6,4,1.8,1,1,0.8,3.8,7.4,4.3,36.2],"text":["Ajuste na maquina: 11.15<br />Consumo de energia: 21.6","Ajuste na maquina: 15.70<br />Consumo de energia:  4.0","Ajuste na maquina: 18.90<br />Consumo de energia:  1.8","Ajuste na maquina: 19.40<br />Consumo de energia:  1.0","Ajuste na maquina: 21.40<br />Consumo de energia:  1.0","Ajuste na maquina: 21.70<br />Consumo de energia:  0.8","Ajuste na maquina: 25.30<br />Consumo de energia:  3.8","Ajuste na maquina: 26.40<br />Consumo de energia:  7.4","Ajuste na maquina: 26.70<br />Consumo de energia:  4.3","Ajuste na maquina: 29.10<br />Consumo de energia: 36.2"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.2283105022831,"r":7.30593607305936,"b":40.1826484018265,"l":37.2602739726027},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[10.2525,29.9975],"tickmode":"array","ticktext":["15","20","25"],"tickvals":[15,20,25],"categoryorder":"array","categoryarray":["15","20","25"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Ajuste na maquina","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.97,37.97],"tickmode":"array","ticktext":["0","10","20","30"],"tickvals":[1.11022302462516e-16,10,20,30],"categoryorder":"array","categoryarray":["0","10","20","30"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Consumo de energia","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(51,51,51,1)","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"37a4815798":{"x":{},"y":{},"type":"scatter"}},"cur_data":"37a4815798","visdat":{"37a4815798":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Ajustando os modelos:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="regression.html#cb43-1" aria-hidden="true" tabindex="-1"></a>modelEner01 <span class="ot">=</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Consumo de energia</span><span class="st">`</span><span class="sc">~</span><span class="st">`</span><span class="at">Ajuste na maquina</span><span class="st">`</span>, <span class="at">data =</span> dados02) </span>
<span id="cb43-2"><a href="regression.html#cb43-2" aria-hidden="true" tabindex="-1"></a>modelEner02 <span class="ot">=</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Consumo de energia</span><span class="st">`</span><span class="sc">~</span><span class="st">`</span><span class="at">Ajuste na maquina</span><span class="st">`</span> <span class="sc">+</span> <span class="fu">I</span>(<span class="st">`</span><span class="at">Ajuste na maquina</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> dados02) </span>
<span id="cb43-3"><a href="regression.html#cb43-3" aria-hidden="true" tabindex="-1"></a>modelEner03 <span class="ot">=</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Consumo de energia</span><span class="st">`</span><span class="sc">~</span><span class="st">`</span><span class="at">Ajuste na maquina</span><span class="st">`</span> <span class="sc">+</span> <span class="fu">I</span>(<span class="st">`</span><span class="at">Ajuste na maquina</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(<span class="st">`</span><span class="at">Ajuste na maquina</span><span class="st">`</span><span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> dados02) </span>
<span id="cb43-4"><a href="regression.html#cb43-4" aria-hidden="true" tabindex="-1"></a>modelEner04 <span class="ot">=</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">Consumo de energia</span><span class="st">`</span><span class="sc">~</span><span class="st">`</span><span class="at">Ajuste na maquina</span><span class="st">`</span> <span class="sc">+</span> <span class="fu">I</span>(<span class="st">`</span><span class="at">Ajuste na maquina</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(<span class="st">`</span><span class="at">Ajuste na maquina</span><span class="st">`</span><span class="sc">^</span><span class="dv">3</span>)<span class="sc">+</span> <span class="fu">I</span>(<span class="st">`</span><span class="at">Ajuste na maquina</span><span class="st">`</span><span class="sc">^</span><span class="dv">4</span>), <span class="at">data =</span> dados02) </span></code></pre></div>
<p>Gráfico do ajuste dos modelos:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="regression.html#cb44-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>, <span class="fl">0.1</span>)</span>
<span id="cb44-2"><a href="regression.html#cb44-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">=</span> modelEner01<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> modelEner01<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>x</span>
<span id="cb44-3"><a href="regression.html#cb44-3" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">=</span> modelEner02<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> modelEner02<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> modelEner02<span class="sc">$</span>coefficients[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb44-4"><a href="regression.html#cb44-4" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">=</span> modelEner03<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> modelEner03<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> modelEner03<span class="sc">$</span>coefficients[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> modelEner03<span class="sc">$</span>coefficients[<span class="dv">4</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb44-5"><a href="regression.html#cb44-5" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">=</span> modelEner04<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="sc">+</span> modelEner04<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> modelEner04<span class="sc">$</span>coefficients[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> modelEner04<span class="sc">$</span>coefficients[<span class="dv">4</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span> modelEner04<span class="sc">$</span>coefficients[<span class="dv">5</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span></span>
<span id="cb44-6"><a href="regression.html#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="regression.html#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb44-8"><a href="regression.html#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="st">`</span><span class="at">Consumo de energia</span><span class="st">`</span><span class="sc">~</span><span class="st">`</span><span class="at">Ajuste na maquina</span><span class="st">`</span>, <span class="at">data =</span> dados02, <span class="at">col =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">xlab =</span> <span class="st">&quot;Ajuste na máquina&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Consumo de energia&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Consumo de energia x Ajuste na máquina&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">40</span>))</span>
<span id="cb44-9"><a href="regression.html#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y1<span class="sc">~</span>x, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb44-10"><a href="regression.html#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y2<span class="sc">~</span>x, <span class="at">col =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb44-11"><a href="regression.html#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y3<span class="sc">~</span>x, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb44-12"><a href="regression.html#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y4<span class="sc">~</span>x, <span class="at">col =</span> <span class="dv">5</span>, <span class="at">lty =</span> <span class="dv">4</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb44-13"><a href="regression.html#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;top&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Linear&quot;</span>, <span class="st">&quot;Grau 2&quot;</span>, <span class="st">&quot;Grau 3&quot;</span>, <span class="st">&quot;Grau 4&quot;</span>), <span class="at">fill =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>))</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>O modelo polinomial de grau 2 representou bem as observações sem o risco de perda de generalização.</p>
<p>Polinômios de graus mais altos correm o risco de não generalizarem o fenômeno, embora se saiam muito bem com as observações do treinamento.</p>
</div>
</div>
<div id="análise-conjunto-vendas-vs-fontes-de-publidades" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Análise Conjunto vendas vs fontes de publidades<a href="regression.html#análise-conjunto-vendas-vs-fontes-de-publidades" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Análise descritiva e regressão linear sobre o conjunto de dados SALES_X_YOUTUBE em DadosAula06.xlsx.</p>
<div id="pacotes-3" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Pacotes<a href="regression.html#pacotes-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pacotes necessários para estes exercícios:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="regression.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb45-2"><a href="regression.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb45-3"><a href="regression.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb45-4"><a href="regression.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb45-5"><a href="regression.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb45-6"><a href="regression.html#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb45-7"><a href="regression.html#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code></pre></div>
</div>
<div id="conjunto-de-dados-4" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Conjunto de dados<a href="regression.html#conjunto-de-dados-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="regression.html#cb46-1" aria-hidden="true" tabindex="-1"></a>dados03 <span class="ot">=</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">&quot;../dados/04_LABORATORIO REGRESSAO COM DADOS 03_DADOS.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">3</span>)</span>
<span id="cb46-2"><a href="regression.html#cb46-2" aria-hidden="true" tabindex="-1"></a>dados03 <span class="ot">=</span> dados03[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb46-3"><a href="regression.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># tail(dados03, 3)</span></span>
<span id="cb46-4"><a href="regression.html#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="regression.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dados03_t =  pivot_longer(dados03, c(2:5))</span></span>
<span id="cb46-6"><a href="regression.html#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># names(dados03_t) = c(&quot;Indice&quot;, &quot;Grupo&quot;, &quot;Valor&quot;)</span></span>
<span id="cb46-7"><a href="regression.html#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(dados03) <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="regression.html#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;striped&quot;</span>)</span></code></pre></div>
<p>Vendas em relação aos anúncios no youtube.</p>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="02-regression_files/figure-html/graficoGgplot03a-1.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="02-regression_files/figure-html/graficoGgplot03b-1.png" width="672" /></p>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="02-regression_files/figure-html/graficoGgplot03b-2.png" width="672" /></p>
<p>Ajustando um modelo linear simples</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="regression.html#cb50-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="fu">lm</span>(sales <span class="sc">~</span> sqrtYou, <span class="at">data =</span> dados03_mod)</span>
<span id="cb50-2"><a href="regression.html#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ sqrtYou, data = dados03_mod)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.916 -2.344 -0.131  2.326  9.316 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.20688    0.80092   4.004  8.8e-05 ***
## sqrtYou      1.09042    0.06029  18.085  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.854 on 198 degrees of freedom
## Multiple R-squared:  0.6229, Adjusted R-squared:  0.621 
## F-statistic: 327.1 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>O gráfico mostra as observações em relação ao modelo.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="regression.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sales <span class="sc">~</span> sqrtYou, <span class="at">data =</span> dados03_mod)</span>
<span id="cb52-2"><a href="regression.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(model)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-29-1.png" width="672" />
Analisando os resíduos.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="regression.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-30-1.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-30-2.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-30-3.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-30-4.png" width="672" /></p>
<p>Ajustando o modelo a mais variáveis (multiclass).</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="regression.html#cb54-1" aria-hidden="true" tabindex="-1"></a>modelMult <span class="ot">=</span> <span class="fu">lm</span>(sales <span class="sc">~</span> youtube <span class="sc">+</span> facebook <span class="sc">+</span> newspaper, <span class="at">data =</span> dados03)</span>
<span id="cb54-2"><a href="regression.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelMult)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ youtube + facebook + newspaper, data = dados03)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.5932  -1.0690   0.2902   1.4272   3.3951 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.526667   0.374290   9.422   &lt;2e-16 ***
## youtube      0.045765   0.001395  32.809   &lt;2e-16 ***
## facebook     0.188530   0.008611  21.893   &lt;2e-16 ***
## newspaper   -0.001037   0.005871  -0.177     0.86    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.023 on 196 degrees of freedom
## Multiple R-squared:  0.8972, Adjusted R-squared:  0.8956 
## F-statistic: 570.3 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="regression.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelMult)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-31-1.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-31-2.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-31-3.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-31-4.png" width="672" /></p>
<p>Newspaper tem pouca influência no modelo, sendo o youtube a que mais influência nas vendas.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="regression.html#cb57-1" aria-hidden="true" tabindex="-1"></a>modelMult2 <span class="ot">=</span> <span class="fu">lm</span>(sales <span class="sc">~</span> youtube <span class="sc">+</span> facebook, <span class="at">data =</span> dados03)</span>
<span id="cb57-2"><a href="regression.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelMult2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ youtube + facebook, data = dados03)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.5572  -1.0502   0.2906   1.4049   3.3994 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.50532    0.35339   9.919   &lt;2e-16 ***
## youtube      0.04575    0.00139  32.909   &lt;2e-16 ***
## facebook     0.18799    0.00804  23.382   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.018 on 197 degrees of freedom
## Multiple R-squared:  0.8972, Adjusted R-squared:  0.8962 
## F-statistic: 859.6 on 2 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="regression.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelMult2)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-32-1.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-32-2.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-32-3.png" width="672" /><img src="02-regression_files/figure-html/unnamed-chunk-32-4.png" width="672" /></p>
</div>
</div>
<div id="análise-conjunto-st-vs-demais-variáveiscredit-score-x-renda-e-outras-v" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Análise conjunto ST vs demais variáveisCREDIT SCORE X RENDA E OUTRAS V<a href="regression.html#análise-conjunto-st-vs-demais-variáveiscredit-score-x-renda-e-outras-v" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Análise descritiva e regressão linear sobre o conjunto de dados CREDIT SCORE X RENDA E OUTRAS V em DadosAula06.xlsx.</p>
<div id="pacotes-4" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Pacotes<a href="regression.html#pacotes-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pacotes necessários para estes exercícios:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="regression.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb60-2"><a href="regression.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb60-3"><a href="regression.html#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb60-4"><a href="regression.html#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb60-5"><a href="regression.html#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb60-6"><a href="regression.html#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb60-7"><a href="regression.html#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code></pre></div>
</div>
<div id="conjunto-de-dados-5" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Conjunto de dados<a href="regression.html#conjunto-de-dados-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Analise se o cliente pode receber o crédito de acordo com a análise. As variáveis são:</p>
<ul>
<li>ST - Situação (0 - Passou na análise, 1 - Nâo passou na análise) - Y</li>
<li>R - Renda - X</li>
<li>ND - Num Dependentes - X</li>
<li>VE - Vinculo Empregaticio - X</li>
</ul>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="regression.html#cb61-1" aria-hidden="true" tabindex="-1"></a>dados04 <span class="ot">=</span> <span class="fu">read_excel</span>(<span class="at">path =</span> <span class="st">&quot;../dados/04_LABORATORIO REGRESSAO COM DADOS 03_DADOS.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="dv">4</span>)</span>
<span id="cb61-2"><a href="regression.html#cb61-2" aria-hidden="true" tabindex="-1"></a>dados04 <span class="ot">=</span> dados04[,<span class="dv">18</span><span class="sc">:</span><span class="dv">21</span>]</span>
<span id="cb61-3"><a href="regression.html#cb61-3" aria-hidden="true" tabindex="-1"></a>dados04<span class="sc">$</span>ST <span class="ot">=</span> <span class="fu">factor</span>(dados04<span class="sc">$</span>ST)</span>
<span id="cb61-4"><a href="regression.html#cb61-4" aria-hidden="true" tabindex="-1"></a>dados04<span class="sc">$</span>VE <span class="ot">=</span> <span class="fu">factor</span>(dados04<span class="sc">$</span>VE)</span>
<span id="cb61-5"><a href="regression.html#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="regression.html#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(dados04) <span class="sc">%&gt;%</span></span>
<span id="cb61-7"><a href="regression.html#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;striped&quot;</span>)</span></code></pre></div>
<p>Situação explicada pela renda.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="regression.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dados04<span class="sc">$</span>R <span class="sc">~</span> dados04<span class="sc">$</span>ST)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>O modelo é</p>
<p><span class="math display">\[
    \log{\left(\frac{P(y_i=1)}{1-P(y_i=1)}\right)} = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 + \epsilon_i
\]</span></p>
<p><span class="math display">\[
   \frac{P(y=1)}{1-P(y=1)} = e^{(\beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3)}
\]</span></p>
<p>O ajuste é</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="regression.html#cb63-1" aria-hidden="true" tabindex="-1"></a>modelo04  <span class="ot">=</span> <span class="fu">glm</span>(dados04<span class="sc">$</span>ST <span class="sc">~</span> dados04<span class="sc">$</span>R <span class="sc">+</span> dados04<span class="sc">$</span>ND <span class="sc">+</span> dados04<span class="sc">$</span>VE, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&#39;logit&#39;</span>))</span>
<span id="cb63-2"><a href="regression.html#cb63-2" aria-hidden="true" tabindex="-1"></a>valoresPredito <span class="ot">=</span> <span class="fu">predict.glm</span>(modelo04, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb63-3"><a href="regression.html#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo04)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = dados04$ST ~ dados04$R + dados04$ND + dados04$VE, 
##     family = binomial(link = &quot;logit&quot;))
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.6591  -0.2633  -0.0531   0.4187   2.0147  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   1.1117     1.5725   0.707 0.479578    
## dados04$R    -1.7872     0.4606  -3.880 0.000105 ***
## dados04$ND    0.9031     0.3857   2.341 0.019212 *  
## dados04$VE1   2.9113     0.8506   3.423 0.000620 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 126.450  on 91  degrees of freedom
## Residual deviance:  51.382  on 88  degrees of freedom
## AIC: 59.382
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Os valores preditos são:</p>
<pre><code>## Warning in confusionMatrix.default(valoresPredito_cl, dados04$ST): Levels are
## not in the same order for reference and data. Refactoring data to match.

## Warning in confusionMatrix.default(valoresPredito_cl, dados04$ST): Levels are
## not in the same order for reference and data. Refactoring data to match.</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0 46  5
##          1  5 36
##                                           
##                Accuracy : 0.8913          
##                  95% CI : (0.8092, 0.9466)
##     No Information Rate : 0.5543          
##     P-Value [Acc &gt; NIR] : 2.554e-12       
##                                           
##                   Kappa : 0.78            
##                                           
##  Mcnemar&#39;s Test P-Value : 1               
##                                           
##             Sensitivity : 0.9020          
##             Specificity : 0.8780          
##          Pos Pred Value : 0.9020          
##          Neg Pred Value : 0.8780          
##              Prevalence : 0.5543          
##          Detection Rate : 0.5000          
##    Detection Prevalence : 0.5543          
##       Balanced Accuracy : 0.8900          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<p>Matriz de confusão</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="regression.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_confusion_matrix</span>(cm)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>A acurácia do modelo é de 89% e a sensibilidade é alta, em torno de 90%. Nos dados treinados o acerto de “passou na análise” foi de 100% (46/46). Já a especificidade é de 88% havendo confusão com 5/46 observações. O mesmo ocorreu para “não passou na análise”, onde 36/46 observações estão corretas e 5/46 não.</p>
</div>
</div>
<div id="consumo-alimentar-médio" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Consumo alimentar médio<a href="regression.html#consumo-alimentar-médio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Análise descritiva e regressão linear.</p>
<div id="pacotes-5" class="section level3 hasAnchor" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> Pacotes<a href="regression.html#pacotes-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pacotes necessários para estes exercícios:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="regression.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb68-2"><a href="regression.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb68-3"><a href="regression.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb68-4"><a href="regression.html#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb68-5"><a href="regression.html#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb68-6"><a href="regression.html#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb68-7"><a href="regression.html#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb68-8"><a href="regression.html#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span></code></pre></div>
</div>
<div id="conjunto-de-dados-6" class="section level3 hasAnchor" number="2.6.2">
<h3><span class="header-section-number">2.6.2</span> Conjunto de dados<a href="regression.html#conjunto-de-dados-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Considere os dados a seguir do consumo alimentar médio de diferentes tipos de alimentos para famílias classificadas de acordo com o número de filhos (2, 3, 4 ou 5) e principal área de trabalho (MA: Setor de Trabalho Manual, EM: Empregados do Setor Público ou CA: Cargos Administrativos).</p>
<p>Fonte: LABORATORIO-R.pdf</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="regression.html#cb69-1" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">AreaTrabalho =</span> <span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;MA&quot;</span>, <span class="st">&quot;EM&quot;</span>, <span class="st">&quot;CA&quot;</span>), <span class="dv">4</span>)),</span>
<span id="cb69-2"><a href="regression.html#cb69-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">Filhos =</span> <span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">each =</span> <span class="dv">3</span>)),</span>
<span id="cb69-3"><a href="regression.html#cb69-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">Paes =</span> <span class="fu">c</span>(<span class="dv">332</span>, <span class="dv">293</span>, <span class="dv">372</span>, <span class="dv">406</span>, <span class="dv">386</span>, <span class="dv">438</span>, <span class="dv">534</span>, <span class="dv">460</span>, <span class="dv">385</span>, <span class="dv">655</span>, <span class="dv">584</span>, <span class="dv">515</span>),</span>
<span id="cb69-4"><a href="regression.html#cb69-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">Vegetais =</span> <span class="fu">c</span>(<span class="dv">428</span>, <span class="dv">559</span>, <span class="dv">767</span>, <span class="dv">563</span>, <span class="dv">608</span>, <span class="dv">843</span>, <span class="dv">660</span>, <span class="dv">699</span>, <span class="dv">789</span>, <span class="dv">776</span>, <span class="dv">995</span>, <span class="dv">1097</span>),</span>
<span id="cb69-5"><a href="regression.html#cb69-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">Frutas =</span> <span class="fu">c</span>(<span class="dv">354</span>, <span class="dv">388</span>, <span class="dv">562</span>, <span class="dv">341</span>, <span class="dv">396</span>, <span class="dv">689</span>, <span class="dv">367</span>, <span class="dv">484</span>, <span class="dv">621</span>, <span class="dv">423</span>, <span class="dv">548</span>, <span class="dv">887</span>),</span>
<span id="cb69-6"><a href="regression.html#cb69-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">Carnes =</span> <span class="fu">c</span>(<span class="dv">1437</span>,<span class="dv">1527</span>,<span class="dv">1948</span>,<span class="dv">1507</span>,<span class="dv">1501</span>,<span class="dv">2345</span>,<span class="dv">1620</span>,<span class="dv">1856</span>,<span class="dv">2366</span>,<span class="dv">1848</span>,<span class="dv">2056</span>,<span class="dv">2630</span>),</span>
<span id="cb69-7"><a href="regression.html#cb69-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">Aves =</span> <span class="fu">c</span>(<span class="dv">526</span>, <span class="dv">567</span>, <span class="dv">927</span>, <span class="dv">544</span>, <span class="cn">NA</span>, <span class="dv">1148</span>,<span class="dv">638</span>, <span class="dv">762</span>, <span class="dv">1149</span>,<span class="dv">759</span>, <span class="dv">893</span>, <span class="dv">1167</span>),</span>
<span id="cb69-8"><a href="regression.html#cb69-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">Leite =</span> <span class="fu">c</span>(<span class="dv">247</span>, <span class="dv">239</span>, <span class="dv">235</span>, <span class="dv">324</span>, <span class="dv">319</span>, <span class="dv">243</span>, <span class="dv">414</span>, <span class="dv">400</span>, <span class="dv">304</span>, <span class="dv">495</span>, <span class="dv">518</span>, <span class="dv">561</span>),</span>
<span id="cb69-9"><a href="regression.html#cb69-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">Alcoolicos =</span> <span class="fu">c</span>(<span class="dv">427</span>, <span class="dv">258</span>, <span class="dv">433</span>, <span class="dv">407</span>, <span class="dv">363</span>, <span class="dv">341</span>, <span class="dv">407</span>, <span class="dv">416</span>, <span class="dv">282</span>, <span class="dv">486</span>, <span class="dv">319</span>, <span class="dv">284</span>))</span>
<span id="cb69-10"><a href="regression.html#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="regression.html#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(dados) <span class="sc">%&gt;%</span></span>
<span id="cb69-12"><a href="regression.html#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;striped&quot;</span>)</span></code></pre></div>
</div>
<div id="regressão" class="section level3 hasAnchor" number="2.6.3">
<h3><span class="header-section-number">2.6.3</span> Regressão<a href="regression.html#regressão" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="regression.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dummy &lt;- dummyVars(&quot; ~ .&quot;, data=dados)</span></span>
<span id="cb70-2"><a href="regression.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co">#dadosS &lt;- data.frame(predict(dummy, newdata = dados))</span></span>
<span id="cb70-3"><a href="regression.html#cb70-3" aria-hidden="true" tabindex="-1"></a>dadosS <span class="ot">=</span> <span class="fu">subset</span>(dados, <span class="at">select=</span><span class="fu">c</span>(<span class="st">&quot;Aves&quot;</span>, <span class="st">&quot;Filhos&quot;</span>, <span class="st">&quot;Paes&quot;</span>, <span class="st">&quot;Vegetais&quot;</span>, <span class="st">&quot;Frutas&quot;</span>, <span class="st">&quot;Carnes&quot;</span>, <span class="st">&quot;Leite&quot;</span>, <span class="st">&quot;Alcoolicos&quot;</span>))</span>
<span id="cb70-4"><a href="regression.html#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="regression.html#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co">#modelo  = lm(dadosS$Aves ~ dadosS$AreaTrabalho.CA + dadosS$AreaTrabalho.EM + dadosS$AreaTrabalho.MA + dadosS$Filhos.2 + dadosS$Filhos.3 + dadosS$Filhos.4 + dadosS$Filhos.5 + dadosS$Paes + dadosS$Vegetais + dadosS$Frutas + dadosS$Carnes + dadosS$Leite + dadosS$Alcoolicos)</span></span>
<span id="cb70-6"><a href="regression.html#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="regression.html#cb70-7" aria-hidden="true" tabindex="-1"></a>modelo  <span class="ot">=</span> <span class="fu">lm</span>(Aves <span class="sc">~</span> Filhos <span class="sc">+</span> Paes <span class="sc">+</span> Vegetais <span class="sc">+</span> Frutas <span class="sc">+</span> Carnes <span class="sc">+</span> Leite <span class="sc">+</span> Alcoolicos, <span class="at">data =</span> dadosS)</span>
<span id="cb70-8"><a href="regression.html#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="regression.html#cb70-9" aria-hidden="true" tabindex="-1"></a>valoresPredito <span class="ot">=</span> <span class="fu">predict.lm</span>(modelo, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb70-10"><a href="regression.html#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Aves ~ Filhos + Paes + Vegetais + Frutas + Carnes + 
##     Leite + Alcoolicos, data = dadosS)
## 
## Residuals:
##      1      2      3      4      6      7      8      9     10     11     12 
## 11.874 -9.816 -2.058 -1.250  1.250  3.533 -5.322  1.789 -8.056  9.567 -1.510 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -746.3706   632.2722  -1.180    0.447
## Filhos3      -75.6290   123.1415  -0.614    0.649
## Filhos4     -105.4167   262.6281  -0.401    0.757
## Filhos5     -192.0193   421.1901  -0.456    0.728
## Paes           0.1803     0.3299   0.547    0.681
## Vegetais       0.2438     0.2282   1.068    0.479
## Frutas        -0.7431     0.9391  -0.791    0.574
## Carnes         0.9335     0.5221   1.788    0.325
## Leite         -0.1543     1.1509  -0.134    0.915
## Alcoolicos     0.1313     0.2243   0.586    0.663
## 
## Residual standard error: 21.15 on 1 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.9993, Adjusted R-squared:  0.9928 
## F-statistic: 153.7 on 9 and 1 DF,  p-value: 0.06252</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="regression.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(modelo)</span></code></pre></div>
<pre><code>##                    2.5 %      97.5 %
## (Intercept) -8780.151071 7287.409914
## Filhos3     -1640.289906 1489.031864
## Filhos4     -3442.422544 3231.589190
## Filhos5     -5543.747107 5159.708466
## Paes           -4.010944    4.371643
## Vegetais       -2.655840    3.143461
## Frutas        -12.674990   11.188748
## Carnes         -5.701068    7.567978
## Leite         -14.778470   14.469823
## Alcoolicos     -2.718471    2.981129</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="regression.html#cb74-1" aria-hidden="true" tabindex="-1"></a>rse <span class="ot">=</span> <span class="fu">sigma</span>(modelo)<span class="sc">/</span><span class="fu">mean</span>(dadosS<span class="sc">$</span>Aves, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb74-2"><a href="regression.html#cb74-2" aria-hidden="true" tabindex="-1"></a>rse</span></code></pre></div>
<pre><code>## [1] 0.02562551</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="regression.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dadosS, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="co">#Plot the results</span></span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="regression.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo<span class="sc">$</span>residuals, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-42-2.png" width="672" /></p>
<p>Verificando modelo</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="regression.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb78-2"><a href="regression.html#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="regression.html#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(modelo)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
<div id="predição-1" class="section level3 hasAnchor" number="2.6.4">
<h3><span class="header-section-number">2.6.4</span> Predição<a href="regression.html#predição-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="regression.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(modelo, <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in predict.lm(modelo, interval = &quot;prediction&quot;): predictions on current data refer to _future_ responses</code></pre>
<pre><code>##          fit      lwr       upr
## 1   514.1259 165.2536  862.9982
## 2   576.8163 217.7647  935.8679
## 3   929.0578 549.8593 1308.2563
## 4   545.2501 165.4832  925.0169
## 6  1146.7499 766.9831 1526.5168
## 7   634.4669 257.0284 1011.9055
## 8   767.3224 393.2881 1141.3567
## 9  1147.2107 767.7924 1526.6290
## 10  767.0563 401.0010 1133.1117
## 11  883.4332 523.2959 1243.5705
## 12 1168.5105 788.8965 1548.1245</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="regression.html#cb82-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">predict.lm</span>(modelo, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Filhos =</span> <span class="fu">as.factor</span>(<span class="dv">3</span>), <span class="at">Paes =</span> <span class="dv">386</span>, <span class="at">Vegetais =</span> <span class="dv">608</span>, <span class="at">Frutas =</span> <span class="dv">396</span>, <span class="at">Carnes =</span> <span class="dv">1501</span>, <span class="at">Leite =</span> <span class="dv">319</span>, <span class="at">Alcoolicos =</span> <span class="dv">363</span>))</span>
<span id="cb82-2"><a href="regression.html#cb82-2" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>##        1 
## 501.1353</code></pre>
<p>O valor da Ave na linha 5 é <span class="math inline">\(501.135316\)</span></p>
<p>Ajustando o conjunto de dados:</p>
<p>O valor de Aves é <span class="math inline">\(NA\)</span>:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="regression.html#cb84-1" aria-hidden="true" tabindex="-1"></a>dados[<span class="dv">5</span>, ]</span></code></pre></div>
<pre><code>## # A tibble: 1 × 9
##   AreaTrabalho Filhos  Paes Vegetais Frutas Carnes  Aves Leite Alcoolicos
##   &lt;fct&gt;        &lt;fct&gt;  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1 EM           3        386      608    396   1501    NA   319        363</code></pre>
<p>Vamos ajustar o conjunto de dados com o valor predito para aves:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="regression.html#cb86-1" aria-hidden="true" tabindex="-1"></a>dados[<span class="dv">5</span>, ][<span class="st">&#39;Aves&#39;</span>] <span class="ot">=</span> p</span></code></pre></div>
<p>Conjunto de dados ajustado:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="regression.html#cb87-1" aria-hidden="true" tabindex="-1"></a>dados[<span class="dv">5</span>, ]</span></code></pre></div>
<pre><code>## # A tibble: 1 × 9
##   AreaTrabalho Filhos  Paes Vegetais Frutas Carnes  Aves Leite Alcoolicos
##   &lt;fct&gt;        &lt;fct&gt;  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1 EM           3        386      608    396   1501  501.   319        363</code></pre>
</div>
<div id="agrupamento" class="section level3 hasAnchor" number="2.6.5">
<h3><span class="header-section-number">2.6.5</span> Agrupamento<a href="regression.html#agrupamento" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="regression.html#cb89-1" aria-hidden="true" tabindex="-1"></a>dadosS <span class="ot">=</span> <span class="fu">subset</span>(dados, <span class="at">select=</span><span class="fu">c</span>(<span class="st">&quot;Paes&quot;</span>, <span class="st">&quot;Vegetais&quot;</span>, <span class="st">&quot;Frutas&quot;</span>, <span class="st">&quot;Carnes&quot;</span>, <span class="st">&quot;Aves&quot;</span>, <span class="st">&quot;Leite&quot;</span>, <span class="st">&quot;Alcoolicos&quot;</span>))</span>
<span id="cb89-2"><a href="regression.html#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="regression.html#cb89-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(dadosS, <span class="at">method =</span> <span class="st">&quot;maximum&quot;</span>)</span>
<span id="cb89-4"><a href="regression.html#cb89-4" aria-hidden="true" tabindex="-1"></a>grup <span class="ot">=</span> <span class="fu">hclust</span>(d, <span class="at">method =</span> <span class="st">&quot;ward.D&quot;</span>)</span>
<span id="cb89-5"><a href="regression.html#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="regression.html#cb89-6" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">cutree</span>(grup, <span class="at">k=</span><span class="dv">3</span>)</span>
<span id="cb89-7"><a href="regression.html#cb89-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-8"><a href="regression.html#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(grup, <span class="at">cex =</span> <span class="fl">0.6</span>)</span>
<span id="cb89-9"><a href="regression.html#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rect.hclust</span>(grup , <span class="at">k =</span> <span class="dv">3</span>, <span class="at">border =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb89-10"><a href="regression.html#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="regression.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">sort</span>(groups)) <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="regression.html#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">&quot;striped&quot;</span>)</span></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
<p>Pelo dendograma podemos dividir os dados em 3 clusters.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="regression.html#cb91-1" aria-hidden="true" tabindex="-1"></a>km1 <span class="ot">=</span> <span class="fu">kmeans</span>(dadosS, <span class="dv">3</span>)</span>
<span id="cb91-2"><a href="regression.html#cb91-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">fviz_cluster</span>(km1, <span class="at">data=</span>dadosS,</span>
<span id="cb91-3"><a href="regression.html#cb91-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#2E9FDF&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#E7B700&quot;</span>),</span>
<span id="cb91-4"><a href="regression.html#cb91-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">star.plot=</span><span class="cn">FALSE</span>,</span>
<span id="cb91-5"><a href="regression.html#cb91-5" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># repel=TRUE,</span></span>
<span id="cb91-6"><a href="regression.html#cb91-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme=</span><span class="fu">theme_bw</span>())</span>
<span id="cb91-7"><a href="regression.html#cb91-7" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="02-regression_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="descriptive.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="classification.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
